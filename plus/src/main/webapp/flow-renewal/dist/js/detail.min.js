"use strict";var Detail=function(){function a(){u=$("#detailLayer"),v=u.find("#detailTimeline"),w=v.find("#postTimeline"),x=v.find("#createPostArea"),z=v.find("#projectFeedArea"),y=z.find("#detailUl"),A=z.find("#postMoreBtn")}function b(b,d,e){var g=+e===TINY_URL_MOVE.POST;CONNECT_PROJECT_SRNO=Often.null2Void(b),CONNECT_POST_SRNO=g?"":Often.null2Void(d),CONNECT_REMARK_SRNO=g?"":Often.null2Void(e),B.COLABO_SRNO=CONNECT_PROJECT_SRNO,B.SEARCH_COMMT_SRNO=CONNECT_POST_SRNO,B.SRCH_COLABO_REMARK_SRNO=CONNECT_REMARK_SRNO,a(),DetailHeader.drawTempProjectHeaderItem(b),c(b,function(){f(),g&&PostPopup.togglePostView(b,d,"","",!0)}),DetailEvent.resetFilter(z),ProjectSearch.hideSearchProjectList(),Participant.drawProjectParticipantItems(b,!0),RecentProject.reloadRecentProject()}function c(b,c){ViewChanger.isPage("detail")&&(a(),A.css("display","none"),w.scrollTop(0).css("z-index","-1"),Ajax.executeApi(RenewalApi.GET.ACT_PROJECT_INFO,B,function(a){if(ViewChanger.isPage("detail")){var e=Often.null2Void(a.PROJECT_SETTING&&a.PROJECT_SETTING[0],{}),f=Often.null2Void(a.PIN_RECORD,[]),g=Often.null2Void(a.TAG_RECORD,[]),h=Often.null2Void(a.TASK_REPORT_RECORD,[]),i=Often.null2Void(a.ALARM_RECORD,""),j=Often.null2Void(a.ALARM_COUNT,0),k=Often.null2Void(e.VIEW_TYPE,"F");e.LABEL_SRNOS=LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","LABEL_SRNOS"),LocalUtil.setLocalJson("CURRENT_PROJECT_SETTING",e),LocalUtil.setLocalJson("POP_PROJECT_SETTING",e),LocalUtil.setLocal("FEED_TYPE","F"===k?"card":"list"),c&&l(),"function"==typeof c&&c(),DetailHeader.drawProjectHeaderItem(e),Alarm.drawProjectAlarmItems(b,i,j,!0),PinPost.drawProjectPinPostItemsByRecord(f),HashTag.drawProjectHashtagItemsByRecord(g),TaskReport.drawTaskReport(h),d(x,e.TMPL_TYPE),Participant.drawJoinParticipantItem(b,!0),w.css("z-index",""),DetailEvent.addClickEventOnDetailView(),s(e.COLABO_SRNO,e.BG_COLOR_CD,e.TTL)}}))}function d(a,b){e(a.find("#createPostUl"),b),Authority.changeCreatePostAreaByAuthority(a)}function e(a,b){b=b||LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","TMPL_TYPE");var c=a.is("#createPostUl"),d=a.find(".post-filter, .js-post-type-item");if(""===b)return d.css("display",c?"block":"table-cell");var e=[{code:"todo",text:i18next.t("dictionary.todo")},{code:"schedule",text:i18next.t("dictionary.schedule")},{code:"task",text:i18next.t("dictionary.task")},{code:"write2",text:i18next.t("dictionary.article")}],f="createPostUl"===a.attr("id"),g=a.hasClass("create-post-nav"),h="";b.split(",").forEach(function(a){if(1!==+a){var b=$.extend({v:a},e[+a-2]),c="";f?c+="<li class=\"post-filter\" data-post-code=\"{v}\"><i class=\"icons-{code}\"></i><span>{text}</span></li>":g&&(c+="<li class=\"js-post-type-item\" data-post-code=\"{v}\"><button type=\"button\" class=\"create-tab tab-{code}\" role=\"tab\"><i class=\"icons-{code}\"></i><span>{text}</span></button></li>"),5===+a&&(b.v=1),h+=ListHelper.replaceJson(c,b)}}),a.empty().html(h)}function f(b){a(),b?ListHelper.initPageData(B,""):(ListHelper.initPageData(B,y),AlarmUpdate.removeNewUpdate()),B.ORDER_TYPE="N",g()}function g(){var a=B.MORE_BUTTON;if((!a||"N"!==B.PREV_YN)&&(a||"N"!==B.NEXT_YN)){D=!a&&""!==B.SEARCH_COMMT_SRNO;var b="list"===LocalUtil.getFeedType(),c=$.extend({},B,p(D||a));c.packetOption=Ajax.OPTION.PREVENT_EXECUTE,Ajax.executeApi(c.API_KEY,c,function(d){function e(c){if(j(h,i,a),t(),ItemRemark.addEventOnRemarkInput(),ItemSubtask.initEdit(y),a&&(B.MORE_BUTTON=!1,B.SEARCH_COMMT_SRNO="",A.css("display","Y"===B.PREV_YN?"block":"none")),!!h){0!==C.length&&!y.hasClass("list")&&b?y.addClass("list"):0===C.length&&y.removeClass("list"),y.css("display","block"),A.css("display",D&&"Y"===l?"block":"none"),k(c),D&&(D=!1,B.SEARCH_COMMT_SRNO="",B.SRCH_COLABO_REMARK_SRNO="",i&&10===i.length&&(B.NEXT_YN="Y"),f(!0),b&&PostPopup.togglePostView(CONNECT_PROJECT_SRNO,CONNECT_POST_SRNO,CONNECT_REMARK_SRNO,t));var d=y.find(".detail-item").length;0<C.length&&"N"===B.NEXT_YN&&0===d&&c.prepend(ListHelper.getNoDataHtml("POST"))}}function f(a){var b=y.children("li.detail-item:first");a&&b.find(".js-post-nav").addClass("highlight");var c=b.offset()&&b.offset().top,d=$(window).innerHeight()-v.outerHeight(!0);v.animate({scrollTop:c-d-46},400,"swing")}var h=1===B.PG_NO,i=d[c.RECORD_NAME],l=0<i.length&&(!b||D)?i[0].MORE_YN:"N";y.drawListHelper({pageData:B,prevYn:h?l:a?d.NEXT_YN:B.PREV_YN,nextYn:a?B.NEXT_YN:d.NEXT_YN,records:i,noDataHtml:ListHelper.getNoDataHtml("POST"),reverse:a,targetObj:{scroll:v},callback:{click:DetailEvent.clickDetailUl,item:function item(b){return PostComponent.getHtmlByPostRecord(b,a)},scroll:function scroll(){B.ORDER_TYPE="N";var a=C[C.length-1];if(!a)return SentryMonitor.captureException(C);var b=Often.null2Void(a.COMMT_RGSN_DTTM,a.RGSR_DTTM);0<C.length&&(B.COMMT_RGSN_DTTM=b),g()},final:e}})})}}function h(){return""===Often.null2Void(B.COLABO_SRNO)?(B.COLABO_SRNO=LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","COLABO_SRNO"),LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","COLABO_SRNO")):B.COLABO_SRNO}function i(){return C}function j(a,b,c){C=a?b:c?b.reverse().concat(C):C.concat(b)}function k(a){a.off("keyup").on("keyup",function(a){SubtaskKeyEvent.keyUpSubtaskInput(a)}),a.off("keydown").on("keydown",function(a){SubtaskKeyEvent.KeyDownSubtaskInput(a)})}function l(){var a=Often.isFunc(Func.CLOUD.POST_VIEW_SELECT),b=a?LocalUtil.getFeedType():"card";m(b);var c=$("#feedTypeButton");a?(c.find(".feed-type-button.card").css("display","inline-block"),c.find(".feed-type-button.list").css("display","inline-block")):(c.find(".feed-type-button.card").css("display","none"),c.find(".feed-type-button.list").css("display","none")),c.find(".check-menu-item").removeClass("on"),c.find(".check-menu-item:eq(0)").addClass("on"),c.find(".js-feed-filter-button").removeClass("active")}function m(a){var b=$("#feedTypeButton");b.find(".feed-type-button").removeClass("on"),b.find(".feed-type-button."+a).addClass("on"),$("#detailUl").attr("class","post-group "+a)}function n(){a(),ListHelper.initPageData(B,y),o()}function o(){if("N"!==B.NEXT_YN){var a=p();Ajax.executeApi(a.API_KEY,$.extend({},B,a),function(b){y.drawListHelper({pageData:B,nextYn:b.NEXT_YN,records:b[a.RECORD_NAME],targetObj:{scroll:v},callback:{click:DetailEvent.clickDetailUl,item:PostComponent.getHtmlByPostRecord,scroll:o,final:function(){ItemRemark.addEventOnRemarkInput()}}}),y.removeClass("d-none")})}}function p(a){var b=Often.null2Void(v.find("#hashtagUl").find(".hashtag.on:eq(0)").text(),v.find("#allPostsFilterTitle").text());b=-1<b.indexOf("#")?b.replace("#",""):"";var c,d,e,f=""!==b,g="list"===LocalUtil.getFeedType(),i=Often.null2Void(z.find(".js-feed-filter-layer").find(".check-menu-item.on").attr("data-code")),j=h(),k=LocalUtil.getProjectOpenYn();return f?g?(c=RenewalApi.GET.ACT_POST_LIST,d="DETAIL",e="POST_RECORD"):(c=RestApi.GET.COLABO2_AT_ME_R101,d="HASH",e="COMMT_REC"):a||B.COMMT_RGSN_DTTM?g?(c=RestApi.GET.COLABO2_R104,d="NEWLIST",e="LIST_REC"):(c=RestApi.GET.COLABO2_R104,d="",e="COMMT_REC"):g?(c=RenewalApi.GET.ACT_POST_LIST,d="DETAIL",e="POST_RECORD"):(c=RestApi.GET.COLABO2_R104,d="",e="COMMT_REC"),{API_KEY:c,GUBUN:d,TMPL_TYPE:i,TAG_NM:b,COLABO_SRNO:j,RECORD_NAME:e,OPEN_YN:k}}function q(a,b,c){var d=$("#detailUl"),e=d.find("#post-"+c);"POST"===a||"EDIT"===a?PostPopup.getPostData(b,c,"",!1,function(){var b=Often.null2Void(z.find(".js-feed-filter-layer").find(".check-menu-item.on").attr("data-code")),c=PostPopup.getData().POST_RECORD;if(""===b||c[0].TMPL_TYPE===b){var f=$(PostComponent.getHtmlByPostRecord(c));d.find("#noDetailData").remove(),f.find(".js-remark-area").off("keydown keyup").on({keydown:ItemRemark.keyDownRemarkInput,keyup:ItemRemark.keyUpRemarkInput}),ItemSubtask.initEdit(f),"POST"===a?(d.prepend(f),t()):(e.after(f),t(),e.remove())}}):"DELETE"===a&&(PostPopup.removePopup(),UpdateElements.autoUpdateElem())}function r(){"list"===LocalUtil.getFeedType()&&(B.SEARCH_COMMT_SRNO=Often.null2Void(C[0].COLABO_COMMT_SRNO)),B.COMMT_RGSN_DTTM=Often.null2Void(C[0].COMMT_RGSN_DTTM,C[0].RGSR_DTTM),B.ORDER_TYPE="P",B.MORE_BUTTON=!0,u.find(".highlight").removeClass("highlight"),g()}function s(a,b,c){Ajax.executeApi(RestApi.POST.COLABO_USER_HISTORY_C001,{COLABO_SRNO:a,BG_COLOR_CD:b,TTL:Often.null2Void(c,"-")})}function t(){var a=$(".js-post-img.post-upload-img");0<a.length&&($("#postPopup").css("display","block"),$.each(a,function(a,b){$(b).hasClass("slick-initialized")||$(b).slick({lazyLoad:"ondemand",slidesToShow:5,slidesToScroll:1,centerMode:!1,centerPadding:0,infinite:!1})}))}var u,v,w,x,y,z,A,B={PG_NO:1,PG_PER_CNT:30,PREV_YN:"Y",NEXT_YN:"Y",COLABO_SRNO:0,RENEWAL_YN:"Y",MORE_BUTTON:!1},C=[],D=!1;return{showDetailView:b,drawPostInfo:c,drawPostList:f,drawHashtagPostList:n,closeSettingUl:function(){$(".js-setting-ul").fadeOut(200)},closeFeedFilter:function(){var a=$("#feedTypeButton");a.find(".js-feed-filter-layer").fadeOut(200)},updateOnePostElement:q,clickPostMore:r,executeProjectSettingInfo:function(a,b){Ajax.executeApi(RenewalApi.GET.ACT_PROJECT_INFO,{COLABO_SRNO:a,GUBUN:"SETTING"},function(a){var c=Often.null2Void(a.PROJECT_SETTING&&a.PROJECT_SETTING[0],{});LocalUtil.setLocalJson("POP_PROJECT_SETTING",c),"function"==typeof b&&b(c)})},getProjectSrno:h,setProjectSrno:function(a){B.COLABO_SRNO=a},getPostRecord:i,getPostStatus:function(){return $("#postPopup").find(".js-popup-before").attr("data-code")},setFeedType:m,togglePostFilter:e,applySummarySlickImage:t}}();
"use strict";var AllSendience=function(){function a(){j=$("#allSendiencePopup"),j.find("#allSendienceSearch").val(""),c(),j.off("click").on("click",f).off("keyup").on("keyup",d)}function b(){j=$("#allSendiencePopup"),j.find("#allSendienceUl").scrollTop(0),j.css("display","none"),$(".plus-popup").fadeOut(200)}function c(){Member.initPage(),Member.makeMemberList(j.find("#allSendienceUl"),j.find("#allSendienceSearch"),"",InviteType.ALLSENDIENCE,function(){e(),j.fadeIn(200)})}function d(a){function b(a){var b=a.findUp("#allSendienceSearch");if(0===b.length)return!1;var c=j.find("#allSendienceSearch");return k&&clearTimeout(k),k=setTimeout(function(){Member.initPage(),Member.makeMemberList(j.find("#allSendienceUl"),c,"",InviteType.ALLSENDIENCE,e)},200),!0}var c=$(a.target);b(c)}function e(){var a=Authority.isAuthorityCheck("ADMIN");j.find("#allSendienceUl").find(".my-check-2").css("display","none"),a&&j.find("#allSendienceUl").find(".project-invite-plus-1").css("display","block"),j.find("li[data-id=\""+_USER_ID+"\"]").find(".project-invite-plus-1").css("display","block"),a||j.find("li[data-id=\""+_USER_ID+"\"]").find("#managerBtn").css("display","none"),j.find("li[sendience_gb=\"3\"]").append(i())}function f(a){function d(a){function b(){if(_USER_ID===e){if(LocalUtil.setLocalValue("CURRENT_PROJECT_SETTING","MNGR_DSNC",m?"N":"Y"),LocalUtil.getLocalValue("POP_PROJECT_SETTING","COLABO_SRNO")!==Detail.getProjectSrno())return;LocalUtil.setLocalValue("POP_PROJECT_SETTING","MNGR_DSNC",m?"N":"Y")}else;}var d=a.findUp("#plusPopup");if(0===d.length)return $(".plus-popup").fadeOut(200),!1;var e=a.parents("li").attr("data-id"),f=a.parents("li").attr("sendience_gb"),k=a.findUp("#export");if(0!==k.length)return g(e,f),!0;var l=a.findUp("#managerBtn");if(0!==l.length){var m=l.find("div").text()===i18next.t("front.common.releaseManager");if(m&&1===j.find(".js-participant-item[sendience_gb=3]").length)return Often.toast("error","\uD504\uB85C\uC81D\uD2B8 \uAD00\uB9AC\uC790\uB294 \uCD5C\uC18C \uD55C\uBA85\uC774 \uC874\uC7AC\uD574\uC57C \uD569\uB2C8\uB2E4."),!0;h(e,m?"1":"3",function(){Participant.drawProjectParticipantItems(Detail.getProjectSrno(),!0),b(),c(),a.parents("li").attr("sendience_gb",m?"1":"3"),l.find("div").text(i18next.t(m?"front.common.setManager":"front.common.releaseManager")),m?l.parents("li").find(".manager-badge").remove():l.parents("li").append(i()),d.fadeOut(200)})}return!0}var e=$(a.target);(function(a){var c=a.findUp("#closeButton");return 0!==c.length&&(b(),!0)})(e)||function(a){var c=a.findUp("#allSendienceLayer"),d=a.findUp("#plusPopup");return 0===c.length&&0===d.length&&(b(),!0)}(e)||function(a){var b=a.findUp("#plusBtn");if(0===b.length)return!1;if(b.nextAll("#plusPopup").is(":visible"))b.nextAll("#plusPopup").fadeOut(200);else{var c="3"===b.parents("li").attr("sendience_gb"),d=b.parents("li").attr("data-id")===_USER_ID,e=b.nextAll("#plusPopup");$(".plus-popup").fadeOut(200),e.find("#export div").text(i18next.t(d?"dictionary.leave":"dictionary.dismiss")),e.find("#managerBtn div").text(i18next.t(c?"front.common.releaseManager":"front.common.setManager")),e.fadeIn(200)}return!0}(e)||d(e)||function(a){var b=a.findUp(".js-sendience-service-helper");if(!b||0===b.length)return!1;var c=FlowServiceHelper.SENDIENCE;return window.open(c,"_blank"),!0}(e)||function(a){var b=a.findUp(".js-profile");if(0===b.length)return!1;var c=b.parents(".js-participant-item").attr("data-id");return Profile.drawProfilePopup(c),!0}(e)||function(a){var b=a.findUp(".js-participant-item");if(0===b.length)return!1;var c=b.attr("data-id");return Profile.drawProfilePopup(c),!0}(e)}function g(a,d){function e(){return 1===j.find(".js-participant-item[sendience_gb=\"3\"]").length&&"3"===d?void Often.toast("error","\uD504\uB85C\uC81D\uD2B8 \uAD00\uB9AC\uC790\uB294 \uCD5C\uC18C \uD55C\uBA85\uC774 \uC874\uC7AC\uD574\uC57C \uD569\uB2C8\uB2E4."):void DetailSetting.deleteSendience("U",a,function(){return PopupDraw.closePopup(),a===_USER_ID?void b():void(c(),Participant.drawProjectParticipantItems(Detail.getProjectSrno(),!0,function(){}))})}var f=a===_USER_ID;PopupDraw.drawConfirm({contents:{main:Interpolation.breakLine(i18next.t(f?"front.alert.askLeaveProject":"front.alert.dismissParticipant"))},callback:{submit:e}})}function h(a,b,c){Ajax.executeApi(RestApi.PUT.COLABO2_SENDIENCE_U001,{COLABO_SRNO:Detail.getProjectSrno(),IN_RCVR_USER_ID:a,SENDIENCE_GB:b},function(){"3"===b?Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.edit)"})):Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.edit)"})),"function"==typeof c&&c()},function(a){"S0154"===a.COMMON_HEAD.CODE&&(Often.toast("error",i18next.t("front.alert.leaveProjectError")),PopupDraw.closePopup())})}function i(){return"<a href=\"#\" class=\"admin-invite-button-1 manager-badge\"><span>"+i18next.t("dictionary.administrator")+"</span></a>"}var j,k;return{openAllSendiencePopup:a,closeAllSendiencePopup:b}}();
"use strict";var DetailEvent=function(){function a(a){return $.isTarget(a,[".js-post-reaction",".js-emoji-select-layer",".js-emoji-group-layer"])?ItemReaction.clickReactionArea(a):$.isTarget(a,".js-post-bookmark")?ItemBookmark.toggleBookmark(a):void 0}function b(a){function b(){PostPopup.openEditView("copy"===k)}var c=$(a.target),d=c.parents(".detail-item"),e=Often.null2Void(d.find("#videoSpan").attr("data-vc-srno"),"0"),f=Often.null2Void(d.attr("data-post-url")),g=Often.null2Void(d.attr("data-project-srno")),h=Often.null2Void(d.attr("data-post-srno")),i="0"!==e;c.closest(".js-setting-ul").fadeOut(200);var j=c.closest(".js-setting-item"),k=j.attr("data-code");if("delete"===k)return s(g,h);if("url"===k)return Often.copyUrl(f);if("modify"===k||"copy"===k){if("copy"===k&&i)return Often.toast("error",i18next.t("front.alert.shareVideoMeetingWarning"));"modify"===k&&i&&LocalUtil.setLocal("VC_SRNO",e),$("#postPopup").is(":visible")&&h===PostPopup.getData().POST_SRNO?PostPopup.getPostData(g,h,"",!0,b):PostPopup.togglePostView(g,h,"",b)}}function c(a){var b=B(a).$eTarget.closest(".js-up-task-button"),c=b.attr("data-up-task-project-srno"),d=b.attr("data-up-task-post-srno");PostPopup.togglePostView(c,d)}function d(a){a.preventDefault();var b=$(a.target),c=b.closest(".js-hyper-button"),d=c.text();return m(d),!0}function f(a){var b=$(a.target),c=b.closest(".js-setting-button");c.next().is(":visible")?c.next().fadeOut(200):c.next().fadeIn(200)}function g(a){var b=B(a).$eTarget;return!b.hasClass("date")&&void PostPopup.checkWritingAndShowPopup(function(){var a=b.closest(".js-post-author"),c=a.attr("data-author-id");Profile.drawProfilePopup(c)})}function h(a){ViewChanger.loadPageJson({code:"detail",first:B(a).projectSrno})}function i(a){var b=$(a.target),c=$.trim(b.closest(".hashtag-span").text()),d=$("#hashtagUl").find(c);if(""!==c&&0!==d.length){var e=d.find(".hashtag").hasClass("on");e||HashTag.changeHashtagListStatusAndView(d)}}function j(a){var b=B(a),c=b.$eTarget.closest(".read-confirmation");PostReadCheck.showReadCheckPopUp(b.projectSrno,b.postSrno,c)}function k(a){a.preventDefault();var b=$(a.target),c=b.closest(".js-direct-href").attr("data-preview-url");m(c)}function l(a){if(0<a.closest(".js-del-btn").length)return!0;var b=a.closest(".js-map-item").attr("data-url");m(b)}function m(a){""===Often.null2Void($.trim(a))||UrlCatcher.isProjectInviteUrlAndAction(a)||UrlCatcher.isPostUrlAncAction(a)||(Electron.isElectronApp()?Electron.openExternalLinkforElectron(a):OpenUtil.openWindow(a,"_blank"))}function n(a){var b=B(a),c=b.$eTarget.closest(".image-item"),d=Often.getAttrs(c.parent().find(".image-item"));$.each(d,function(a,c){c.COLABO_SRNO=b.projectSrno,c.COLABO_COMMT_SRNO=b.postSrno});var e=c.parent().find(".image-item").index(c);ImageViewer.openImage("POST",d,e)}function o(a){var b=B(a),c=b.$eTarget,d=c.closest(".detail-item"),e=b.projectSrno,f=b.postSrno;if(0===c.closest(".js-pin-authority").length)return void Often.toast("error","\uD504\uB85C\uC81D\uD2B8 \uAD00\uB9AC\uC790 + \uAE00 \uC791\uC131 \uBCF8\uC778\uB9CC \uC0C1\uB2E8\uACE0\uC815 \uC124\uC815/\uD574\uC81C \uAC00\uB2A5\uD569\uB2C8\uB2E4.");var g=c.hasClass("on"),h={COLABO_SRNO:e,COLABO_COMMT_SRNO:f},i={PROJECT_SRNO:e,POST_SRNO:f};PopupDraw.drawConfirm({contents:{main:i18next.t("front.alert.pinPost",{status:g?"$t(dictionary.unPin)":"$t(dictionary.pin)"})},callback:{submit:function(){return UpdateElements.autoUpdateElem($.extend({},i,{PIN_MODE:g?"DELETE":"PIN"})),g?void Ajax.executeApi(RestApi.DELETE.COLABO2_PIN_D001,h,function(){Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.change)"})),c.removeClass("on")}):void Ajax.executeApi(RestApi.POST.COLABO2_PIN_C001,$.extend({},h,{packetOption:Ajax.OPTION.PREVENT_EXECUTE}),function(){var a=d.find(".remark-item:last").attr("remark-srno");UpdateElements.autoUpdateElem({PROJECT_SRNO:e,POST_SRNO:f,REMARK_SRNO:a,REMARK_UPDATE:!0}),Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.change)"})),c.addClass("on")})}}})}function p(a){var b=B(a),c=Often.getAttrs(b.$eTarget.closest(".js-post-file"))[0];c.COLABO_SRNO=b.projectSrno,c.COLABO_COMMT_SRNO=b.postSrno;var d="GOOGLEDRIVE"===c.RAND_KEY||"DROPBOX"===c.RAND_KEY;if(d)return FileUtil.downFile(c.ATCH_URL,d);var e=0<b.$eTarget.closest(".js-down-btn").length,f=e||d?"SAVE":"DOC-VIEWER";FileUtil.openFile(f,[c])}function q(a){var b=$(a.target),c=b.parents(".detail-item");c.find("#summaryPost, #postMoreButton, #summaryFoldArea").css("display","none"),c.find("#originalPost").css("display","block")}function r(a){var b=B(a);PostPopup.togglePostView(b.projectSrno,b.postSrno,"",function(){$("#detailUl").find(".highlight").removeClass("highlight"),b.$eTarget.closest(".list-item").addClass("highlight").find(".js-indication").css("display","none")})}function s(a,b){function c(){Ajax.executeApi(RestApi.DELETE.COLABO2_COMMT_D101,{COLABO_SRNO:a,COLABO_COMMT_SRNO:b},function(){Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.delete)"})),PostPopup.removePopup();var c={PROJECT_SRNO:a,POST_SRNO:b};PostPopup.removePopup(),UpdateElements.autoUpdateElem($.extend({},c,{PIN_MODE:"DELETE"})),UpdateElements.autoUpdateElem($.extend({},c,{POST_MODE:"DELETE"}))})}var d=Often.null2Void($("#post-"+b).find("#videoSpan").attr("data-vc-srno"));PopupDraw.drawConfirm({contents:{main:i18next.t("front.common.ask",{val:"$t(dictionary.article)",status:"$t(dictionary.delete)"})},callback:{submit:function(){return VideoConference.isVC(d)?void VideoConference.deleteZoomToken({VC_SRNO:d},c):void c()}}})}function t(){InviteProject.openInvite(Detail.getProjectSrno())}function u(a){var b=$(a.target),c=$(a.currentTarget),d=b.closest(".post-filter"),e=Often.null2Void(d.attr("data-post-code"),c.find(".post-filter:first").attr("data-post-code")),f=c.hasClass("admin");Authority.isAdminAuthorityCheckAndAction(f)||PostPopup.openRegistrationView(Detail.getProjectSrno(),e,!0)}function v(){var a=+LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","SENDIENCE_CNT"),b=Detail.getProjectSrno(),c=LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","MNGR_WR_YN");Authority.isAdminAuthorityCheckAndAction("Y"===c)||(1<a?PostPopup.openRegistrationView(b,DetailCode.WRITE,!0):InviteProject.openInvite(b))}function w(a){function b(a,b){Ajax.executeApi(RestApi.GET.FLOW_VIEW_TYPE_U001,{COLABO_SRNO:Detail.getProjectSrno(),VIEW_TYPE:a},b)}var c=$(a.target),d=c.closest("#feedTypeButton"),e=c.closest(".feed-type-button"),f=c.closest(".js-feed-filter-button"),g=$(a.currentTarget).find(".js-feed-filter-layer"),h=c.closest(".check-menu-item");if(0<e.length)return void PostPopup.checkWritingAndShowPopup(function(){var a=e.hasClass("card")?"card":"list",c="card"===a?"F":"L";b(c,function(){LocalUtil.setLocal("FEED_TYPE",a),LocalUtil.setLocalValue("CURRENT_PROJECT_SETTING","VIEW_TYPE",c),Detail.setFeedType(a),Detail.drawPostList(),"card"===a&&PostPopup.removePopup()})});if(0<f.length)return g.is(":visible")?g.fadeOut(200):g.fadeIn(200),void f.toggleClass("active");if(0<h.length){h.parents(".section-title-area").find(".js-feed-filter-button").removeClass("active"),g.find(".check-menu-item").removeClass("on"),h.addClass("on"),g.fadeOut(200);var i=$("#projectFeedArea");i.find("#allPostsFilterTitle").text(h.text());var j=""===h.attr("data-code");i.find(".js-filter-reset").css("display",j?"none":"block"),j?d.find(".js-feed-filter-button").removeClass("active"):d.find(".js-feed-filter-button").addClass("active"),Detail.drawPostList(!0)}}function x(a){var b=$(a.currentTarget);if(0!==$(a.target).closest(".section-title-area").length){b.find(".js-report-btn").toggleClass("off");var c;b.find(".js-task-report-layer").is(":visible")?(c="N",b.find(".js-task-report-layer").slideUp(300)):(c="Y",b.find(".js-task-report-layer").slideDown(300)),Ajax.executeApi(RestApi.PUT.FLOW_TASK_REPORT_U001,{COLABO_SRNO:Detail.getProjectSrno(),TASK_REPORT_VIEW_YN:c})}}function y(a){var b=$(a.target),c=b.closest(".js-hidden-component");return"VIEW"!==Detail.getPostStatus()&&(c.attr({class:"edit-component",contenteditable:""}).text(""),!0)}function z(){var a=$("#projectFeedArea"),b=-1<a.find("#allPostsFilterTitle").text().indexOf("#");return b?(HashTag.setUnHashtagView(),void Detail.drawPostList(!1)):void(A(a),Detail.drawPostList(!0))}function A(a){var b=a.find(".js-feed-filter-layer");b.find(".check-menu-item").removeClass("on"),a.find(".js-feed-filter-button").removeClass("active"),b.find(".check-menu-item[data-code=\"\"]").addClass("on"),a.find("#allPostsFilterTitle").text(i18next.t("dictionary.all")),a.find(".js-filter-reset").css("display","none")}function B(a){var b=$(a.target),c=b.closest(".js-popup-before"),d=Often.null2Void(c.attr("data-project-srno")),e=Often.null2Void(c.attr("data-post-srno")),f=c.attr("data-code");return{$eTarget:b,projectSrno:d,postSrno:e,viewType:f}}function C(a){return"VIEW"===B(a).viewType}return{addClickEventOnDetailView:function(){$("#taskReportLayer").off("click").on("click",TaskReport.clickTaskReportLayer),$("#feedTypeButton").off("click").on("click",w),$("#createPostArea").off("click").on("click",u),$("#taskReportArea").off("click").on("click",x),$("#postMoreBtn").off("click").on("click",Detail.clickPostMore),$("#openInviteLayerBtn").off("click").on("click",t),$("#allSendienceBtn").off("click").on("click",AllSendience.openAllSendiencePopup),$(".js-detail-top-search-button").off("click").on("click",ProjectSearch.clickProjectDetailSearchTopButton),$("#projectFeedArea").find(".js-filter-reset").off("click").on("click",z),$("#projectSearchInput").off("keyup").on("keyup",ProjectSearch.keydownProjectSearchInput)},clickDetailUl:function(m){if(m.stopPropagation(),PostPopupEvent.hideAllInnerPopup(m),$.isTarget(m,".js-project-title-button"))return function(){return h(m)}();if($.isTarget(m,".js-up-task-button"))return c(m);if($.isTarget(m,".js-post-author"))return g(m);if($.isTarget(m,".js-pin-post"))return o(m);if($.isTarget(m,".js-setting-button"))return f(m);if($.isTarget(m,".js-setting-item"))return b(m);if($.isTarget(m,".js-hyper-button"))return d(m);if(C(m)&&$.isTarget(m,".js-direct-href"))return k(m);if(C(m)&&$.isTarget(m,".mention-span"))return Mention.openProfile(m);if(C(m)&&$.isTarget(m,".hashtag-span"))return i(m);if(C(m)&&$.isTarget(m,".js-map-item"))return l(m);if($.isTarget(m,".js-contents-more-btn"))return q(m);if($.isTarget(m,".js-task-option"))return ItemTask.clickTaskComponent(m);if($.isTarget(m,".js-hidden-component"))return y(m);if($.isTarget(m,".js-subtask-area"))return ItemSubtask.clickSubtaskComponent(m);if($.isTarget(m,".js-schedule-comp"))return ItemSchedule.clickScheduleComponent(m);if($.isTarget(m,".js-todo-component"))return ItemTodo.clickTodoComponentInDetail(m);if(!$.isTarget(m,[".js-remark-layer",".js-del-btn"])){if(C(m)&&$.isTarget(m,".js-post-file"))return p(m);if(C(m)&&$.isTarget(m,".image-item"))return n(m)}if($.isTarget(m,".js-reaction-bookmark"))return a(m);if($.isTarget(m,".read-confirmation"))return j(m);if($.isTarget(m,[".js-comment-area",".js-remark-layer"]))return ItemRemark.clickRemarkComponent(m);if($.isTarget(m,"#detailUl")){if($.isTarget(m,".list-item"))return r(m);if($.isTarget(m,"#noDetailDataBnt"))return v()}},resetFilter:A}}();
"use strict";var DetailHeader=function(){function a(){h=$("#detailTop"),i=h.find("#detailSettingTopButton")}function b(b,c){function f(){var a=!t.hasClass("unstar");ProjectSetting.setProjectStar(b.COLABO_SRNO,a,function(){g(t,!a)})}function g(a,b){a.attr("class","bookmark-button"+(b?"":" unstar"))}if(b){a();var j=$.trim(b.TTL),k=$.trim(b.CNTN),l="Y"===b.IMPT_YN,m=""!==Often.null2Void(b.COLABO_GB,""),n="N"!==Often.null2Void(b.CMNM_YN,"N"),o=ListHelper.getColorClassName(b.BG_COLOR_CD),p=ListHelper.getColorClassNameOnInviteBtn(b.BG_COLOR_CD),q=$("#projectContents"),r=$("#projectColor"),s=$("#openInviteLayerBtn"),t=$("#projectStar"),u=$("#detailTab");$("#projectTitle").text(j).attr("mouseover-text",j),$("#participantCount").text(Often.numberWithCommas(b.SENDIENCE_CNT)),d(b),document.title=j+" - "+i18next.t("front.common.flowTitle"),r.attr("class","").addClass("project-color").addClass(o),s.attr("class","").addClass("project-invite-button").addClass(p),s.css("display",m||n?"none":"block"),g(t,l),q.text(k),q.addClass("js-mouseover").attr("mouseover-text",k),q.parent().css("display",""===k?"none":"block"),u.find(".js-tab-item").removeClass("active"),u.find(".js-tab-item[data-code="+Often.null2Void(c,"home")+"]").addClass("active"),u.find(".js-tab-item.gantt").css("display",Often.isFunc(Func.CLOUD.GANTT)?"block":"none"),t.off("click").on("click",f),r.off("click").on("click",DetailSetting.changeProjectColor),u.off("click").on("click",e),i.off("click").on("click",DetailSetting.clickDetailSettingBtn),h.css("display","block")}}function c(c){return a(),c===LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","COLABO_SRNO")?void b({TTL:LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","TTL"),IMPT_YN:LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","IMPT_YN"),BG_COLOR_CD:LocalUtil.getProjectBgColorCd(),SENDIENCE_CNT:LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","SENDIENCE_CNT")}):h.css("display","none")}function d(b){a();b&&(b.PUSH_ALAM_YN&&$("#unalarmIcon").css("display","N"===b.PUSH_ALAM_YN?"inline-block":"none"),b.JNNG_ATHZ_YN&&$("#lockIcon").css("display","Y"===b.JNNG_ATHZ_YN?"inline-block":"none"),b.CMNM_YN&&$("#companyIcon").css("display","Y"===b.CMNM_YN?"inline-block":"none"),b.OPEN_YN&&$("#openProjIcon").css("display","Y"===b.OPEN_YN?"inline-block":"none"))}function e(a){j||(f(a),j=!0,g=setTimeout(function(){j=!1,clearTimeout(g)},500))}function f(a){var b=$(a.target),c=b.closest(".js-tab-item");if(0!==c.length){var d=Often.null2Void(c.attr("data-code"),"home"),e=Detail.getProjectSrno();if("gantt"===d)return OpenUtil.openGanttChart(e);ProjectSearch.hideSearchProjectList(),DetailHeader.drawInitProjectHeader(d,e);var f={first:e};return"task"===d?ViewChanger.loadPageJson($.extend({code:"task"},f)):"calendar"===d?ViewChanger.loadPageJson($.extend({code:"schd"},f)):"file"===d?ViewChanger.loadPageJson($.extend({code:"file"},f)):"history"===d?ViewChanger.loadPageJson($.extend({code:"history"},f)):void ViewChanger.loadPageJson($.extend({code:"detail"},f))}}var g,h,i,j=!1;return{drawProjectHeaderItem:b,drawTempProjectHeaderItem:c,drawInitProjectHeader:function(a,c){Detail.setProjectSrno(c),b(LocalUtil.getLocalJson("CURRENT_PROJECT_SETTING"),a)},setProjectIcon:d}}();
"use strict";var DetailSetting=function(){function a(){$("#detailSettingProjectSrno").text(Detail.getProjectSrno());var a=Authority.isAuthorityCheck("ADMIN"),b="#detailSettingProject";x.find(b+"UpdateBtn, "+b+"DeleteBtn, "+b+"ManagerBtn").css("display",a?"block":"none"),x.css("display","block"),$("#detailSettingGroup").off("click").on("click",e)}function b(){d(),x.css("display","none")}function c(c){c.stopPropagation(),d(),x.is(":visible")?b():a()}function d(){var a="Y"===LocalUtil.getProjectHiddenYn();x=$("#detailSettingLayer"),$("#hideText").html("<i class=\"icon-set-hide\"></i>"+i18next.t(a?"front.common.unHide":"dictionary.hide")),w=!0}function e(a){function c(a,b){return 0<a.findUp("#"+b).length}var d=$(a.target);return b(),c(d,"detailSettingColorBtn")?f():c(d,"detailSettingLabelBtn")?g():c(d,"detailSettingPushAlarmBtn")?h():c(d,"detailSettingHideBtn")?i():c(d,"detailSettingProjectExitBtn")?p():c(d,"detailSettingProjectDeleteBtn")?r():c(d,"detailSettingProjectUpdateBtn")?u(a):void 0}function f(){var a=LocalUtil.getProjectBgColorCd();PopupDraw.drawColorSetting({callback:{submit:function(b){var c=Often.null2Void(b.find(".project-color-check-active-1").attr("color-code"),"0");a===c||j(c,PopupDraw.closePopup)},final:function(b){b.find(".color-item").removeClass("project-color-check-active-1"),b.find(".color-item.project-color-type-"+a).addClass("project-color-check-active-1")}}})}function g(){PopupDraw.drawLabelSetting({callback:{submit:function(a){var b=a.find(".flow-content-check-type-2").parents(".label-item");l(b,PopupDraw.closePopup)}}})}function h(){PopupDraw.drawPushAlarmSetting({callback:{submit:function(a){var b=a.find(".push-alarm-content");n(b,PopupDraw.closePopup())}}})}function i(){var a=LocalUtil.getProjectHiddenYn(),b="Y"===a?"N":"Y",c={COLABO_SRNO:Detail.getProjectSrno(),HIDDEN_YN:b,packetOption:Ajax.OPTION.PREVENT_EXECUTE};Ajax.executeApi(RestApi.POST.COLABO2_C105,c,function(){LocalUtil.setLocalValue("CURRENT_PROJECT_SETTING","HIDDEN_YN",b),$("#hideText").html("<i class=\"icon-set-hide\"></i>"+i18next.t("Y"===b?"front.common.unHide":"dictionary.hide")),Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.apply)"}))})}function j(a,b){"function"==typeof b&&b(),k(a)}function k(a){Ajax.executeApi(RestApi.PUT.COLABO2_BG_COLOR_U001,{COLABO_SRNO:Detail.getProjectSrno(),BG_COLOR_CD:a},function(){LocalUtil.setLocalValue("CURRENT_PROJECT_SETTING","BG_COLOR_CD",a),function(b){ListHelper.removeAllColorClass(b),b.addClass("color-code-"+a)}($("#projectColor, #openInviteLayerBtn, #projectTitleColor")),AllCalendar.reloadCalendar()})}function l(a,b){"function"==typeof b&&b(),m(a)}function m(a){var b=[],c="";$.each(a,function(a,d){b.push({COLABO_FLD_KIND:$(d).attr("data-label-kind"),COLABO_FLD_SRNO:$(d).attr("data-label-srno"),ICO_CODE:$(d).attr("data-label-ico")}),c+=b[a].COLABO_FLD_SRNO+","}),Ajax.executeApi(RestApi.POST.COLABO2_C103,{COLABO_SRNO:LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","COLABO_SRNO"),COLABO_FLD_REC:b,packetOption:Ajax.OPTION.PREVENT_EXECUTE},function(){LocalUtil.setLocalValue("CURRENT_PROJECT_SETTING","LABEL_SRNOS",c.slice(0,-1)),Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.apply)"}))})}function n(a,b){"function"==typeof b&&b(),o(a)}function o(a){var b=a.find(".alarm-popup-set").attr("data-push-alarm"),c={COLABO_SRNO:LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","COLABO_SRNO"),PUSH_ALAM_YN:b,PUSH_COMMT_ALAM_YN:a.find(".js-push-commt").attr("data-push"),PUSH_REMARK_ALAM_YN:a.find(".js-push-remark").attr("data-push"),ALAM_LIST:a.find(".alarm").attr("data-alarm-list")};Ajax.executeApi(RestApi.PUT.COLABO2_NOTI_U101,c,function(){DetailHeader.setProjectIcon(c),Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.apply)"}))})}function p(){PopupDraw.drawConfirm({contents:{main:Interpolation.breakLine(i18next.t("front.alert.askLeaveProject"))},callback:{submit:function(){q("U",_USER_ID)}}})}function q(a,b,c){var d={COLABO_SRNO:Detail.getProjectSrno(),RCVR_GB:a,RCVR_USER_ID:b};Ajax.executeApi(RestApi.DELETE.COLABO2_SENDIENCE_D001,d,function(){b===_USER_ID?(Often.toast("success",i18next.t("front.alert.leaveProject")),ViewChanger.loadPage("main"),PopupDraw.closePopup()):Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.dismiss)"})),"function"==typeof c&&c()},function(a){var b=a.COMMON_HEAD.CODE;"S0151"===b&&Often.toast("error",Often.null2Void(a.COMMON_HEAD.MESSAGE,"\uD504\uB85C\uC81D\uD2B8 \uAD00\uB9AC\uC790\uB294 \uCD5C\uC18C \uD55C\uBA85\uC774 \uC874\uC7AC\uD574\uC57C\uD569\uB2C8\uB2E4.")),"WCB013"===b&&Often.toast("error",i18next.t("front.alert.cannotLeaveProject")),PopupDraw.closePopup()})}function r(){return s()?void Often.toast("error",i18next.t("front.alert.leaveProjectError")):void PopupDraw.drawConfirm({contents:{main:i18next.t("front.common.ask",{val:"$t(dictionary.project)",status:"$t(dictionary.delete)"})},callback:{submit:t}})}function s(){return 0<$("#detailUl").find(".detail-item").length}function t(){PopupDraw.closePopup();var a={COLABO_SRNO:Detail.getProjectSrno()};Ajax.executeApi(RestApi.DELETE.COLABO_D101,a,function(){BaseSetting.setBuySetting(function(){Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.delete)"})),ViewChanger.loadPage("main")})})}function u(a){v(),ProjectMake.openPopup(a)}function v(){var a=LocalUtil.getLocalJson("CURRENT_PROJECT_SETTING"),b={TITLE:a.TTL,CONTENTS:a.CNTN,OPEN_YN:a.OPEN_YN,CATEGORY_SRNO:a.CNTS_CATG_SRNO,CATEGORY_NM:a.CNTS_CATG_NM,MANAGER_PERMIT_YN:a.JNNG_ATHZ_YN,MANAGER_WRITE_YN:a.MNGR_WR_YN,MANAGER_WRITE_REMARK_YN:a.MNGR_WR_CM_YN,MANAGER_LOOKUP_YN:a.SRCH_AUTH_YN,MANAGER_DOWNLOAD_YN:a.PRJ_AUTH};ProjectMake.setProjectMakeData(b)}var w,x;return{openDetailSettingLayer:a,closeDetailSettingLayer:b,clickDetailSettingBtn:c,removeWorker:function(a){PopupDraw.drawConfirm({contents:{main:a.CONTENTS},callback:{submit:a.CALLBACK,cancel:function(){Often.toast("error",i18next.t("front.common.canceled"))}}})},changeProjectColor:f,deleteSendience:q}}();
"use strict";var HashTag=function(){function a(){return E}function b(a){a.stopPropagation();var b=$(a.target);if(r=b.findUp("#postPopup"),s=r.find("#innerCommonHashTagPopup"),!s.isArrowSelect(a)){if(E&&KeyCheck.isKey(a,"SPACE_BAR"))return a.preventDefault();if(E&&KeyCheck.isKey(a,"ENTER")){var c=s.find(".hashtag-popup").find(".select");if(0===c.length)return;a.preventDefault(),i(c.find(".hashtag-item-title").text(),!0)}}}function c(a){function b(){w=$("#projectHashtagArea"),x=$("#hashtagUl"),y=$("#hashtagMoreButton")}function c(){z=$($("#hashTagLayer").html()),A=$("<span class=\"tag hashtag-span\" contenteditable=\"false\"></span>")}function e(){y.off("click").on("click",function(){""===D||!1===D?(x.css("height","auto"),x.css("overflow","visible"),y.removeClass("active"),D=!0):(x.css("height","40px"),x.css("overflow","hidden"),y.addClass("active"),D=!1)})}return function(){b(),c(),e()}(),x.empty(),0===a.length?w.addClass("d-none"):void(x.append(d(a)),setTimeout(q,200),m(),w.removeClass("d-none"))}function d(a){var b=$("#hastTagTransverseItem").html(),c="";return $.each(a,function(a,d){c+=ListHelper.replaceJson(b,{"tag-name":Often.null2Void(d.TAG_NM,"")})}),c}function e(a){function b(){if(E){var a=s.find(".hashtag-popup");Caret.captureIndex("#"),ListHelper.initPageData(B,a),h(),Caret.saveCaret(),clearTimeout(u)}}if(PostCondition.getFuncCondition().isHashTag){if(Mention.getStatus())return void(E=!1);var c=$(a.target);r=c.findUp("#postPopup");var d=c.findUp(".js-popup-before");if(0!==d.length){if(s=r.find("#innerCommonHashTagPopup"),0===r.length)return void(E=!1);if(0===s.length&&z&&(d.before(z.attr({id:"innerCommonHashTagPopup","data-code":"hashTag"})),s=r.find("#innerCommonHashTagPopup")),B.COLABO_SRNO=LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","COLABO_SRNO"),l(s),KeyCheck.isKey(a,"BACK")||KeyCheck.isKey(a,"ESC"))f();else if(E&&(KeyCheck.isKey(a,"SPACE_BAR")||KeyCheck.isKey(a,"ENTER"))){a.preventDefault(),f();var e=Caret.getInput().trim();return"#"===e?void 0:-1<e.indexOf("[")||-1<e.indexOf("]")?Often.toast("error","[, ]\uB294 \uC0AC\uC6A9\uD560 \uC218 \uC5C6\uC2B5\uB2C8\uB2E4."):void j(e)}return g(a)?(E=!0,v=Caret.getPosition(),u&&clearTimeout(u),void(u=setTimeout(b,100))):void(t&&clearTimeout(t),t=setTimeout(function(){Caret.isTextInput(a)&&b()},100))}}}function f(){E=!1;s&&0!==s.length&&(s.find(".select").removeClass("select"),s.css({display:"none"}))}function g(a){var b=Caret.getInput(),c=0===b.trim().indexOf("#"),d="#"===b.trim(),e=a.shiftKey&&51===a.keyCode&&c,f="#"===a.key&&c,g=a.shiftKey&&"#"===a.key&&d,h="3"===a.key&&d,i=KeyCheck.isKey(a,"BACK")&&c&&b.trim().length===b.length;return e||f||g||h||i}function h(){function a(a,c){function d(b){var c,d=r.find(".edit-item");if(0===a.length)c={display:"none"};else{var f=v.y-d.offset().top+20,g=v.x;c={transform:"translate("+g+"px, "+f+"px)",display:"block"}}s.css(c),e&&(s.attr("data-code","hashTag"),b.scrollTop(0),ListHelper.selectFirstItemByArrow(b))}var e=1===B.PG_NO;s.find(".hashtag-popup").drawListHelper({pageData:B,nextYn:c,records:a,callback:{click:function(a){var b=$(a.target),c=b.findUp(".hashtag-item");0===c.length||(a.preventDefault(),i(c.find(".hashtag-item-title").text()))},item:b,final:d}})}function b(a){var b="",c=$("#hashTagItem").html();return $.each(a,function(a,d){b+=ListHelper.replaceJson(c,{tagName:Often.null2Void(d.TAG_NM,""),refCount:Often.null2Void(d.REF_CNT,"")})}),b}var c=Often.null2Void(Caret.getInput().trim()),d=c.match(/#/gi);if(d){var e=1===d.length,f=c.replace(e?"#":/^#.*#/gi,"");s.css("display","none"),Ajax.executeApi(RestApi.GET.FLOW_TAG_R001,$.extend({},B,{SRCH_WD:f,SORT_DESC:"N"}),function(b){a(b.TAG_REC,b.NEXT_YN)})}}function i(a,b){f();var c=A.clone();c.text("#"+a),b?setTimeout(function(){Caret.changeAndFocusNode(c)},0):Caret.changeAndFocusNode(c)}function j(a){var b=A.clone(),c=k(a);b.text(c),Caret.captureIndex("#"),setTimeout(function(){Caret.changeAndFocusNode(b)},0),f()}function k(a){var b=Often.null2Void(a).replace(/(#[^\[\]\s]*$)/ig,"").length,c=a.substring(b);return 1<c.length?c:"#"}function l(a){a.css("width","256px")}function m(){$("#hashtagUl").off("click").on("click",function(a){var b=$(a.target),c=b.findUp(".hashtag-item");0===c.length||n(c)})}function n(a){var b=a.children().text();""===Often.null2Void(C)?(DetailEvent.resetFilter($("#projectFeedArea")),C=Often.null2Void(b,""),o(C),Detail.drawHashtagPostList()):C===b?C===b&&(p(),Detail.drawPostList()):(C=Often.null2Void(b,""),o(C),Detail.drawHashtagPostList())}function o(a){var b=$("#projectFeedArea");$("#projectPinArea").css("display","none"),b.find("#allPostsFilterTitle").text(a),b.find(".js-filter-reset").css("display","block"),b.find(".js-feed-filter-button").css("display","none")}function p(){var a=$("#projectFeedArea");$("#projectPinArea").css("display","block"),a.find("#allPostsFilterTitle").text(i18next.t("dictionary.all")),a.find(".js-filter-reset").css("display","none"),a.find(".js-feed-filter-button").css("display","inline-block"),C=""}function q(){var a=x.find(".hashtag-item"),b=a.first().offset(),c=a.last().offset();b&&c&&b.top!==c.top?y.css("display","block").addClass("active"):y.css("display","none").removeClass("active")}var r,s,t,u,v,w,x,y,z,A,B={PG_NO:1,PG_PER_CNT:100,NEXT_YN:"Y",COLABO_SRNO:""},C="",D=!1,E=!1;return{setUnHashtagView:p,getStatus:a,keyDownArrow:b,keyUpCheckHashTag:e,clearHashTag:f,drawProjectHashtagItemsByRecord:c,changeHashtagListStatusAndView:n}}();
"use strict";var InviteProject=function(){function a(a,e){var f=StatusCode.UN_BFLOW.GUEST===LocalUtil.getLocalValue("ONLY_BUY_SETTING","STTS");if(n=Often.null2Void(a),m=$("#inviteLayer"),""!==n){var g=$("#projectColor").attr("class"),h=TagUtil.tag2html($("#projectTitle").text());$("#inviteTitle").html("<i class=\""+g+"\"></i>"+h)}return b(),k(f),""===Often.null2Void(e)?void d(function(){c(),m.fadeIn(200)}):void TeamInvite.openTeamInviteLayer(e,!0)}function b(){$("#inviteLayer").off("click keyup").on("click",e).on("keyup",g)}function c(){PopupDraw.closePopup(),h(),$("#selectMemberList").empty(),$("#inviteMainLayer").css("display","block")}function d(a){return""===Often.null2Void(n)?a():void Ajax.executeApi(RestApi.POST.COLABO2_INVT_C001,{COLABO_SRNO:n,GB:"CI",RENEWAL_YN:"Y",packetOption:Ajax.OPTION.PREVENT_EXECUTE},function(b){$("#inviteLink").text(b.INVT_URL),a()})}function e(a){var b=$(a.target);(function(a){var b=a.findUp(".closeInviteLayerBtn");return 0!==b.length&&(Often.isAct("subscreen")?window.close():f(i),!0)})(b)||function(a){if(Often.isAct("subscreen"))return!1;var b=a.findUp("#inviteMainLayer"),c=a.findUp("#sendInviteEmlLayer"),d=a.findUp("#teamInviteLayer");return 0===b.length&&0===c.length&&0===d.length&&(f(i),!0)}(b)||function(a){var b=a.findUp(".returnMainBtn");return 0!==b.length&&(f(c),!0)}(b)||function(a){var b=a.findUp("#inviteUl");return 0!==b.length&&!!l(a)}(b)||TeamInvite.isTeamInviteMenuAndAction(b)||TeamInvite.isSubmitInviteAndAction(b)||EmailInvite.isSendInviteEmailAndAction(b)||EmailInvite.isAddEmailAndAction(b)||EmailInvite.isEmailListAndAction(b)}function f(a){var b=m.find("#selectMemberList li"),c=$("#sendInviteEmlLayer").is(":visible")&&EmailInvite.isCheckWriteEmail();return 0!==b.length||c?void PopupDraw.drawConfirm({contents:{main:c?"\uC791\uC131\uC911\uC778 \uB0B4\uC6A9\uC774 \uC788\uC2B5\uB2C8\uB2E4. \uB098\uAC00\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?":"\uC120\uD0DD\uB41C \uCC38\uC5EC\uC790\uAC00 \uC788\uC2B5\uB2C8\uB2E4. \uB098\uAC00\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"},callback:{submit:a}}):a()}function g(a){TeamInvite.isTeamInviteSearchAndAction(a)}function h(){j(),$("#teamInviteLayer, #inviteMainLayer, #sendInviteEmlLayer, #inviteEmplArea").css("display","none")}function i(){PopupDraw.closePopup(),j(),m.css("display","none")}function j(){var a=$("#sendInviteEmlLayer");$("#teamInviteArea").scrollTop(0),a.find(".invite-email-area").scrollTop(0),a.find(".emailItemInput").val("")}function k(a){var b=$("#openTeamInvite").find("em");Often.isFunc("INVITATION_POPUP")?b.text(a?"\uD504\uB85C\uC81D\uD2B8\uB97C \uD568\uAED8\uD588\uB358 \uC0AC\uB78C\uB4E4\uC744 \uCD08\uB300\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.":"\uC9C1\uC6D0 \uBC0F \uD504\uB85C\uC81D\uD2B8\uB97C \uD568\uAED8\uD588\uB358 \uC0AC\uB78C\uB4E4\uC744 \uCD08\uB300\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."):b.text("\uD68C\uC0AC \uC9C1\uC6D0 \uB610\uB294 \uC870\uC9C1\uB3C4\uB97C \uD655\uC778\uD558\uACE0 \uCD08\uB300\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4.")}function l(a){return 0<a.findUp("#copyInviteLink").length?(Often.copyUrl($("#inviteLink").text()),!0):0<a.findUp("#openSendEml").length?(EmailInvite.openSendInviteEmlLayer(),!0):0<a.findUp("#openTeamInvite").length?Often.isFunc("INVITATION_POPUP")?(InvitationPopup.openInvitationPopup(),!0):LimitGuest.isLimitGuest("invite",_IsMini)?void 0:(TeamInvite.openTeamInviteLayer("team"),!0):!!(0<a.findUp("#openSendienceInvite").length)&&(TeamInvite.openTeamInviteLayer("sendience"),!0)}var m,n;return{openInvite:a,closeInvite:i,closeAllInviteLayer:h,addInviteEvent:b,openInviteMain:c,drawExitPopup:f,backInviteMain:function(){f(c)},clickInvitePopup:e}}();
"use strict";var Participant=function(){function a(){var a=$("#projectParticipants");a.is(":visible")&&a.css("transform","translateX("+(0-$(document).scrollLeft())+"px")}function b(d,e,g){var i=$("#participantArea");if(e){var n=$(".participants-menu").find(".js-video-chat");Often.showOrHideByFunc("VIDEO_CONFERENCE",n),ListHelper.initPageData(m),i.addClass("d-none"),j=!1,k=!1,l=!1}else;"N"===m.NEXT_YN||Ajax.executeApi(RestApi.GET.COLABO2_SENDIENCE_R101,$.extend({},m,{COLABO_SRNO:d}),function(i){if(e){o.manager=i.MNGR_CNT,o.outer=i.OUT_SENDIENCE_CNT,o.inner=i.IN_SENDIENCE_CNT,$("#participantCount").text(Often.numberWithCommas(i.SENDIENCE_CNT));var j=LocalUtil.getLocalValue("ONLY_BUY_SETTING","BUY_YN")===BuyCode.PAID_COMPANY,k=j&&0<+i.OUT_SENDIENCE_CNT;$("#detailTop").find("#externalIcon").css("display",k?"inline-block":"none"),LocalUtil.setLocalValue("CURRENT_PROJECT_SETTING","SENDIENCE_CNT",i.SENDIENCE_CNT)}$("#participantsUl").drawListHelper({pageData:m,nextYn:i.NEXT_YN,records:i.SENDIENCE_REC,targetObj:{scroll:$(".participants-content-group")},callback:{item:c,scroll:function scroll(){return b(d)},click:f}}),$("#participantArea").off("click").on("click",h).removeClass("d-none"),a(),"function"==typeof g&&g()})}function c(a){var b="",c=$("#participantItem").html();return $.each(a,function(a,d){var f=Often.null2Void(d.RCVR_CORP_NM,""),g=Often.null2Void(d.RCVR_DVSN_NM,"");d.STATUS!==ParticipantCode.MANAGER||j||(j=!0,b+=e(d.STATUS)),d.STATUS!==ParticipantCode.OUTER||l||(l=!0,b+=e(d.STATUS)),d.STATUS!==ParticipantCode.INNER||k||(k=!0,b+=e(d.STATUS));var h=Often.null2Void(d.RCVR_USER_ID?d.RCVR_USER_ID:d.USER_ID,""),i=_USER_ID===h;b+=ListHelper.replaceJson(c,{name:Often.null2Void(d.RCVR_USER_NM,d.USER_NM)+(i?" (\uB098) ":""),team:Often.null2Void(d.RCVR_DVSN_NM,""),position:Often.null2Void(d.JBCL_NM,""),company:Often.null2Void(d.RCVR_CORP_NM,""),profile:ListHelper.setProfile(d.PRFL_PHTG),"personal-display":ListHelper.setDisplay(Often.isFunc(Func.CLOUD.PARTICIPANTS_INFO)&&!(""===f&&""===g),"flex"),"worker-id":h})}),b}function d(a){var b="",c=$("#participantItem").html(),d=a[0],e=Often.null2Void(d.RCVR_CORP_NM,""),f=Often.null2Void(d.RCVR_DVSN_NM,"");return b+=ListHelper.replaceJson(c,{name:Often.null2Void(d.USER_NM)+(1<a.length?"\uC678 "+(a.length-1)+"\uBA85":""),team:Often.null2Void(f,""),position:Often.null2Void(d.JBCL_NM,""),company:Often.null2Void(e,""),profile:ListHelper.setProfile(d.PRFL_PHTG),"personal-display":ListHelper.setDisplay(Often.isFunc(Func.CLOUD.PARTICIPANTS_INFO)&&!(""===e&&""===f),"flex"),"worker-id":d.USER_NM}),b}function e(a){var b=a===ParticipantCode.MANAGER?i18next.t("front.common.projectManager"):a===ParticipantCode.OUTER?i18next.t("dictionary.partner"):i18next.t("dictionary.employee");var c=a===ParticipantCode.MANAGER?"manager":a===ParticipantCode.OUTER?"outer":"inner";return"<span class=\"participants-title\"><em>"+b+"</em><span id=\""+c+"ParticipantsCount\" class=\"number-of-participants\">"+o[c]+"</span></span>"}function f(a){var b=$(a.target),c=b.findUp(".js-participant-item"),d=b.findUp(".js-participant-chat"),e=b.findUp(".js-project-chat"),f=b.findUp(".js-video-chat"),g=c.attr("data-id");return 0<d.length?OpenUtil.openMessengerByOneUserId(g):0<e.length?OpenUtil.openMessengerByProjectSrno(Detail.getProjectSrno()):0<f.length?VideoConference.sendMessage():0<c.length?Profile.drawProfilePopup(g):void 0}function g(a){var b=$(a.target),c=b.findUp(".js-participant-item");0===c.length||RequestJoin.openRequestJoinPopup()}function h(a){var b=$(a.target),c=b.findUp(".js-project-chat"),d=b.findUp(".js-video-chat");return 0<c.length?OpenUtil.openMessengerByProjectSrno(Detail.getProjectSrno()):0<d.length?VideoConference.isZoomSynchronized(VideoConference.warnAndSendMessage,VideoConference.alertRequiredZoomSync,{type:"projectSrno",val:Detail.getProjectSrno(),isMini:!1}):void 0}var j,k,l,m={PG_NO:1,PG_PER_CNT:20,NEXT_YN:"Y"},n={PG_NO:1,NEXT_YN:"Y"},o={};return{adjustPosition:a,drawJoinParticipantItem:function(a){var b=$("#joinParticipantsUl");ListHelper.initPageData(n),Ajax.executeApi(RestApi.GET.COLABO2_INVT_R003,$.extend({packetOption:Ajax.OPTION.PREVENT_EXECUTE},n,{COLABO_SRNO:a}),function(c){var e=c.JOIN_REC.length;$("#joinParticipantsCount").text(e),$("#joinParticipantsUl").drawListHelper({pageData:n,nextYn:c.NEXT_YN,records:c.JOIN_REC,callback:{item:d,click:g,final:function final(){b.find(".js-participant-chat").remove(),b.find(".js-participant-name").after("<img id=\"new\" src=\"/design3/img_rn/ico/ico_new3.png\" alt=\"\" style=\"margin-bottom: 5px; display: inline;\">")}}});var f=Authority.isAuthorityCheck("ADMIN",a);$("#joinParticipantsArea").css("display",f&&0!==e?"block":"none")})},drawProjectParticipantItems:b,clickParticipantsArea:f}}();
"use strict";var PinPost=function(){function a(a,b){function c(a){return""===Often.null2Void(a)?"d-none":"state "+a}function d(a){var b="";if(0===a.length)return b;var c=a.split("\n");return $.each(c,function(a,c){if(""!==c)return b=c,!1}),b}var e="",f=$("#pinPostItem").html();return $.each(a,function(a,g){var h=Often.null2Void(g.TMPL_TYPE,"1"),i=Often.null2Void(g.TEMP_GB,"1"),j=DetailCode.SCHEDULE===(b?h:i),k=DetailCode.TODO===(b?h:i),l=DetailCode.TASK===(b?h:i);e+=ListHelper.replaceJson(f,b?{title:d(Often.null2Void(g.COMMT_TTL,g.CNTN)),"colabo-srno":g.COLABO_SRNO,"post-srno":g.COLABO_COMMT_SRNO,"post-gb":DetailCode.POST._GB[h],"post-name":i18next.t(DetailCode.POST._TEXT[h]),"status-code":c(k?"request":l?DetailCode.STATUS._GB[g.TASK_STTS]:""),status:i18next.t(k?g.TODO_DONE_PERCENT+"%":l?DetailCode.STATUS._TEXT[g.TASK_STTS]:""),"complete-yn":"completion"===DetailCode.STATUS._GB[g.TASK_STTS]?"complete":"hold"===DetailCode.STATUS._GB[g.TASK_STTS]?"hold":"","schedule-yn":j?"d-block":"d-none","start-date":Tz.momentTimeZone(g.SCHD_STTG_DTTM,"type4"),"start-time":Tz.momentTimeZone(g.SCHD_STTG_DTTM,"type8")}:{title:g.TTL,"colabo-srno":g.COLABO_SRNO,"post-srno":g.COLABO_COMMT_SRNO,"post-gb":DetailCode.POST._GB[i],"post-name":i18next.t(DetailCode.POST._TEXT[i]),"status-code":c(k?"request":l?DetailCode.STATUS._GB[g.STTS]:""),status:i18next.t(k?g.TODO_DONE_PERCENT:l?DetailCode.STATUS._TEXT[g.STTS]:""),"complete-yn":"completion"===DetailCode.STATUS._GB[g.STTS]?"complete":"hold"===DetailCode.STATUS._GB[g.STTS]?"hold":"","schedule-yn":j?"d-block":"d-none","start-date":Tz.momentTimeZone(g.STTG_DTTM,"type4"),"start-time":Tz.momentTimeZone(g.STTG_DTTM,"type8")})}),e}function b(a){var b=$(a.target),c=b.findUp(".js-pin-item");0===c.length||PostPopup.togglePostView(Detail.getProjectSrno(),c.attr("data-post-srno"),"",function(){$("#pinPostUl").find(".highlight").removeClass("highlight"),c.find("a").addClass("highlight")})}function c(){0===$("#pinPostUl li").length&&$("#projectPinArea").css("display","none")}function d(){var a=$("#projectPinArea");a.hasClass("d-none")&&a.css("display","block")}function e(){$("#projectPinCount").text($("#pinPostUl li").length)}return{drawProjectPinPostItems:function(){var c=$("#projectPinArea");c.css("display","none");var d=$("#pinPostUl");Ajax.executeApi(RestApi.GET.COLABO2_PIN_R001,{COLABO_SRNO:Detail.getProjectSrno()},function(e){d.empty();0===e.PIN_REC.length||($("#projectPinCount").text(e.PIN_REC.length),d.append(a(e.PIN_REC)).off("click").on("click",b),c.css("display","block"))})},controlPinElement:function(f,g,h){var i=$("#post-"+h),j=i.attr("pin-yn"),k=$("#post-"+h),l=$("#pin-"+h),m=Often.null2Void(k.find(".js-task-state.state-button-group").attr("data-status"));if("DELETE"===f)return l.remove(),c(),void e();if("EDIT"===f&&j||"PIN"===f){var n=i.find(".post-title-area .post-title").text(),o=[{TTL:""!==n?n:i.find("#summaryPost div:first").text(),COLABO_SRNO:g,COLABO_COMMT_SRNO:h,TEMP_GB:k.attr("data-post-code"),STTS:taskStatusCode[m.toUpperCase()],STTG_DTTM:k.attr("time"),TODO_DONE_PERCENT:k.attr("todo-done-percent")}],p=a(o);"EDIT"===f&&j?l.html($(p).find("a")):"PIN"==f&&($("#pinPostUl").prepend(p).off("click").on("click",b),d()),e()}},unPinElement:function(a,b){var d=$("#pin-"+b);d.remove(),c()},drawProjectPinPostItemsByRecord:function(c){var d=$("#projectPinArea");d.css("display","none");var e=$("#pinPostUl");e.empty();0===c.length||($("#projectPinCount").text(c.length),e.append(a(c,!0)).off("click").on("click",b),d.css("display","block"))},updatePinCount:e}}();
"use strict";var PostPopup=function(){function a(){t=$("#postPopup"),v=t.find(".js-popup-before"),w=t.find(".js-content-area"),u=t.find(".js-upload-area")}function b(a){x=$.extend({},x,a)}function c(){return x}function d(a,b,c){x.PROJECT_SRNO=a,x.POST_CODE=b,x.POST_RECORD="";var d=""===Often.null2Void(a);return d?void n({},c,{mode:DetailCode.WRITE_ANYWHERE.CODE,selectable:!0,maxSelection:1,firstEditor:!0}):void k(a,function(){n({},c)})}function e(a){function b(){n(c,"",{mode:DetailCode.SHARE_POST.CODE,selectable:!0,maxSelection:10,firstEditor:!1})}var c=x.POST_RECORD[0];if(x=$.extend(x,{PROJECT_SRNO:c.COLABO_SRNO,POST_SRNO:c.COLABO_COMMT_SRNO,POST_CODE:PostCondition.getPostCodeByData(c),EDIT_DATA:JsonMaker.getPostJson()}),a){var d=$("#postPopup").is(":visible");return void(d?i(b):b())}i(function(){n(c,"",{})})}function f(a,b){var c=$((a?"#postPopup ":"")+(".js-edit-layer:visible .js-remark-upload-"+b+" li"));return c}function g(a){var b=!1,c="",d=$((a?"#postPopup ":"")+".js-remark-area:visible");return $.each(d,function(a,d){b||""===$.trim($(d).text())||(b=!0,c=$(d))}),c}function h(a){var b=!1,c="",d=$((a?"#postPopup ":"")+".js-subtask-edit-layer:visible");return $.each(d,function(a,d){var e="0"!==$(d).find(".js-subtask-status-button").attr("data_status"),f=0!==$.trim($(d).find(".js-subtask-input").val()).length,g=""!==$(d).find(".js-date-tooltip").attr("data_end_dt"),h=""!==$(d).find(".js-subtask-priority-layer").attr("data_priority"),i=""!==$(d).find(".js-subtask-worker-layer").attr("data_worker_id_list");if(e||f||g||h||i)return b=!0,c=$(d).find(".js-subtask-input"),!1}),c}function i(b,c){function d(a,c){c&&q(),PopupDraw.closePopup(),UploadHandler.stopUploading(),i&&b()}function e(){return JSON.stringify(JsonMaker.getPostJson(t))!==JSON.stringify(PostPopup.getData().EDIT_DATA)}c=c||"ETC";var i="function"==typeof b;a();var j=t.is(":visible"),k=!t.hasClass("flow-all-background-1");if(j&&"SIDE_POP"===c&&!k)return void d(!1);var l=g(j),m=f(j,"file"),n=f(j,"img"),o=h(j),p="VIEW"===t.attr("data-code");if(j&&!p&&e()||UploadHandler.isUploading()||0<l.length||0<m.length||0<n.length||0<o.length)return void PopupDraw.drawConfirm({await:!0,contents:{main:i18next.t("front.alert.leaveWriting")},callback:{submit:function submit(){d(!0,"SIDE_POP"===c)},cancel:function(){return PopupDraw.closePopup(),0<l.length?l.focus():0<o.length?o.focus():void 0}}});var r=t.find(".js-share-project-list"),s=r.is(":visible")&&0<r.find(".on").length,u=t.find(".js-popup-before"),v=u.is(":visible")&&SpaceSelectable.isSharePost(t);if(s||v){var w=s?"\uC120\uD0DD\uB41C \uD504\uB85C\uC81D\uD2B8\uAC00 \uC788\uC2B5\uB2C8\uB2E4.":"\uC791\uC131\uC774 \uC644\uB8CC\uB418\uC9C0 \uC54A\uC558\uC2B5\uB2C8\uB2E4.";return void PopupDraw.drawConfirm({contents:{main:w+"\n\uB2E4\uB978 \uD504\uB85C\uC81D\uD2B8\uC5D0 \uC62C\uB9AC\uAE30\uB97C \uCDE8\uC18C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"},callback:{submit:q}})}d(!1,"SIDE_POP"===c)}function j(b,c,d,e,f){function g(){m(b,c,d,!0,function(g){function h(){var h=Often.isAct("subscreen")?$("body"):$("#mainBodyWrap");if(h.prepend(o(PostComponent.getHtmlByPostRecord([j]),"VIEW")),a(),PostPopupInit.initViewPopup(t,g,Top.isRightWrap()||f,function(){Detail.applySummarySlickImage(),"function"==typeof e&&e()}),t.css("display","none"),0>+Often.null2Void(d,"-1"))return t.css("display","block"),void s();var k=t.find(".js-comment-area");k.find(".remark-item").remove(),ItemRemark.getRemarkDataHtml(k,{MODE:OftenCode.MORE,ORDER_TYPE:OftenCode.NEXT,COLABO_SRNO:b,COLABO_COMMT_SRNO:c,SRCH_COLABO_REMARK_SRNO:0},i)}function i(){$("#prePostPopup").remove(),t.css("display","block");var a=t.find(".post-card-scroll"),b=t.find(".remark-item[remark-srno=\""+d+"\"]");b.addClass("highlight").css("background","#f8f7ff");var c=b.offset()&&b.offset().top,e=t.innerHeight()-a.innerHeight()/2;a.animate({scrollTop:c-e},400),s()}0>+Often.null2Void(d,"-1")?$("#postPopup").is(":visible")&&q():$("#postPopup").attr("id","prePostPopup");var j=$.extend({},g.COMMT_REC[0]);return j.COLABO_REMARK_SRNO=Often.null2Void(d,"-1"),"Y"===j.SUBTASK_YN&&ItemSubtask.setSubtaskRemarkCount(c,j.REMARK_CNT),"Y"===j.READ_YN?h():void(j.READ_USER_CNT=+j.READ_USER_CNT+1,h(),AlarmUpdate.executeReadApi({COLABO_SRNO:b,COLABO_COMMT_SRNO:c,COLABO_REMARK_SRNO:d}))})}d=Often.null2Void(d,"-1"),a();var h=Often.null2Void(t.attr("data-post-srno")),j=Often.null2Void(t.attr("data-code")),l=t.is(":visible")&&c!==h,n=0<t.find("#post-"+c+"[data-remark-srno="+d+"]").length;return"EDIT"===j&&c===h?(q(),void k(b,g)):t.is(":visible")?void i(function(){return n?q():void(DocumentEvent.closeAllPopup(!0,l),k(b,g))}):void k(b,g)}function k(a,b){var c=LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING"),d=c?c.COLABO_SRNO:"";return d===a?void(LocalUtil.setLocalJson("POP_PROJECT_SETTING",c),"function"==typeof b&&b()):Detail.executeProjectSettingInfo(a,b)}function l(){return x&&x.POST_RECORD&&x.POST_RECORD[0]}function m(a,b,c,d,e){var f="list"===LocalUtil.getFeedType()&&!d,g=f?RenewalApi.GET.ACT_POST_LIST:RestApi.GET.COLABO2_R104;Ajax.executeApi(g,{GUBUN:"DETAIL",COLABO_SRNO:a,COLABO_COMMT_SRNO:b,RENEWAL_YN:"Y",PG_NO:1,PG_PER_CNT:1},function(c){x={PROJECT_SRNO:a,PROJECT_NM:"",POST_SRNO:b,POST_CODE:f?c.POST_RECORD[0].TMPL_TYPE:PostCondition.getPostCodeByData(c.COMMT_REC[0]),POST_RECORD:c[f?"POST_RECORD":"COMMT_REC"]},"function"==typeof e&&e(c)})}function n(b,c,d){function e(){function a(a){PostAppend.appendLink(t,a)}PostPopupInit.initEditPopup(t,b,c),i&&SpaceSelectable.addProjectSelectableView(v,d),x.EDIT_DATA=JsonMaker.getPostJson(t),ScrapMetaData.addUrlPreview(t.find(".js-upload-area"),a),Often.showOrHideByFunc("VIDEO_CONFERENCE",t.find("#videoLi")),Detail.togglePostFilter(t.find(".js-post-nav"))}var f=!Often.isFunc(Func.CLOUD.GOOGLEDRIVE_UPLOAD_PREVENT)&&Often.isFunc(Func.CLOUD.GOOGLEDRIVE_UPLOAD),g=!Often.isFunc(Func.CLOUD.DROPBOX_UPLOAD_PREVENT)&&Often.isFunc(Func.CLOUD.DROPBOX_UPLOAD),h=Often.isFunc(Func.CLOUD.IMPORT_FILE_BOX);d=d||{};var i=d.selectable,j=0<Object.keys(b).length,k="Y"===b.SUBTASK_YN,l=i?d.mode:j?"EDIT":"ADD",m=PostCondition.getPostCondition(l,b),n=PostCondition.getFuncCondition(l,b),p="Y"===LocalUtil.getProjectSrchAuthYn(),r=ListHelper.replaceJson($("#postEditWrap").html(),{"title-display":m.isWrite1?"d-none":"","nav-class":DetailCode.POST._GB[m.isWrite1?"0":m.postCode],"post-gb":k?"subtask":"","private-button-display":ListHelper.setDisplay(!k,"inline-block"),"private-class":p?"admin":"full","private-text":p?i18next.t("prefix.only",{val:"$t(front.common.projectManager)"}):i18next.t("front.common.public"),"data-code":l,"button-upload-google":ListHelper.setDisplay(f),"button-upload-dropbox":ListHelper.setDisplay(g),"button-upload-importfile":ListHelper.setDisplay(h),"post-dimd-layer":n.isUpload?$("#postDimdItem").html():""}),s=o(r,l);$("#postPopup").is(":visible")?(q(),s.attr("data-before-view","POP")):s.attr("data-before-view","NO_POP"),s.attr({"data-project-srno":b.COLABO_SRNO,"data-post-srno":b.COLABO_COMMT_SRNO}),$("#mainBodyWrap").prepend(s),a(),e()}function o(a,b){var c=PopupDraw.getPopupWrapObj();return c.find(".contents").html(a),c.attr({id:"postPopup","data-code":b}),c.css("display","block"),c}function p(a,b){var c=a.find("#"+b+"Button"),d=a.find("#"+b+"Span"),e=""===$.trim(d.text());c.css("display",e?"inline-block":"none"),d.css("display",e?"none":"inline-block")}function q(){r(),$("#postPopup").remove(),Caret.initLastFocusNode()}function r(){$("#mainContent").find(".highlight").removeClass("highlight")}function s(){var a=$("#postPopup");$(".post-card-scroll").hasVerticalScrollBar()?a.find(".js-remark-layer").addClass("sticky"):a.find(".js-remark-layer").removeClass("sticky")}var t,u,v,w,x={PROJECT_SRNO:"",POST_SRNO:"",POST_CODE:"",POST_RECORD:"",EDIT_DATA:""};return{setData:b,getData:c,getOnePostData:l,getPostData:m,openRegistrationView:d,openRegistrationViewOnAnywhere:function(a){var b=ViewChanger.getCurrentPageId(),c=b.split("/"),e=1<c.length?c[1]:"";return d(e,a,!1)},openEditView:e,togglePostView:j,initButtonByCode:p,checkWritingAndShowPopup:i,removePopup:q,addScrollSticky:s}}();
"use strict";var ProjectSearch=function(){function a(){p=$("#detailLayer"),r=p.find(".js-post-search-result"),q=p.find("#projectSearchInput"),o=p.find("#projectDetailSearchLayer"),s=r.find(".js-search-post-ul"),r.attr({"data-search-area-code":"IN_PROJECT"})}function b(b){b.preventDefault(),a(),o.is(":visible")?d():(SearchFilter.initFilter(o,searchMode.POST,!0),SearchFilter.addEventOnSearchFilter(o,g,!0),o.prev().addClass("active"),r.is(":visible")?p.find("#detailTimeline").addClass("js-project-search"):p.find("#detailTimeline").removeClass("js-project-search"),o.fadeIn(200))}function c(a){KeyCheck.isKey(a,"ENTER")&&g(),KeyCheck.isKey(a,"ESC")&&f()}function d(b){if(b&&("projectSearchInput"===b.attr("id")||b.hasClass("project-search-input")))return!0;if(p.find("#detailTimeline").removeClass("js-project-search"),!(b&&0<b.parents(".flatpickr-calendar").length)){var c=$(".flatpickr-calendar");return c.is(":visible")?c.remove():void(a(),o.css("display","none"),o.prev().removeClass("active"))}}function f(){a(),q.val(""),r.fadeOut(200)}function g(){var a=SearchFilter.getSearchWord(searchAreaCode.IN_PROJECT);SearchFilter.isUnSearchableAndToast(""!==a)||(m(),SearchFilter.setSearchFilter(o,r,searchMode.POST),ListHelper.initPageData(v,s),n(),SearchFilter.drawSearchCount(r.find(".js-search-post-count"),0),i(),d(),SearchFilter.addEventOnSearchFilter(r,h,!1))}function h(){n(),ListHelper.initPageData(v,s),i()}function i(a){if("N"!==Often.null2Void(v.NEXT_YN,"Y")){var b=SearchFilter.getSearchWord(searchAreaCode.IN_PROJECT);if(!SearchFilter.isUnSearchableAndToast(""!==b)){var c=SearchFilter.getFilterJson(r,o.is(":visible"));console.log("filterJson",c);var d=""!==$.trim(Often.null2Void(c.RGSR_NM))||""!==$.trim(Often.null2Void(c.SEARCH_PROJECT_TITLE))||""!==$.trim(Often.null2Void(c.RCVR_USER_NM));Ajax.executeApi(RenewalApi.GET.ACT_SEARCH_POST_N_REMARK_LIST,$.extend({packetOption:Ajax.OPTION.PREVENT_CALLBACK,COLABO_SRNO:Detail.getProjectSrno(),GUBUN:"DETAIL",COLABO_COMMT_SRNO:Often.null2Void(t),COLABO_REMARK_SRNO:Often.null2Void(u),SEARCH_RECORD:[$.extend({SRCH_WORD:b,ORDER_TYPE:"A"},c)]},v),function(c){var e=1===v.PG_NO;e&&r.find(".js-search-back-button.js-detail-back").css("display","block"),a||SearchFilter.drawSearchCount(r.find(".js-search-post-count"),c.CNT),t=c.COLABO_COMMT_SRNO,u=c.COLABO_REMARK_SRNO,s.drawListHelper({pageData:v,checkDttm:c.CHECK_DTTM,nextYn:c.NEXT_YN,records:c.RESULT_RECORD,noDataHtml:ListHelper.getNoDataHtml("PROJECT_SEARCH"),targetObj:{focus:d?null:q},callback:{click:j,item:function item(a){return k(a,b)},scroll:function scroll(){i(!0)}}})})}}}function j(a){var b=$(a.target),c=b.findUp(".js-all-post-item");if(0!==c.length&&!LimitGuest.isSearchLimitGuest("post",c.attr("rgsn_dttm"))){var d=Often.getAttrs(c)[0];PostPopup.togglePostView(d.COLABO_SRNO,d.COLABO_COMMT_SRNO,"",function(){s.find(".highlight").removeClass("highlight"),c.addClass("highlight")})}}function k(a,b){var c="",d=$("#allPostSearchItem").html();return $.each(a,function(a,e){c+=ListHelper.replaceJson(d,$.extend(e,JsonMaker.getListComponentInfo(e,b)))}),c}function l(){a(),d(),SearchFilter.initFilter(r,searchMode.POST),SearchFilter.initFilter(o,searchMode.POST),q.val(""),r.css("display","none")}function m(){r.css({display:"block",top:"120px"}),q.val(SearchFilter.getSearchWord(searchAreaCode.IN_PROJECT)),q.off("keyup").on("keyup",c),p.find(".js-detail-search-filter-button").off("click").on("click",b)}function n(){t="",u=""}var o,p,q,r,s,t,u,v={CHECK_DTTM:"",PG_PER_CNT:20,NEXT_YN:"Y"};return{clickProjectDetailSearchTopButton:b,keydownProjectSearchInput:c,closeProjectDetailSearchLayer:d,hideSearchProjectList:l}}();
"use strict";var RequestJoin=function(){function a(){f.fadeOut(200)}function b(){f.find("#closeBtn").off("click").on("click",a)}function c(){Ajax.executeApi(RestApi.GET.COLABO2_INVT_R003,$.extend({},h,{COLABO_SRNO:g}),function(a){$("#joinParticipantUl").drawListHelper({pageData:h,nextYn:a.NEXT_YN,records:a.JOIN_REC,noDataHtml:ListHelper.getNoDataHtml(),callback:{item:d,click:e}}),f.fadeIn(200)})}function d(a){var b=$("#joinParticipantItem").html(),c="";return $.each(a,function(a,d){var e=ImageUtil.removeDomain("PROFILE",d.PRFL_PHTG);c+=ListHelper.replaceJson(b,{"profile-image":"style=\"background-image: url("+e+")\"","user-id":d.USER_ID,name:d.USER_NM})}),c}function e(a){function b(a){var b=c.findUp(".js-join-participant-item"),d=b.attr("data-user-id"),e=a?JoinStatus.APPLY_JOIN_2:JoinStatus.REJECT_JOIN_2;JoinProject.updateJoinStatus(g,d,e,function(){b.remove(),Participant.drawProjectParticipantItems(g,!0),Participant.drawJoinParticipantItem(g),0===f.find(".js-join-participant-item").length&&f.find("#joinParticipantUl").append(ListHelper.getNoDataHtml())})}var c=$(a.target),d=c.findUp("#acceptBtn"),e=c.findUp("#rejectBtn"),h=c.findUp(".js-profile-image");if(0<d.length)return void b(!0);if(0<e.length)return void b(!1);if(0<h.length){var i=h.findUp(".js-join-participant-item").attr("data-user-id");return void Profile.drawProfilePopup(i)}}var f,g,h={PG_NO:1,NEXT_YN:"Y"};return{openRequestJoinPopup:function(a){f=$("#requestJoinPopup"),g=a?a:Detail.getProjectSrno(),ListHelper.initPageData(h,$("#joinParticipantUl")),c(),b()},closeRequestJoinPopup:a}}();
"use strict";function _defineProperty(a,b,c){return b in a?Object.defineProperty(a,b,{value:c,enumerable:!0,configurable:!0,writable:!0}):a[b]=c,a}var SpaceSelectable=function(){function a(){return w}function b(a,b){if(b&&b.selectable){var c=Often.null2Void(b.maxSelection,1),f=Often.null2Void(b.mode,""),g=b.firstEditor||!1;w=[],u=c,v=f,r=a,s=$($("#projectSelectableLayer").html()),r.before(s),h(s,g),t=s.find(".js-share-project-list"),ListHelper.initPageData(x,t),e(),d()}}function c(a){d(a)}function d(a){if(a="string"==typeof a?a:"","N"!==x.NEXT_YN){var b=""!==Often.null2Void(a),c=RenewalApi.GET.ACT_PROJECT_LIST,e=$.extend({},x,{COLABO_FLD_KIND:"1",COLABO_FLD_SRNO:"12",MODE:"COPY"},b?{SEARCH_RECORD:[{SRCH_WORD:a,ORDER_TYPE:"A"}]}:{});Ajax.executeApi(c,e,function(a){t.drawListHelper({pageData:x,noDataHtml:ListHelper.getNoDataHtml(""),nextYn:a.NEXT_YN,records:a["PROJECT_RECORD"],targetObj:{focus:s.find(".js-share-project-srch"),scroll:t.parent("div")},callback:{item:o,scroll:d,final:function final(){s.find(".js-share-popup-ttl").text(i18next.t(DetailCode[v].TEXT)),r.find(".js-project-selectable-header").css({display:"inline-block"})}}})})}}function e(){r.find(".btn-back, #selectedProject").off("click").on("click",function(){h(s,!1)}),s.find(".js-share-project-srch").focus().off("keyup").on("keyup",n),s.off("click").on("click",i)}function f(a){return 0===w.length?r.find(".share-contents").addClass("create-post-container").removeClass("share-contents"):void(r.find(".create-post-container").addClass("share-contents").removeClass("create-post-container"),a&&r.find(".manager-btn-group").html("<em>"+i18next.t("front.spaceSelectable.cannotSetManager")+"</em>"))}function g(){var a=r.find(".share-header");if(0===w.length)return r.removeClass("share-wr"),r.find(".create-post-header").css("display","block"),void a.css("display","none");var b=w[0],c=b.TTL+(1<w.length?" \uC678 "+(w.length-1)+"\uAC1C":""),d=b.COLABO_SRNO;PostPopup.setData({PROJECT_SRNO:d}),r.addClass("share-wr"),r.find(".create-post-header").css("display","none"),a.css("display","block"),a.find(".project-ttl").text(c),ListHelper.removeAllColorClass(a.find(".color-code")),a.find(".color-code").addClass("color-code-"+b.BG_COLOR_CD)}function h(a,b){a.css("display",b?"none":"table"),r.css("display",b?"block":"none")}function i(a){function b(){var a=e.findUp(".project-item");return 0!==a.length&&(!!(0<a.find(".edit-check.disabled").length)||(k(a),s.find(".js-project-select").css("display",0<w.length?"block":"none"),s.find(".select-count").text(w.length),!0))}function c(){var a=e.findUp(".btn-submit");if(0===a.length)return!1;var b=v===DetailCode.SHARE_POST.CODE;return 0===w.length&&b?Often.toast("info",i18next.t("front.alert.select",{val:"$t(dictionary.project)"})):(g(),f(b),h(s,!0),!0)}function d(){var a=e.findUp(".btn-cancel");if(0===a.length)return!1;if(v===DetailCode.WRITE_ANYWHERE.CODE)return j(),g(),h(s,!0),!0;if(v===DetailCode.SHARE_POST.CODE){var b=$(".js-share-project-list").is(":visible")&&0<$(".js-share-project-list .on").length;return b?PopupDraw.drawConfirm({contents:{main:"\uC120\uD0DD\uB41C \uD504\uB85C\uC81D\uD2B8\uAC00 \uC788\uC2B5\uB2C8\uB2E4.\n\uB2E4\uB978 \uD504\uB85C\uC81D\uD2B8\uC5D0 \uC62C\uB9AC\uAE30\uB97C \uCDE8\uC18C\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"},callback:{submit:PostPopup.removePopup}}):PostPopup.removePopup(),!0}}var e=$(a.target);b()||c()||d()||function(){var a=e.findUp(".select-clear");return 0!==a.length&&(j(),!0)}()}function j(){w=[],s.find(".select-count").text(0),s.find(".js-project-select").css("display","none"),t.find(".check-menu-item").removeClass("on")}function k(a){a.find(".check-menu-item").hasClass("on")?l(a):m(a)}function l(a){var b=a.attr("colabo-srno");return w.forEach(function(a,c){var d=a.COLABO_SRNO===b;d&&w.splice(c,1)}),a.find(".check-menu-item").removeClass("on"),!0}function m(a){return(1===u&&j(),w.length>=u)?Often.toast("info",i18next.t("front.common.maximum",{count:u,val:"$t(dictionary.project)"})):(w.push({COLABO_SRNO:a.attr("colabo-srno"),TTL:a.find(".share-project-ttl").text(),BG_COLOR_CD:a.find(".color-code").attr("data-color")}),a.find(".check-menu-item").addClass("on"),!0)}function n(a){q&&clearTimeout(q),q=setTimeout(function(){var b=$.trim($(a.target).val());ListHelper.initPageData(x),c(b),$(a.target).focus()},200)}function o(a){var b=$("#selectableProjectItem").html(),c="";return $.each(a,function(a,d){var e;c+=ListHelper.replaceJson(b,(e={TTL:d.TTL,BG_COLOR_CD:d.BG_COLOR_CD,COLABO_SRNO:d.COLABO_SRNO},_defineProperty(e,"BG_COLOR_CD",Often.null2Void(d.BG_COLOR_CD,"0")),_defineProperty(e,"check_yn",p(d.COLABO_SRNO,"Y"===Often.null2Void(d.MNGR_WR_YN,"N"))),e))}),c}function p(a,b){var c="";return w.forEach(function(b){var d=b.COLABO_SRNO===a;d&&(c="on")}),b&&(c="disabled"),c}var q,r,s,t,u,v,w=[],x={PG_NO:1,PG_PER_CNT:100,NEXT_YN:"Y"};return{getSelectedProjectArray:a,addProjectSelectableView:b,isSharePost:function(a){return a.attr("data-code")===DetailCode.SHARE_POST.CODE}}}();
"use strict";var TaskReport=function(){function a(a,b){graph.ready(["chart.builder"],function(c){c("#"+a,{padding:0,width:100,height:100,style:{tooltipBackgroundOpacity:1},axis:{data:[b]},brush:{type:"donut",size:10,colors:["#4aaefb","#50b766","#f17a19","#2e417e","#d2d3d6"]},widget:[{type:"tooltip",orient:"left"}]})})}return{drawTaskReport:function(b){var c=$("#taskReportArea");if((c.empty(),c.find("#TASK_DONUT_CHART").empty(),!!b)&&!(b&&0===b.length)&&!(b&&0===+b[0].TOTAL_CNT)){var d=b[0];d.TOTAL_CNT=Often.numberWithCommas(b[0].TOTAL_CNT);var e={},f={REQ:i18next.t("dictionary.request"),PROG:i18next.t("dictionary.progress"),FEDBK:i18next.t("dictionary.feedback"),COMP:i18next.t("dictionary.complete"),HOLD:i18next.t("dictionary.hold")},g={},h=0;for(var i in f){var j=+d[i];g[i]=Often.numberWithCommas(j),f[i]&&(e[f[i]]=j),g[i+"_NAME"]=f[i],g[i+"_PER"]=d[i+"_PER"],h+=+g[i+"_PER"]}100!==h&&(g.REQ_PER=+g.REQ_PER+(100-h));var k=$("#taskReportItem").html(),l=$(ListHelper.replaceJson(k,$.extend(b[0],g)));c.empty(),c.append(l);var m="Y"===LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","TASK_REPORT_VIEW_YN");c.find("#TASK_DONUT_CHART").empty(),a("TASK_DONUT_CHART",e),m?(c.find(".reports-button").removeClass("off"),c.find(".js-task-report-layer").css("display","block")):(c.find(".reports-button").addClass("off"),c.find(".js-task-report-layer").css("display","none"))}},clickTaskReportLayer:function(a){var b=$(a.target),c=b.parents(".task-chart-info");0===c.length||(LocalUtil.setLocal("TASK_REPORT",c.attr("data-code")),ViewChanger.loadPageJson({code:"task",first:Detail.getProjectSrno()}))}}}();
"use strict";var EmailInvite=function(){function a(){var a=$("#emailList .emailItemInput"),c=Validation.checkInput(a),d=$("#inviteMsg").html().replace(/(<p>)/gi,"").replace(/(<\/p>)/gi,"<br>");if(0<Object.keys(c).length&&"empty"!==c.errorCode)return Often.toast("error",c.errorMessage),void c.errorObj.focus();var e=b(a);return 0===e.length?void Often.toast("info",i18next.t("front.alert.notExist",{val:"$t(dictionary.email)"})):void Ajax.executeApi(RestApi.POST.COLABO2_SENDIENCE_C002,{COLABO_SRNO:Detail.getProjectSrno(),INVT_URL:$("#inviteLink").text(),CNTN:d,EML_REC:e,packetOption:Ajax.OPTION.PREVENT_EXECUTE},function(){Often.toast("success",i18next.t("front.alert.invitationEmailSent")),a.val("")})}function b(a){var b=[];return a.each(function(a,c){var d=$.trim($(c).val());""!==d&&b.push({EML:d})}),b}function c(){var a=$($("#tempEmailItem").html());return $("#emailList").append(a),!0}function d(a){var b=a.parent(".emailItem"),c=$("#emailList .emailItem").length;5<c?b.remove():b.find(".emailItemInput").val("")}return{openSendInviteEmlLayer:function(){InviteProject.closeAllInviteLayer(),$("#emailList").empty();for(var a=0;a<5;a++)c();var b="<p>"+i18next.t("front.inviteProject.inviteMessageBottomText")+"</p>";$("#inviteMsg").html(b),$("#sendInviteEmlLayer").css({display:"block",right:"inherit",left:"50%",top:"50%",transform:"translate(-50%,-50%)"})},isSendInviteEmailAndAction:function(b){var c=b.findUp("#sendInviteEmail");return 0!==c.length&&(a(),!0)},isAddEmailAndAction:function(a){var b=a.findUp("#addEmail");return 0!==b.length&&(c(),!0)},isEmailListAndAction:function(a){var b=a.findUp("#emailList");return 0!==b.length&&(a.hasClass("deleteEmail")&&d(a),!0)},getEmail:b,isCheckWriteEmail:function(){var a=$("#sendInviteEmlLayer"),b=a.find(".emailItemInput"),c=a.find("#inviteMsg").html().replace("<br>","<br/>"),d="<p>"+i18next.t("front.inviteProject.inviteMessageBottomText")+"</p>",e=!1;return $.each(b,function(a,b){if(""!==$(b).val())return void(e=!0)}),e||c===d||(e=!0),e}}}();
"use strict";var TeamInvite=function(){function a(a,d){n=$("#teamInviteSearch"),InviteProject.closeAllInviteLayer(),m=[];var e=a===InviteType.SENDIENCE,f="Y"===LocalUtil.getLocalValue("ONLY_BUY_SETTING","DVSN_TREE_YN"),g=$("#inviteMemberList"),h=$("#inviteOrgChart"),i=$("#teamInviteMenu");if(e||!f?i.css("display","none"):i.css("display","block"),b(a),n.val(""),Member.initPage(),Member.makeMemberList(g,n,c,a,function(){$("#teamInviteLayer").css({display:"flex"})}),$("#memberMenu").find("div").attr("class","team-job-invite-type-2"),$("#orgChartMenu").find("div").attr("class","team-job-invite-type-1"),d){var j=$("#inviteLayer");j.css("display","block"),j.find(".returnMainBtn").css("display","none")}Often.isFunc("INVITATION_POPUP")&&"favorite"!==a?InvitationPopup.openInvitationPopup(!0):$("#teamInviteArea").css("display","block"),h.hasClass("d-none")||(h.addClass("d-none"),g.removeClass("d-none"))}function b(a){$("#teamInviteHeader").text(function(a){return a===InviteType.SENDIENCE?i18next.t("front.common.projectParticipant"):a===InviteType.TEAM?i18next.t("front.InviteProject.inviteCompanyMember"):a===InviteType.NEWCHAT?i18next.t("front.common.newChat"):a===InviteType.INVITECHAT?i18next.t("front.common.inviteToChat"):a===InviteType.FAVORITE?"\uC990\uACA8\uCC3E\uAE30 \uAD6C\uC131\uC6D0 \uCD94\uAC00":""}(a)).attr("invite-type",a),$("#memberMenu").find("div").text(function(a){return a===InviteType.NEWCHAT||a===InviteType.INVITECHAT?i18next.t("dictionary.contact"):i18next.t("dictionary.member")}(a))}function c(a){var b=$(a.target),c=b.findUp(".js-participant-item");if(0!==c.length){var e=b.findUp(".js-profile");if(0!==e.length){var f=e.parents(".js-participant-item").attr("data-id");return void Profile.drawProfilePopup(f)}var g=c.find("#selectMemberBtn").hasClass("my-check-2-1");if(c.find("#selectMemberBtn").attr("class","my-check-2"+(g?"":"-1")),$(".js-participant-item").removeClass("active"),c.addClass("active"),!g){var h,i=$("#selectMemberItem").html();h=ListHelper.replaceJson(i,{name:c.find("#name").text(),"rcvr-cd":c.attr("rcvr_cd"),"rcvr-gb":c.attr("rcvr_gb"),id:c.attr("id"),profile:ListHelper.setProfile(c.attr("profile-image"))}),$("#selectMemberList").append(h),m.push(c.attr("id")),$(".deleteMemberItem").off("click").on("click",d)}else m.splice(m.indexOf(c.attr("id"))),$("#selectMemberList").find("li[id="+c.attr("id")+"]").remove()}}function d(a){a.stopPropagation();var b=$(a.target),c="ED"===b.parents("li").attr("rcvr_gb");if(b.parents("li").remove(),!c){var d=Often.null2Void(b.parents("li").attr("id"));$("#inviteMemberList").find("li[id="+d+"]").find("#selectMemberBtn").attr("class","my-check-2"),$("#inviteEmplArea").find("li[id="+d+"]").find("#selectMemberBtn").attr("class","my-check-2"),m.splice(m.indexOf(d))}else{var e=b.parents("li").attr("rcvr_cd");$("#inviteOrgChart").find("li[dvsn-cd="+e+"]").find(".js-dvsn-select").attr("class","js-dvsn-select coperate-check-type-1"),m.splice(m.indexOf(e))}}function e(a){var b={COLABO_SRNO:Detail.getProjectSrno(),SENDIENCE_REC:a,packetOption:Ajax.OPTION.PREVENT_EXECUTE};Ajax.executeApi(RestApi.POST.COLABO2_SENDIENCE_C001,b,function(){Participant.drawProjectParticipantItems(Detail.getProjectSrno(),!0,function(){UpdateElements.autoUpdateElem({ONLY_POST:!0}),Often.toast("success",i18next.t("front.alert.invitedToProject")),InviteProject.closeInvite()})})}function f(a){var b=0<a.findUp("#memberMenu").length,d=$("#inviteMemberList"),e=$("#inviteOrgChart");$("#teamInviteSearch").val(""),Organization.closeEmplArea(),$("#memberMenu").find("div").attr("class","").attr("class","team-job-invite-type-"+(b?"2":"1")),$("#orgChartMenu").find("div").attr("class","").attr("class","team-job-invite-type-"+(b?"1":"2")),d.attr("class","participants-list invite-member-list "+(b?"":"d-none")),e.attr("class","").attr("class",b?"d-none":"");var f=Often.null2Void($("#teamInviteHeader").attr("invite-type"),"team");b?(Member.initPage(),Member.makeMemberList(d,$("#teamInviteSearch"),c,f,function(){m.forEach(function(a){d.find("li[id=\""+a+"\"] #selectMemberBtn").toggleClass("my-check-2-1")})})):Organization.initPage(e,$("#inviteEmplArea"),!0),$("#teamInviteArea").css("display","block")}function g(a){var b=[],c=[],d=[];return $("#selectMemberList").find("li").each(function(a,d){var e=$(d).attr("rcvr_gb");e===INVITEGB.PERSON?b.push({IN_RCVR_USER_ID:$(d).attr("rcvr_cd")}):e===INVITEGB.DVSN&&c.push({DVSN_CD:$(d).attr("rcvr_cd")})}),0===b.length&&0===c.length?void Often.toast("error","\uCD08\uB300\uB300\uC0C1\uC744 \uC120\uD0DD\uD574\uC8FC\uC138\uC694!"):void("CHAT"===a?OpenUtil.openMessengerByInvite(Often.null2Void(ROOM_SRNO),b,c,d):"FAV"==a&&MiniFavorite.insertFavoriteMember(GROUP_ID,b,c,d))}function h(){var a=[];a.push({RCVR_ID:_USER_ID,RCVR_GB:"U"}),$("#selectMemberList").find("li").each(function(b,c){a.push({RCVR_ID:$(c).attr("rcvr_cd"),RCVR_GB:$(c).attr("rcvr_gb"),RCVR_NM:$(c).find("span").text()})}),e(a)}function i(a){var b=$(a.target),d=b.findUp("#teamInviteSearch"),e=$("#teamInviteHeader").attr("invite-type");return 0!==d.length&&($("#inviteMemberList").is(":visible")?(l&&clearTimeout(l),l=setTimeout(function(){Member.initPage(),Member.makeMemberList($("#inviteMemberList"),$("#teamInviteSearch"),c,e,function(){m.forEach(function(a){$("#inviteMemberList").find("li[id=\""+a+"\"] #selectMemberBtn").toggleClass("my-check-2-1")})})},200)):Organization.searchEmpl(a),!0)}function j(a,b){var c="0"===a.findUp(".department-item").attr("depth");if(b&&c)return!1;var e=a.findUp(".department-item"),f=a.hasClass("coperate-check-type-2"),g="dvsn_ED"+e.attr("dvsn-cd");if(!f){a.removeClass("coperate-check-type-1").addClass("coperate-check-type-2");var h,i=$("#selectDvsnItem").html();h=ListHelper.replaceJson(i,{dvsn_name:e.find(".department-name").text(),"rcvr-cd":e.attr("dvsn-cd"),"rcvr-gb":"ED",id:g}),$("#selectMemberList").append(h),b||m.push(g),$(".deleteMemberItem").off("click").on("click",d)}else a.removeClass("coperate-check-type-2").addClass("coperate-check-type-1"),b||m.splice(m.indexOf(g)),$("#selectMemberList").find("li[id="+g+"]").remove()}function k(){return m}var l,m,n;return{openTeamInviteLayer:a,isTeamInviteMenuAndAction:function(a){var b=a.findUp("#teamInviteMenu");return 0!==b.length&&(f(a),!0)},isSubmitInviteAndAction:function(a){var b=a.findUp("#submitInvite");if(0===b.length)return!1;var c=$("#teamInviteHeader").attr("invite-type");return c===InviteType.NEWCHAT||c===InviteType.INVITECHAT?g("CHAT"):c===InviteType.FAVORITE?g("FAV"):h()},isTeamInviteSearchAndAction:i,clickMemberListUl:c,clickDvsnSelect:j,getSelectedDataArray:k}}();
"use strict";var JsonMaker=function(){function a(a){var b=s(a.CNTN),c=a.ATCH_REC&&a.ATCH_REC.slice(),d=a.IMG_ATCH_REC&&a.IMG_ATCH_REC.slice();return(0<c.length||0<d.length)&&$.each(b,function(a,b){$.each(c,function(a,c){return"FILE"===b.COMP_TYPE&&void(FileUtil.getAtchSrno(c.ATCH_SRNO)===b.COMP_DETAIL.ATCH_SRNO&&$.extend(b.COMP_DETAIL,c))}),$.each(d,function(a,c){return"IMAGE"===b.COMP_TYPE&&void(FileUtil.getAtchSrno(c.ATCH_SRNO)===b.COMP_DETAIL.ATCH_SRNO&&$.extend(b.COMP_DETAIL,c))})}),b}function b(a){var b=[];return $.each(a.ATCH_REC,function(a,c){b.push({COMP_TYPE:"FILE",COMP_DETAIL:c})}),$.each(a.IMG_ATCH_REC,function(a,c){b.push({COMP_TYPE:"IMAGE",COMP_DETAIL:c})}),b}function c(){function a(a,b){var c=[];return $.each($(b[0].childNodes),function(b,d){var e=$(d),f=Often.null2Void(e.attr("data-code"));if(a===f){var g=Often.getAttrs(e)[0];g.ATCH_SRNO=FileUtil.getAtchSrno(g),c.push(g)}}),c}var b=$("#postPopup"),c=b.find(".js-upload-area"),d=b.find("#postAttached");return 0===c.length&&0===d.length?{}:$.extend({CNTN:function(){var a="";return $.each($(c[0].childNodes),function(b,c){Often.isBrowser("ie")&&"P"===c.nodeName&&(c=e(c,b));var d=c.nodeType===Node.TEXT_NODE,f=c.innerHTML&&"<br>"===c.innerHTML,g=$(c);"DIV"===c.nodeName&&""!==a&&(a+="\n");var h=Often.null2Void(g.attr("data-code"));(d||""===h)&&!f&&(a+=TagConvert.html2DbStringByPost(c.outerHTML||c.innerHTML||c.textContent))}),a}(),COMMT_ATCH_REC:a("FILE",d.find(".js-attached-file")),COMMT_EDITOR_REC:a("IMAGE",d.find(".js-attached-image"))},function(a){var b={};return $.each($(a[0].childNodes),function(a,c){var d=$(c),e=Often.null2Void(d.attr("data-code"));"LINK"!==e||(b=Often.getAttrs(d)[0])}),b}(d.find(".js-attached-url")))}function d(){var a=$("#postPopup"),b=a.find(".js-upload-area");if(0===b.length)return"";var c=[],d="";return $.each($(b[0].childNodes),function(a,b){Often.isBrowser("ie")&&"P"===b.nodeName&&(b=e(b,a));var g=b.nodeType===Node.TEXT_NODE,h=b.innerHTML&&"<br>"===b.innerHTML,i=$(b);if(!i.hasClass("js-hidden-component")){"DIV"===b.nodeName&&""!==d&&(d+="\n");var j=Often.null2Void(i.attr("data-code"));g||""===j?!h&&(d+=TagConvert.html2DbStringByPost(b.outerHTML||b.innerHTML||b.textContent)):(d=f(c,d),c.push({COMP_TYPE:j,COMP_DETAIL:Often.getAttrs(i)[0]}))}}),f(c,d),JSON.stringify({COMPS:c})}function e(a,b){var c=document.createElement("div");return c.innerHTML=a.innerHTML,a.parentNode.replaceChild(c,a.parentNode.childNodes[b]),c}function f(a,b){var c=g(b);return c?(a.push(c),""):b}function g(a){return""!==a&&{COMP_TYPE:"TEXT",COMP_DETAIL:{CONTENTS:a,HASHTAGS:TagUtil.extractHashtags(a),MENTIONS:TagUtil.extractMentionedUsers(a)}}}function h(a){var b=$.trim(a.find("#postTitle").val()),c=a.find("#ondDay").prop("checked"),d=Often.null2Void(a.find(".js-start-flatpickr .js-pickr-date").val(),""),e=Often.null2Void(a.find(".js-end-flatpickr .js-pickr-date").val(),""),f=a.find("#alarmButton").val(),g=a.find("#LOCATION").val(),h=a.find("#placeInput").val(),i=TagConvert.html2DbStringByPost(a.find("#memoButton").html()),j=a.find(".js-attendance-input").attr("data-attendance"),k=a.find(".js-attendance-input").attr("data-attendance-insert"),l=a.find(".js-attendance-input").attr("data-attendance-delete"),m=a.find("#videoSpan").attr("data-vc-srno");return[{TTL:b,ALL_DAY_YN:c?"Y":"N",STTG_DTTM:Tz.momentConversion("convertOnly",c?"type17":"type19",d),FNSH_DTTM:Tz.momentConversion("convertOnly",c?"type17":"type19",e),PRE_ALAM:f,VC_SRNO:m,MEMO:i,LOCATION:g,PLACE:h,ATTENDENCE_REC:!SpaceSelectable.isSharePost(a)&&j?t(j):[],INSERT_ATD_REC:!SpaceSelectable.isSharePost(a)&&k?t(k):[],DELETE_ATD_REC:!SpaceSelectable.isSharePost(a)&&l?t(l):[]}]}function i(a,b){var c={};switch(b){case"TITLE":c=a&&a.COMMT_TTL?a.COMMT_TTL:"";break;case"TEXT":case"CONTENTS":c=a&&a.CNTN?a.CNTN:"";break;case"IMAGE":c=a&&a.IMG_ATCH_REC&&0<a.IMG_ATCH_REC.length?a.IMG_ATCH_REC[0]:{};break;case"FILE":c=a&&a.ATCH_REC&&0<a.ATCH_REC.length?a.ATCH_REC[0]:{};break;case"TASK":c=a&&a.TASK_REC&&0<a.TASK_REC.length?a.TASK_REC[0]:{};break;case"TODO":c=a&&a.TODO_REC?a.TODO_REC:{};break;case"SCHEDULE":c=a&&a.SCHD_REC&&0<a.SCHD_REC.length?a.SCHD_REC[0]:{};break;case"LINK":c=a&&""!==Often.null2Void(a.PREVIEW_LINK)?{PREVIEW_TTL:a.PREVIEW_TTL,PREVIEW_IMG:a.PREVIEW_IMG,PREVIEW_LINK:a.PREVIEW_LINK,PREVIEW_CNTN:a.PREVIEW_CNTN,PREVIEW_VIDEO:a.PREVIEW_VIDEO,PREVIEW_TYPE:a.PREVIEW_TYPE}:{};break;default:}return c="TEXT"===b||"TODO"===b||"CONTENTS"===b?{CONTENTS:c}:c,0===Object.keys(c).length?{}:{COMP_TYPE:b,COMP_DETAIL:c}}function j(a){var b=PostCondition.getIamSubtaskByData(a),c=PostCondition.getPostCondition("VIEW",a),d=c.isWrite1?"0":c.postCode,e=LocalUtil.getProjectBgColorCd(),f=a.TASK_REC&&0<a.TASK_REC.length?a.TASK_REC[0]:{},g=$.trim(b||c.isTask?f.TASK_NM:a.COMMT_TTL),h=""===g;return{COLABO_TTL:a.COLABO_TTL,COLABO_SRNO:a.COLABO_SRNO,COLABO_COMMT_SRNO:a.COLABO_COMMT_SRNO,COLABO_REMARK_SRNO:a.COLABO_REMARK_SRNO,CNTN:a.CNTN,READ_YN:Often.null2Void(a.READ_YN,"Y"),"no-title":!c.isSchedule&&h?"no-title":"",COMMT_TTL:c.isSchedule&&h?"COMMT_TTL":g,PIN_YN:a.PIN_YN,PIN_USE_YN:"Y"===a.MNGR_DSNC||"Y"===a.PIN_USE_YN?"js-pin-authority":"",PINNED:"Y"===a.PIN_YN?"on":"","pin-btn-display":ListHelper.setDisplay("N"===a.PIN_YN&&"Y"===a.PIN_USE_YN||"Y"===a.PIN_YN),BG_COLOR_CD:e,"menu-button-display":ListHelper.setDisplay(Authority.isAuthorityCheck("WRITE",a.COLABO_SRNO)||a.RGSR_ID===_USER_ID,"block"),"menu-modify-display":ListHelper.setDisplay(a.RGSR_ID===_USER_ID&&"Y"===a.MODIFY_YN,"block"),"menu-delete-display":ListHelper.setDisplay(a.RGSR_ID===_USER_ID||"Y"===a.DELETE_YN,"block"),"menu-url-display":ListHelper.setDisplay(Often.isFunc(Func.DEVELOP.URL_COPY),"block"),"author-id":a.RGSR_ID,"post-code":d,"post-gb":DetailCode.POST._GB[d],"subtask-gb":b?"subtask":"","post-name":i18next.t(DetailCode.POST._TEXT[d]),"first-contents":r(a),date:Tz.momentTimeZone(a.RGSN_DTTM?a.RGSN_DTTM:a.COMMT_RGSN_DTTM?a.COMMT_RGSN_DTTM:a.RGSR_DTTM,"type1"),"private-display":ListHelper.setDisplay("M"===a.RANGE_TYPE,"inline-block"),"read-count":Often.null2Void(a.READ_USER_CNT,1),"bookmark-display":"Y"===a.BRING_YN?"on":"","post-url":a.CONNECT_URL,"alarm-display":ListHelper.setDisplay("N"===Often.null2Void(a.READ_YN,"Y"),"block"),"security-class":"A"===a.RANGE_TYPE?"icons-person-7":"icons-lock","security-text":"A"===a.RANGE_TYPE?i18next.t("front.common.public"):i18next.t("prefix.only",{val:"$t(front.common.projectManager)"})}}function k(a){var b=Often.null2Void(a.RGSR_CORP_NM,""),c=Often.null2Void(a.RGSR_DVSN_NM,""),d=Often.isFunc("PRFL_DVSN_SHOW");return{RGSR_ID:a.RGSR_ID,name:a.RGSR_NM,team:c,position:Often.null2Void(a.RGSR_JBCL_NM,""),company:b,profile:ListHelper.setProfile(a.PRFL_PHTG),"prfl-dvsn-display":ListHelper.setDisplay(d,"inline"),"personal-yn":d&&!(""===b&&""===c)?"d-block":"d-none"}}function l(a){var b=a.TASK_REC&&0<a.TASK_REC.length||a.TASK_STTS;if(!b)return{"task-yn":"d-none","task-display":ListHelper.setDisplay(!1),"todo-display":ListHelper.setDisplay(!1)};var c=a.TASK_REC&&0<a.TASK_REC.length?a.TASK_REC[0]:a,d=Often.null2Void(c.STTS,a.TASK_STTS),e=c.TASK_NUM,f=c.TASK_SRNO,g="completion"===DetailCode.STATUS._GB[d],h="hold"===DetailCode.STATUS._GB[d];return{"task-display":ListHelper.setDisplay(b,"inline-block"),"task-srno":f,"task-yn":"d-inline-block","task-number":e,"status-code":DetailCode.STATUS._GB[d],status:i18next.t(DetailCode.STATUS._TEXT[d]),"status-raw":d,"complete-yn":g?"complete":h?"hold":"","todo-display":ListHelper.setDisplay(!1)}}function m(a){var b=a.SCHD_REC&&0<a.SCHD_REC.length||a.SCHD_STTG_DTTM;if(!b)return{"schedule-yn":"d-none","start-date":"","start-time":""};var c=a.SCHD_REC&&0<a.SCHD_REC.length?a.SCHD_REC[0]:"",d=Often.null2Void(c.STTG_DTTM,a.SCHD_STTG_DTTM),e=c.FNSH_DTTM,f="Y"===c.ALL_DAY_YN,g=Tz.momentTimeZone(d,"type10"),h=Tz.momentTimeZone(d,"type12"),i=Tz.momentTimeZone(e,"type12"),j=h===i,k=Tz.momentTimeZone(d,"type9");return{COMMT_TTL:c.TTL,"start-date":Tz.momentTimeZone(d,"type4"),"start-time":Tz.momentTimeZone(d,"type8"),"start-date-time":f?Tz.momentTimeZone(d,"type5")+(j?", "+i18next.t("front.common.allDay"):""):Tz.momentTimeZone(d,"type6"),"start-date-time-raw":d,"end-date-time":f?j?"":Tz.momentTimeZone(e,"type5")+", "+i18next.t("front.common.allDay"):Tz.momentTimeZone(e,j?"type20":"type6"),"end-date-display":ListHelper.setDisplay(!(f&&j),"inline-block"),"schedule-display":ListHelper.setDisplay(!0,"block"),"schedule-header":"<div class=\"schedule-date\"><strong class=\"schedule-month\">"+g+"</strong><strong class=\"schedule-day\">"+k+"</strong></div>","schedule-period-display":ListHelper.setDisplay(!0,"block")}}function n(a){var b=a.TODO_REC&&0<a.TODO_REC.length||a.TODO_DONE_PERCENT;if(!b)return{};var c=!1,d=Often.null2Void(a.TODO_DONE_PERCENT,ItemTodo.getTodoPercentJson(a.TODO_REC).PERCENT+"");return(a.TODO_REC&&0<a.TODO_REC.length||"2"===a.TMPL_TYPE)&&(c=!0),{"todo-display":ListHelper.setDisplay(c,"inline-block"),TODO_DONE_PERCENT:"0"===d?"0%":Often.null2Void(d+"%"),"todo-srno":Often.null2Void(a.TODO_REC&&0<a.TODO_REC.length&&a.TODO_REC[0].COLABO_TODO_SRNO,""),"mngr-wryn":Often.null2Void(a.MNGR_WR_YN,""),"mngr-dsnc":Often.null2Void(a.MNGR_DSNC,"")}}function o(a){var b=a.UP_LINK_TASK_REC&&0<a.UP_LINK_TASK_REC.length;if(!b)return{};var c=a.UP_LINK_TASK_REC[0];return{UP_TASK_TTL:c.UP_LINK_TASK_NM,"data-up-task-project-srno":c.COLABO_SRNO,"data-up-task-post-srno":c.COLABO_COMMT_SRNO,"data-up-task-srno":c.UP_LINK_TASK_SRNO,"up-task-display":ListHelper.setDisplay(!0,"inline-block")}}function p(a){var b=a.REMARK_REC&&0<a.REMARK_REC.length||0<a.REMARK_CNT,c=Authority.isAuthorityCheck("REMARK",a.COLABO_SRNO);return $.extend({"remark-count":b?a.REMARK_CNT:"0","remark-display":ListHelper.setDisplay(b,"inline-block"),"remark-over-yn":2<+a.REMARK_CNT?"on":"","remark-area":b?ItemRemark.getRemarkItemHtml(a.REMARK_REC):"","self-profile-url":ListHelper.setProfile(_PRFL_PHTG),"admin-write-yn":c?"":"admin"},ItemRemark.getRemarkWriteConditionJson(c))}function q(a){var b,c,d,e,f=a.EMT_CDS,g=a.EMT_VIEW1,h=a.EMT_VIEW2,i=i18next.t(DetailCode.EMOJI._TEXT[0]);if(!f)return{"reaction-text":i};var j="";return f.split(", ").forEach(function(a){b||(b=a),j+="<li><i class=\"icon-emoji "+DetailCode.EMOJI._GB[a-1]+"\"><span class=\"blind\">"+i18next.t(DetailCode.EMOJI._TEXT[a-1])+"</span></i></li>"}),d=""!=j,c=d&&""!==g?"on":"",e=c?i18next.t(DetailCode.EMOJI._TEXT[b-1]):i,{"emoji-display":ListHelper.setDisplay(d,"block"),"reaction-display":c,"emoji-icons":j,"emoji-text":g+" "+h,"my-reaction":b,"reaction-text":e}}function r(a,b,c){var d=""!==Often.null2Void(b),e=Often.null2Void(TagConvert.db2OneString(a.CNTN,d),a.CNTN_FIRST_LINE);return c||(e=Often.null2Void(TagConvert.db2OneString(a.COMMT_TTL),e)),d?TagUtil.text2highlight("SEARCH",e,b):e}function s(a){var b;try{b=JSON.parse(a)}catch(a){}return b&&b.COMPS?b.COMPS:[]}function t(a){var b=a.replace(/\'/,"\"");try{return JSON.parse(b)}catch(a){return[]}}return{convertJsonString:function(c){var d=PostCondition.getPostCodeByData(c),e=PostCondition.isNewStyleByCntn(c),f=[];e?f=a(c):f.push(i(c,"TEXT"));var g=[],h=i(c,"TASK"),j=i(c,"TODO"),k=i(c,"SCHEDULE");return e||f.push(i(c,"LINK")),e||$.extend(g,b(c)),d===DetailCode.TASK?(g=f.concat(g),g=[h].concat(g),!ItemSubtask.isSubtask(c)&&g.push({COMP_TYPE:"SUBTASK",COMP_DETAIL:c.SUBTASK_REC})):d===DetailCode.SCHEDULE?(g=f.concat(g),g=[k].concat(g)):d===DetailCode.TODO?g.push(j):g=f.concat(g),JSON.stringify({COMPS:g})},getPostJson:function(){function a(a){return a=a||{},$.extend({},a,g.isTask?{TASK_REC:ItemTask.makeTaskJson(b),SUBTASK_REC:ItemSubtask.makeSubtaskRecord(b)}:g.isSchedule?{SCHD_REC:h(b)}:g.isTodo?{TODO_TTL:e,TODO_REC:ItemTodo.makeTodoJson(b),CNTN:"",TODO_YN:"Y"}:{})}var b=$("#postPopup"),e=$.trim(b.find("#postTitle").val()),f=b.find(".private-button").hasClass("admin"),g=PostCondition.getPostConditionByData(PostCondition.getPopupMode(b),PostPopup.getData().POST_CODE,PostCondition.isNewStyleByPopup(b)),i={COLABO_SRNO:PostPopup.getData().PROJECT_SRNO,COLABO_COMMT_SRNO:PostPopup.getData().POST_SRNO,RANGE_TYPE:f?"M":"A",SCRN_NO:g.isWrite2?"1":"0"};return g.isWrite2||g.isTask2||g.isSchedule2?a($.extend({},i,{COMMT_TTL:e,CNTN:d()})):g.isWrite1||g.isTask1?a($.extend({},i,c())):a(i)},getSettingAttrs:function(a,b){return"MAP"===a?$.extend({},{PLACE_TITLE:b.TITLE,LOCATION:b.LOCATION,PLACE:b.PLACE,URL:b.URL}):b},getPostContentsInfo:function(a){var b=k(a),c=j(a),d=l(a),e=m(a),f=o(a),g=p(a),h=q(a),i=n(a);return $.extend({},b,c,d,e,f,g,h,i)},getEmojiInfo:q,getListComponentInfo:function(a,b){var c=Often.null2Void(a.TMPL_TYPE,"1"),d="-1"===c,e=0<+a.REMARK_CNT,f=Often.null2Void(a.TASK_STTS),g=Often.null2Void(a.SCHD_STTG_DTTM),h=Often.null2Void(a.TODO_DONE_PERCENT+"%");return{COLABO_TTL:Often.null2Void(a.COLABO_TTL,a.TTL),"post-gb":d?"comment2 comment":DetailCode.POST._GB[c],"post-name":d?i18next.t("dictionary.comment"):i18next.t(DetailCode.POST._TEXT[c]),"first-contents":r(a,b,d),"remark-display":ListHelper.setDisplay(!d&&e,"inline-block"),name:a.RGSR_NM,date:Tz.momentTimeZone(a.RGSN_DTTM,"type1"),"status-display":ListHelper.setDisplay("4"===c,"inline-block"),"status-code":Often.null2Void(DetailCode.STATUS._GB[f]),status:i18next.t(DetailCode.STATUS._TEXT[f]),"schedule-display":ListHelper.setDisplay(!1,"inline-block"),"start-date":Tz.momentTimeZone(g,"type4"),"start-time":Tz.momentTimeZone(g,"type8"),"todo-display":ListHelper.setDisplay("2"===c,"inline-block"),TODO_DONE_PERCENT:h}},str2json:s,changeDivNode:e}}();
"use strict";var Mention=function(){function a(){return q}function b(a){if(a.stopPropagation(),r)return void(r=!1);var b=$(a.target);j=b.findUp("#postPopup"),k=b.findUp(".detail-item");var c=0<j.length;if((i=c?j:k,l=i.find("#innerCommonPopup"),229===a.keyCode&&(Often.getClientOSInfo().isMac||Often.isBrowser("ie"))&&(r=!0),!l.isArrowSelect(a))&&KeyCheck.isKey(a,"ENTER")){var d=l.find(".js-mention-item.select");if(0===d.length)return;a.preventDefault(),h(d,!0)}}function c(a){function b(){if(q){var a=l.find(".mention-ul");Caret.captureIndex("@"),ListHelper.initPageData(p,a),g(),Caret.saveCaret()}}var c=$(a.target).hasClass("js-remark-area"),e=PostCondition.getFuncCondition().isMentionTag;if(e||c){if(HashTag.getStatus())return void(q=!1);var h=$(a.target);j=h.findUp("#postPopup"),k=h.findUp(".detail-item");var r=0<j.length,s=k.hasClass("back-area");if(!r&&!s)return void(q=!1);if(i=r?j:k,l=i.find("#innerCommonPopup"),0===l.length){var t=$($("#mentionLayer").html()).attr({id:"innerCommonPopup","data-code":"mention"});r?i.find(".js-popup-before").before(t):k.prepend(t),l=i.find("#innerCommonPopup")}else;var u=Often.null2Void(k.attr("data-project-srno"),LocalUtil.getLocalValue("CURRENT_PROJECT_SETTING","COLABO_SRNO"));return i=r?j:h.findUp(".js-popup-before"),p.COLABO_SRNO=u,(KeyCheck.isKey(a,"BACK")||KeyCheck.isKey(a,"ESC")||KeyCheck.isKey(a,"SPACE_BAR"))&&q&&d(),f(a)?(q=!0,o=Caret.getPosition(),n&&clearTimeout(n),void(n=setTimeout(b,300))):void(m&&clearTimeout(m),m=setTimeout(function(){Caret.isTextInput(a)&&b()},300))}}function d(){q=!1;l&&(l.find(".select").removeClass("select"),l.css({display:"none"}))}function f(a){var b=Caret.getInput(),c=0===b.trim().indexOf("@"),d="@"===b.trim(),e=a.shiftKey&&50===a.keyCode&&c,f="@"===a.key&&c,g=a.shiftKey&&"@"===a.key&&d,h="2"===a.key&&d,i=KeyCheck.isKey(a,"BACK")&&c&&b.trim().length===b.length;return e||f||g||h||i}function g(){function a(){"N"===p.NEXT_YN||Ajax.executeApi(RestApi.GET.COLABO2_SENDIENCE_R101,$.extend({packetOption:Ajax.OPTION.PREVENT_CALLBACK},p,{SRCH_WORD:k,SORT_DESC:"N"}),function(f){var g=1===p.PG_NO,h=d(k);""!==h&&f.SENDIENCE_REC.unshift(h),l.find(".mention-ul").drawListHelper({pageData:p,nextYn:f.NEXT_YN,records:f.SENDIENCE_REC,callback:{click:b,item:function item(a){return e(a)},scroll:a,final:function final(a){c(f.SENDIENCE_REC),g&&(l.attr("data-code","mention"),l.find(".mention-ul").scrollTop(0),ListHelper.selectFirstItemByArrow(a))}}})})}function b(a){var b=$(a.target),c=b.findUp(".js-mention-item");0===c.length||h(c)}function c(a){var b,c=i.find(".edit-item"),d=0<c.length,e=0<i.findUp("#postPopup").length;if(0===a.length||!1===q)b={display:"none"};else{var f=d?c.offset().top:e?i.find(".detail-item").offset().top:i.offset().top,g=d?0:e?i.find(".detail-item").offset().left:i.offset().left,h=o.y-f+20,j=o.x-g,k=l.outerHeight()+o.y>window.innerHeight-100;k&&(h-=l.outerHeight()+20),b={transform:"translate("+j+"px, "+h+"px)",display:"block"}}l.css(b)}function d(a){var b={RCVR_USER_ID:"ALL",RCVR_USER_NM:"ALL",DVSN_NM:i18next.t("front.common.projectAllParticipant")};return-1<"all".indexOf(a.toLowerCase())?b:""}function e(a){var b="",c=$("#mentionItem").html();return $.each(a,function(a,d){var e=Often.null2Void(d.RCVR_CORP_NM,""),f=Often.null2Void(d.RCVR_DVSN_NM,"");b+=ListHelper.replaceJson(c,{id:d.RCVR_USER_ID,name:d.RCVR_USER_NM,team:f,position:Often.null2Void(d.JBCL_NM,""),company:e,profile:ListHelper.setProfile(d.PRFL_PHTG),"personal-yn":""===e&&""===f?"d-none":"d-block"})}),b}var f=Often.null2Void(Caret.getInput().trim()),g=f.match(/@/gi);if(g){var j=1===g.length,k=f.replace(j?"@":/^@.*@/gi,"");l.css("display","none"),a()}}function h(a,b){var c=a.find(".author").text(),e=a.attr("data-user-id"),f=$("<span class=\"tag mention-span\" contenteditable=\"false\"></span>");f.attr("user-id",e).text(c),d(),b?setTimeout(function(){Caret.changeAndFocusNode(f)},0):Caret.changeAndFocusNode(f)}var i,j,k,l,m,n,o,p={PG_NO:1,PG_PER_CNT:30,NEXT_YN:"Y",COLABO_SRNO:""},q=!1,r=!1;return{getStatus:a,keyDownArrow:b,keyUpCheckMention:c,openProfile:function(a){var b=$(a.target),c=b.findUp(".mention-span"),d=c.attr("user-id");return Profile.drawProfilePopup(d),!0},clearMention:d}}();
"use strict";var PostAppend=function(){function a(a,c,d){var e=PostCondition.getPostConditionByData();if(!e.isSchedule1){var f=a.is("#postPopup")?a.find(".edit-item"):a.findUp(".edit-item"),g=f.find(".js-upload-area.js-paste-layer:first"),h=e.isNewStyle?g:f.find("#postAttached");b(h,d(c))}}function b(a,b){function c(b,c){function d(a){return a.hasClass("js-post-file")||a.hasClass("js-post-img")||a.hasClass("js-map-item")||a.hasClass("url-link")}b.hasClass("js-upload-area")?a.append(c):b.after(c),d(c.prev())&&c.before("<div class=\"js-hidden-component hidden-component\" contenteditable=\"false\">&nbsp;</div>"),d(c.next())&&c.after("<div class=\"js-hidden-component hidden-component\" contenteditable=\"false\">&nbsp;</div>"),setTimeout(function(){0===c.prev().length&&c.before("<div class=\"js-hidden-component hidden-component\" contenteditable=\"false\">&nbsp;</div>"),0===c.next().length&&c.after("<div><br></div>")},0)}function d(a){return!a.hasClass("js-hidden-component")&&!!a.parent().hasClass("js-upload-area")&&(c(a,h),e(),!0)}function e(){var a=$("#newComponent");Caret.focusNextCaret(a.next()[0],0),a.attr("id","")}var f=""===$.trim(a.text());(function(){var b=a[0].childNodes;if(0<b.length){var c=[];$.each($(b),function(a,b){if(Often.isBrowser("ie")){if("#text"===b.nodeName&&""===Often.null2Void(b.innerText))return;"P"===b.nodeName&&(b=JsonMaker.changeDivNode(b,a))}b&&"DIV"!==b.nodeName&&c.push(b)}),0<c.length&&$(c).wrapAll("<div></div>")}})();var g=a.is("#postAttached"),h=b.attr("id","newComponent");if(function(a){function b(a){var b,c=a.hasClass("ui-sortable");c||a.sortable({cursorAt:{top:5,left:5},scroll:!1,tolerance:"pointer",placeholder:"document-item-highlight",start:function start(){a.sortable("refreshPositions")},helper:function helper(a,c){var d=c.clone();$(d).css("opacity","0.3"),b=d.insertAfter(c);var e=$(c);return e.hasClass("file-item")||e.css("transform","scale(0.5) translate(-50%, -50%)"),e.css("display","table"),e.find(".move-button").css("display","none"),c.clone()},stop:function stop(a,c){var d=$(c.item);d.hasClass("file-item")||d.css("transform","scale(1)"),d.css("display","block"),d.find(".move-button").css("display",""),0<b.prev(".js-hidden-component").length&&b.prev().remove(),0<b.next(".js-hidden-component").length&&b.next().remove(),b&&b.remove(),d.prev().hasClass("create-box")&&d.before("<div class='js-hidden-component hidden-component' contenteditable='false'><br></div>"),d.next().hasClass("create-box")&&d.after("<div class='js-hidden-component hidden-component' contenteditable='false'><br></div>"),0===d.prev().length&&d.before("<div><br></div>"),0===d.next().length&&d.after("<div><br></div>")}})}function c(a){if(0!==a.length)for(var b=0;b++;a[0].childNodes.length){var c=a[0].childNodes[b],d=c.nodeType===Node.TEXT_NODE,e=$(c).text(),f=""!==$.trim(e);d&&(f&&$(c).after("<div>"+e+"</div>"),$(c).remove())}}return a.attr("contentEditable","false").addClass("create-box").css("cursor","pointer"),a.find(".js-down-btn").css("display","none"),a.on("mouseenter",function(a){var d=$(a.currentTarget),e=d.parents(".js-upload-area");c(e),b(e)}).on("mouseleave",function(a){var b=$(a.currentTarget),c=b.parents(".js-upload-area"),d=0<c.find(".document-item-highlight").length;d||c.sortable("destroy")}),a}(b),g)return b.hasClass("image-item")&&a.find(".js-attached-image").append(b),b.hasClass("file-item")&&a.find(".js-attached-file").append(b),b.hasClass("url-link")&&a.find(".js-attached-url").append(b),void e();if(!f){var i=Caret.getLastFocusNode();if(d($(i)))return;if(d($(i).parent()))return}c(a,h),e()}return{appendFileOrImg:function(b,c){a(b,c,PostComponent.getFileAndImgObj)},appendLink:function(b,c){a(b,c,PostComponent.getLinkObj)},appendMap:function(a,c){if(PostCondition.getFuncCondition().isGooglePlace){var d=a.is("#postPopup")?a.find(".edit-item"):a.findUp(".edit-item"),e=d.find(".js-upload-area.js-paste-layer:first");b(e,PostComponent.getMapObj(c))}},appendMadeObj:b}}();
"use strict";var PostComponent=function(){function a(a){var h="",i="",j="",k="",l="",m="",n="",o="",p="",q="",r=$("#postWrap").html(),s=$("#foldWrap").html(),t=$("#imageComponent").html(),u=$("#fileComponent").html(),v=$("#mapComponent").html(),w=$("#bigMapComponent").html(),x=$("#linkComponent").html(),y=0,z=0,A=0,B=PostCondition.getPostCondition("VIEW",a),C=B.isWrite1||B.isTask1||B.isSchedule1,D=JsonMaker.str2json(JsonMaker.convertJsonString(a));D.forEach(function(a){switch(a.COMP_TYPE){case"TEXT":var b=c(a.COMP_DETAIL);k+=b,h+=B.isTask1?"":b;break;case"IMAGE":var i=e(t,a.COMP_DETAIL);l+=i,h+=C?"":i,y++;break;case"FILE":var j=d(u,a.COMP_DETAIL);m+="<li>"+j+"</li>",h+=C?"":j,A++;break;case"MAP":n+=f(v,a.COMP_DETAIL),h+=C?"":f(w,a.COMP_DETAIL),z++;break;case"LINK":o+=g(x,a.COMP_DETAIL);var r=ScrapMetaData.isOverWidthMetaImageByDbData(a.COMP_DETAIL),s=$(r?"#overBigLinkComponent":"#bigLinkComponent").html();h+=C?"":g(s,a.COMP_DETAIL),z++;break;case"TASK":var D=B.isTask?ItemTask.getLookHtml(a.COMP_DETAIL):"";h+=B.isTask1?"":D,p+=D;break;case"TODO":h+=B.isTodo?ItemTodo.getLookHtml(a.COMP_DETAIL):"";break;case"SCHEDULE":h+=B.isSchedule?ItemSchedule.getLookHtml(a.COMP_DETAIL):"";break;case"SUBTASK":h+=B.isTask1?"":ItemSubtask.getLookHtml(a.COMP_DETAIL),q+=ItemSubtask.getLookHtml(a.COMP_DETAIL);break;default:}});var E=b($.trim(k),612,"line-height:25px;"),F=(B.isWrite2||B.isTask2||B.isSchedule2)&&(248<E||1<y||0<y&&0<z||0<y&&0<A||0<z&&0<A),G=C||F,H=B.isSchedule1||B.isTodo;return(h=ListHelper.replaceJson(r,{id:"originalPost",contents:$.trim(h),display:ListHelper.setDisplay(!G||H)}),H)?h:(i+=ListHelper.replaceJson(r,{id:"summaryPost",contents:p+$.trim(k),"add-class":C?"":"hidden",display:ListHelper.setDisplay(G)}),""!==l&&(j+="<div class=\"js-post-img post-upload-img\">"+l+"</div>"),""!==n&&(j+=n),""!==o&&(j+=o),""!=m&&(j+="<ul class=\"upload-document-group\">"+m+"</ul>"),""!==q&&(j+=q),i+=ListHelper.replaceJson(s,{"more-btn-display":ListHelper.setDisplay(F),"fold-area":j,"fold-area-display":ListHelper.setDisplay(G)}),h+i)}function b(a,b,c){var d=$("<div id='textPhantom' style='width:"+b+"px;position:absolute;display: none;"+c+"'></div>"),e=$("body");d.html(a),e.append(d);var f=e.find("#textPhantom").height();return e.find("#textPhantom").remove(),f}function c(a){return a&&a.CONTENTS?TagConvert.db2HtmlStringByPost(a.CONTENTS,postMode.VIEW):""}function d(a,b){if(!b)return"";var c=FileUtil.getFileName(b),d=FileUtil.getFileNameAndExtension(c),e=FileUtil.getRandKey(b),f="GOOGLEDRIVE"===e||"DROPBOX"===e;return ListHelper.replaceJson(a,{ATCH_SRNO:FileUtil.getAtchSrno(b.ATCH_SRNO),RAND_KEY:e,USE_INTT_ID:Often.null2Void(b.ATCH_USE_INTT_ID,b.USE_INTT_ID),WIDTH:b.WIDTH,HEIGHT:b.HEIGHT,FILE_NM:c,RGSR_NM:Often.null2Void(b.RGSR_NM,_USER_NM),FILE_SIZE:b.FILE_SIZE,RGSN_DTTM:b.RGSN_DTTM,FILE_DOWN_URL:b.FILE_DOWN_URL,ATCH_URL:f?Often.null2Void(b.ATCH_URL,b.FILE_DOWN_URL):"",name:c,"ext-class":FileUtil.checkAndConvertDriveExtClass(e,FileUtil.getStandardExtension(d.EXT)),"lock-icon-display":ListHelper.setDisplay("Y"===Often.null2Void(b.DRM_YN,"N")||Often.isFunc(Func.CLOUD.DOWNLOAD_PREVENT)),size:FileUtil.convertDriveSize(e,FileUtil.getFileSize(b.FILE_SIZE)),"download-button-display":ListHelper.setDisplay(!f,"block")})}function e(a,b){if(!b)return"";var c="https://platform.bizplay.co.kr/wecloud/20161227_a7e3f5c1-d9f4-4638-b23c-b6ed797cd026.png"===b.THUM_IMG_PATH;return c&&(b.THUM_IMG_PATH="/flow-renewal/assets/images/file_limit.png"),ListHelper.replaceJson(a,{ATCH_SRNO:FileUtil.getAtchSrno(b.ATCH_SRNO),RAND_KEY:FileUtil.getRandKey(b),WIDTH:b.WIDTH,HEIGHT:b.HEIGHT,ATCH_URL:Often.null2Void(b.ATCH_URL,b.IMG_PATH),FILE_DOWN_URL:Often.null2Void(b.FILE_DOWN_URL),IMG_PATH:Often.null2Void(b.IMG_PATH,b.ATCH_URL),THUM_IMG_PATH:b.THUM_IMG_PATH,FILE_NM:FileUtil.getFileName(b),RGSR_NM:b.RGSR_NM,FILE_SIZE:b.FILE_SIZE,RGSN_DTTM:b.RGSN_DTTM,image_style:ListHelper.setImage(b.THUM_IMG_PATH),image_src:ListHelper.setImageSrc("POST",b.THUM_IMG_PATH),image_class:c?"image-limit":""})}function f(a,b){return b?ListHelper.replaceJson(a,{src:ListHelper.setImageSrc("POST",GoogleMap.convertGoogleMapImage(b.LOCATION)),title:Often.null2Void(b.PLACE_TITLE,b.TITLE),place:b.PLACE,URL:b.URL}):""}function g(a,b){if(!b)return"";var c,d=""!==Often.null2Void(b.PREVIEW_IMG),e=""!==Often.null2Void(b.PREVIEW_VIDEO);return d?!e&&(c=ListHelper.setImage(b.PREVIEW_IMG)):c="",ListHelper.replaceJson(a,{title:TagUtil.escapeHtml(b.PREVIEW_TTL),url:b.PREVIEW_LINK,image:c,contents:TagUtil.escapeHtml(b.PREVIEW_CNTN),"link-gb":e?"video":"file","src-video-url":"","src-image-url":ListHelper.setSrc(b.PREVIEW_IMG),"link-image-display":ListHelper.setDisplay(!e,"block"),"link-video-display":ListHelper.setDisplay(e,"block")})}return{getHtmlByPostRecord:function(b,c){var d="",e=$("#postItem").html(),f=$("#inviteItem").html();return $.each(b,function(b,g){var h="A"===g.COMMT_GB||"A"===g.TMPL_TYPE;if(!(h&&"list"===LocalUtil.getFeedType())){var i=h?f:e,j=a(g),k=ListHelper.replaceJson(i,$.extend({contents:j,"data-code":"VIEW"},JsonMaker.getPostContentsInfo(g)));d=c?k+d:d+k}}),d},getFileHtml:d,getImgHtml:e,getFileAndImgObj:function(a,b){a.FILE_NAME=FileUtil.getFileName(a);var c=ImageUtil.isImageType(a)&&!b,f=c?e($("#imageComponent").html(),a):d($("#fileComponent").html(),a);return $(f)},getLinkObj:function(a){var b=""!==a.PREVIEW_IMG&&"size1"===a.PREVIEW_GB,c=$(b?"#overBigLinkComponent":"#bigLinkComponent").html(),d=g(c,a),e=$(d);return e.attr(JsonMaker.getSettingAttrs("LINK",a)),e},getMapObj:function(a){var b=f($("#bigMapComponent").html(),a),c=$(b);return c.attr(JsonMaker.getSettingAttrs("MAP",a)),c}}}();
"use strict";var PostCondition=function(){function a(a){var b=Often.null2Void(a.CNTN_JSON_YN,"N");return!("Y"!==b)||""!==Often.null2Void(a.CNTN)&&-1<a.CNTN.indexOf("{\"COMPS\":")}function b(a){return a.attr("data-code")}function c(a){if(a&&0<Object.keys(a).length){var b=a.SCHD_REC&&0<a.SCHD_REC.length?DetailCode.SCHEDULE:a.TODO_REC&&0<a.TODO_REC.length?DetailCode.TODO:a.TASK_REC&&0<a.TASK_REC.length?DetailCode.TASK:DetailCode.WRITE,c=a.TMPL_TYPE?a.TMPL_TYPE:b;return Often.null2Void(c,DetailCode.WRITE)}return PostPopup.getData().POST_CODE}function d(d,f){d=d||b($("#postPopup")),f=f||PostPopup.getOnePostData();var g=c(f),h=a(f);return e(d,g,h)}function e(c,d,e){c=Often.null2Void(c||b($("#postPopup")),"VIEW"),d=d||PostPopup.getData().POST_CODE,e=e||a(PostPopup.getOnePostData());var f="ADD"===c,g="EDIT"===c,h="VIEW"===c,i=c===DetailCode.SHARE_POST.CODE,j=d===DetailCode.WRITE,k=d===DetailCode.TODO,l=d===DetailCode.SCHEDULE,m=d===DetailCode.TASK,n=Often.isFunc(Func.CLOUD.TASK_UPGRADE),o=Often.isFunc(Func.CLOUD.SCHEDULE_UPGRADE),p={postCode:d,isAdd:f,isEdit:g,isView:h,isSharePost:i,isWrite:j,isTodo:k,isSchedule:l,isTask:m};return f?($.extend(p,{isWrite1:j&&!1,isWrite2:j&&!0,isTask1:m&&!n,isTask2:m&&n,isSchedule1:l&&!o,isSchedule2:l&&o}),$.extend(p,{isNewStyle:j||p.isTask2||p.isSchedule2}),p):{postCode:d,isAdd:f,isEdit:g,isView:h,isSharePost:i,isWrite:j,isTodo:k,isSchedule:l,isTask:m,isWrite1:j&&!e&&(g||h||i),isWrite2:j&&e&&(g||h||i),isTask1:m&&!e&&(g||h||i),isTask2:m&&e&&(g||h||i),isSchedule1:l&&!e&&(g||h||i),isSchedule2:l&&e&&(g||h||i),isNewStyle:e}}return{isNewStyleByCntn:a,isNewStyleByPopup:function(a){return a.find(".js-bottom-item.hashtag-item").is(":visible")},getPopupMode:b,getIamSubtaskByData:function(a){return a.UP_LINK_TASK_REC&&0<a.UP_LINK_TASK_REC.length},getPostCodeByData:c,getFuncCondition:function(a,c){a=a||b($("#postPopup")),c=c||PostPopup.getOnePostData();var e=d(a,c);return{isUpload:e.isWrite||e.isTask||e.isSchedule2,isGooglePlace:Often.isFunc(Func.ENTER.GOOGLE_MAP)&&(e.isWrite2||e.isTask2),isHashTag:!e.isSharePost&&(e.isWrite2||e.isTask2||e.isSchedule2),isMentionTag:!e.isSharePost&&(e.isWrite||e.isTask||e.isSchedule2),isStyleTag:e.isWrite2||e.isTask2||e.isSchedule2}},getPostCondition:d,getPostConditionByData:e}}();
"use strict";var PostReadCheck=function(){function a(a,c,d){j=PopupDraw.getPopupWrapObj().attr("id","readCheckPopup"),j.find(".contents").html($("#readCheckPopup").html()),k=d.find(".confirmation-number"),ListHelper.initPageData(m,j.find(".participants-list")),m.COLABO_SRNO=a,m.COLABO_COMMT_SRNO=c,m.SRCH_WORD="",b("READ"),g()}function b(a){"N"===m.NEXT_YN||(m.MODE=a,Ajax.executeApi(RestApi.GET.COLABO2_SENDIENCE_R101,$.extend({CUR_DTTM:a},m),function(f){j.find(".participants-list").drawListHelper({pageData:m,nextYn:f.NEXT_YN,records:f.SENDIENCE_REC,noDataHtml:ListHelper.getNoDataHtml("READ-CHECKER"),callback:{click:d,item:c,scroll:function scroll(){b(a)},final:function final(){e(f)}}})}))}function c(a){var b="READ"===m.MODE,c="",d=$("#readCheckItem").html();return $.each(a,function(a,e){var f={};f["profile-url"]=ListHelper.setProfile(e.PRFL_PHTG),b&&(f["read-text"]=i18next.t("dictionary.read")),b&&(f["read-time"]=Tz.momentTimeZone(e.READ_DTTM,"type1")),c+=ListHelper.replaceJson(d,$.extend(f,e))}),c}function d(a){var b=$(a.target),c=b.findUp(".reader-item");if(0<c.length)return void Profile.drawProfilePopup(c.attr("data-user-id"))}function e(a){function b(){var b=j.find(".js-read-tab-item[data-code=READ]"),c=j.find(".js-read-tab-item[data-code=UNREAD]");b.text(b.text()+" ("+a.READ_CNT+")"),k.text(a.READ_CNT),c.text(c.text()+" ("+(+a.SENDIENCE_CNT-+a.READ_CNT)+")")}j.is(":visible")||(b(),$("body").append(j),j.fadeIn(200))}function f(){j.fadeOut(200,function(){j.remove()})}function g(){j.off("click").on("click",h).off("keyup").on("keyup",i)}function h(a){function c(a,c){var d=a.findUp(".js-read-tab-item");return 0!==d.length&&(!!d.hasClass("team-job-invite-type-2")||(c.find(".js-read-tab-item").toggleClass("team-job-invite-type-1").toggleClass("team-job-invite-type-2"),l&&clearTimeout(l),l=setTimeout(function(){ListHelper.initPageData(m,j.find(".participants-list")),b(d.attr("data-code"))},200),!0))}function d(a){var b=a.findUp(".js-read-check-layer");return!(0!==b.length)&&(f(),!0)}a.stopPropagation();var e=$(a.target),g=$(a.currentTarget);c(e,g)||function(a){var b=a.findUp(".js-close-event");return 0!==b.length&&(f(),!0)}(e)||d(e)}function i(a){function c(a){var c=$(a.target),d=c.findUp(".project-search-input"),e=$.trim(d.val());return 0!==d.length&&!KeyCheck.isKey(a,"ESC")&&(m.SRCH_WORD=e,l&&clearTimeout(l),l=setTimeout(function(){ListHelper.initPageData(m,j.find(".participants-list")),b(j.find(".team-job-invite-type-2").attr("data-code"))},200),!0)}a.stopPropagation();c(a)}var j,k,l,m={PG_NO:1,PG_PER_CNT:30,NEXT_YN:"Y",COLABO_SRNO:0,COLABO_COMMT_SRNO:0,SRCH_WORD:"",MODE:"READ"};return{showReadCheckPopUp:a,closePopup:f}}();
"use strict";var ReactionCheck=function(){function a(a,c,d){if(g=PopupDraw.getPopupWrapObj().attr("id","reactionCheckPopup"),g.find(".contents").html($("#reactionCheckPopup").html()),!g.is(":visible")){$("body").append(g),g.fadeIn(200);var f={COLABO_SRNO:c,COLABO_COMMT_SRNO:d},h=0<a.findUp(".js-remark-like").length;if(h){var i=a.findUp(".remark-item").attr("remark-srno");f.COLABO_REMARK_SRNO=i}Ajax.executeApi(RestApi.GET.COLABO2_EMT_R001,f,function(a){b(g,a),e()})}}function b(a,b){var d=DetailCode.EMOJI._GB,e=a.find(".js-reaction-check-layer"),f=e.find(".js-total-reaction");$.each(d,function(a,c){var d="0"===b["EMT_CD_"+(a+1)];d||(f.find(".icon-emoji."+c).findUp(".reaction-emoji-item").addClass("on"),f.find(".icon-emoji."+c).next(".js-emoji-count").text(b["EMT_CD_"+(a+1)]))}),e.find(".js-total-emoji-count").text(b.EMT_CNT),c(e,b.EMT_REC)}function c(a,b){if(b===void 0)return"";var c="",d=$("#reactionCheckItem").html();$.each(b,function(a,b){c+=ListHelper.replaceJson(d,{RCVR_USER_ID:b.RCVR_USER_ID,EMT_CD:DetailCode.EMOJI._GB[b.EMT_CD-1]+" on",EMOJI_TEXT:i18next.t(DetailCode.EMOJI._TEXT[b.EMT_CD-1]),profile_url:ListHelper.setProfile(b.PRFL_PHTG),RCVR_USER_NM:b.RCVR_USER_NM,JBCL_NM:b.JBCL_NM,RCVR_CORP_NM:b.RCVR_CORP_NM,RCVR_DVSN_NM:b.RCVR_DVSN_NM})}),a.find(".js-reaction-participants").append(c)}function d(){return $(".js-profile-popup").is(":visible")?PopupDraw.closePopup():void g.fadeOut(200,function(){g.remove()})}function e(){g.off("click").on("click",f).off("keydown").on("keydown",function(a){KeyCheck.isKey(a,"BACK")&&d()})}function f(a){a.stopPropagation();var b=$(a.target);(function(a){var b=a.findUp(".js-reaction-check-item");0===b.length||Profile.drawProfilePopup(b.attr("data-user-id"))})(b)||function(a){var b=a.findUp(".js-close-event");return 0!==b.length&&(d(),!0)}(b)||function(a){var b=a.findUp(".js-reaction-check-layer");return!(0!==b.length)&&(d(),!0)}(b)}var g;return{showReactionCheckPopup:a,closePopup:d}}();
"use strict";function _toConsumableArray(a){return _arrayWithoutHoles(a)||_iterableToArray(a)||_unsupportedIterableToArray(a)||_nonIterableSpread()}function _nonIterableSpread(){throw new TypeError("Invalid attempt to spread non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}function _unsupportedIterableToArray(a,b){if(a){if("string"==typeof a)return _arrayLikeToArray(a,b);var c=Object.prototype.toString.call(a).slice(8,-1);return"Object"===c&&a.constructor&&(c=a.constructor.name),"Map"===c||"Set"===c?Array.from(a):"Arguments"===c||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(c)?_arrayLikeToArray(a,b):void 0}}function _iterableToArray(a){if("undefined"!=typeof Symbol&&null!=a[Symbol.iterator]||null!=a["@@iterator"])return Array.from(a)}function _arrayWithoutHoles(a){if(Array.isArray(a))return _arrayLikeToArray(a)}function _arrayLikeToArray(a,b){(null==b||b>a.length)&&(b=a.length);for(var c=0,d=Array(b);c<b;c++)d[c]=a[c];return d}var StyleTag=function(){function a(){if(PostCondition.getFuncCondition().isStyleTag){var a=h(),b=a.getRangeAt(0),g=a&&{isInUpload:0<$(a.focusNode).parents(".js-upload-area").length,rangeCount:a.rangeCount,isAvailable:c(a),nodeType:a.anchorNode.nodeType}||{};return g.isInUpload?g.nodeType===Node.TEXT_NODE&&1===g.rangeCount&&g.isAvailable?void(d(),e(b)):f():void 0}}function b(){p=$("#postPopup"),r=p.find("#styleTagItem"),q=p.find("#postCntn")}function c(a){b();var c,d,e,f=a.rangeCount;if(!a)return!1;if(a.isCollapsed)return!1;try{for(var g=0;g<f;g++){var h=a.getRangeAt(g),j=h.startContainer,k=h.endContainer;if(c=$(j),d=$(k),c[0]&&d[0])if(c[0]===d[0])for(e=c.parent();e[0];){if(e[0]===q[0])return!0;e=e.parent()}else{var l=!1;for(e=c.parent();e[0];)if(e[0]===q[0]){l=!0;break}else e=e.parent();if(l)for(e=d.parent();e[0];){if(e[0]===q[0])return!0;e=e.parent()}}return!1}}catch(a){return!1}}function d(){b(),r.find("#styleTagBold").off("mousedown").on("mousedown",j),r.find("#styleTagItalic").off("mousedown").on("mousedown",j),r.find("#styleTagUnderLine").off("mousedown").on("mousedown",j),r.find("#styleTagLineThrough").off("mousedown").on("mousedown",j),r.find("#styleTagBold").off("mouseup").on("mouseup",k),r.find("#styleTagItalic").off("mouseup").on("mouseup",l),r.find("#styleTagUnderLine").off("mouseup").on("mouseup",m),r.find("#styleTagLineThrough").off("mouseup").on("mouseup",n)}function e(a){b();var c=g(a);r.css({top:c.y+15+"px",left:c.x+"px"}),i(),r.fadeIn(200)}function f(){b(),r.fadeOut(200)}function g(a){b();var c=q.width(),d=q.offset(),e=r.height(),f=r.outerWidth(),g={x:0,y:0};if(a){var h=a.getClientRects();h.length?(g.x=h[0].left-d.left+h[0].width/2,g.y=h[0].top-d.top):a.startContainer.getBoundingClientRect===void 0?(g.x=a.getBoundingClientRect().left-d.left+a.getBoundingClientRect().width/2,g.y=a.getBoundingClientRect().top-d.top):(g.x=a.startContainer.getBoundingClientRect().left-d.left+a.startContainer.getBoundingClientRect().width/2,g.y=a.startContainer.getBoundingClientRect().top-d.top),g.x-=f/2,g.y-=e+20,0>g.x&&(g.x=0),g.x>c-f&&(g.x=c-f)}return g}function h(){return(b(),!!q.is(":visible"))&&(document.getSelection?document.getSelection():!!window.getSelection&&window.getSelection())}function i(){b();var a,c,d,e,f=window.getSelection().rangeCount,g=[],h=Often.isBrowser("ie")?["STRONG","EM","U","STRIKE"]:["B","I","U","STRIKE"],k=[];try{for(var l=0;l<f;l++){var m=window.getSelection().getRangeAt(l).startContainer,n=window.getSelection().getRangeAt(l).endContainer;if(c=$(m),d=$(n),a=[],c[0]&&d[0]){if(q[0]&&q[0]===d[0]){g.push([]);continue}for(e=c.parent();e[0]&&q[0]!==e[0];){var o=Often.null2Void(e.attr("style"));o&&(-1<o.indexOf("line-through")&&a.push("STRIKE"),-1<o.indexOf("underline ")&&a.push("U"),-1<o.indexOf("italic")&&a.push("I")),a.push(e.prop("tagName")),e=e.parent()}}var p=new Set(a);a=_toConsumableArray(p),g.push(a)}for(l=0;l<h.length;l++){for(var s=!0,t=0;t<g.length;t++)if(-1===g[t].indexOf(h[l])){s=!1;break}s&&k.push(h[l])}-1<k.indexOf("B")||-1<k.indexOf("STRONG")?r.find(".icons-font-style.bold").addClass("active"):r.find(".icons-font-style.bold").removeClass("active"),-1<k.indexOf("I")||-1<k.indexOf("EM")?r.find(".icons-font-style.italic").addClass("active"):r.find(".icons-font-style.italic").removeClass("active"),-1<k.indexOf("U")?r.find(".icons-font-style.underline").addClass("active"):r.find(".icons-font-style.underline").removeClass("active"),-1<k.indexOf("STRIKE")?r.find(".icons-font-style.line-through").addClass("active"):r.find(".icons-font-style.line-through").removeClass("active"),Often.isBrowser("ie")&&$("#styleTagItem").find(":focus").blur()}catch(a){}}function j(a){a.stopPropagation()}function k(a){o(a,"bold")}function l(a){o(a,"italic")}function m(a){o(a,"underline")}function n(a){o(a,"strikeThrough")}function o(a,b){j(a),document.execCommand(b),i()}var p,q,r;return{mouseUpCheck:function(b){setTimeout(function(){a(b)})},mouseDownCheck:function(){},keyUpCheck:function(b){return KeyCheck.isKey(b,"SHIFT")?void 0:b.shiftKey&&KeyCheck.isKey(b,"ARROW")?KeyCheck.isKey(b,"BACK")||KeyCheck.isKey(b,"DELETE")?f():void a(b):f()},keyDownCheck:function(a){var b=0<$(a.target).findUp("[contenteditable=true]").length,c=KeyCheck.isStyleCommand(a);if(c&&(b&&a.preventDefault(),!!PostCondition.getFuncCondition().isStyleTag)){var d=a.key.toUpperCase();return"S"===d?n(a):"B"===d?k(a):"I"===d?l(a):"U"===d?m(a):void 0}},hasStyleParents:function(a){var b=!1,c=$(a).parents(),d=["B","U","I","STRIKE","EM"];return $.each(c,function(a,c){var e=Often.null2Void(c.nodeName).toUpperCase();if(-1<d.indexOf(e))return b=!0,!1}),b}}}();
"use strict";var WorkerPopup=function(){function a(){A=$("#workerPopup"),D=A.find("#workerInput"),B=A.find("ul")}function b(b,d,f,g){a(),C=f,0<A.length?c():e(b,d,g)}function c(){a(),A.remove()}function d(a){t=a}function e(b,c,e){function g(){return d([]),"ADD"===Detail.getPostStatus()||"EDIT"===Detail.getPostStatus()||"SHARE_POST"===Detail.getPostStatus()?j():y&&0<C.parents(".js-subtask-edit-layer").length?j():void h({COLABO_SRNO:v,COLABO_COMMT_SRNO:k(),TMPL_TYPE:w},j)}function j(a){n();var b=0<Often.null2Void(a).length;if(b){var g=ParticipantCode._ID[w-2],h=ParticipantCode._NAME[w-2],j=[];$.each(a,function(a,b){var c={};c[g]=b.USER_ID,c[h]=b.USER_NM,c.USE_INTT_ID=b.USE_INTT_ID,c.PRFL_PHTG=b.PRFL_PHTG,j.push(c)}),d(j)}else"function"==typeof e&&d(e());s=$.extend([],t),p(),D.focus(),f(A,c)}function k(){var a="EDIT"===Detail.getPostStatus();return a?PostPopup.getData().POST_SRNO:y?C.parents(".js-subtask-li").attr("data-post-srno"):b.attr("data-post-srno")}var l=0<C.findUp("#postPopup").length;if(v=l?PostPopup.getData().PROJECT_SRNO:Detail.getProjectSrno(),w=Often.null2Void(b.attr("data-post-code"),PostPopup.getData().POST_CODE),!v||0===v.length)return Often.toast("error",i18next.t("front.alert.select",{val:"$t(dictionary.project)"}));i(),o(b),a(),g(),x&&(u=C.attr("data-worker-id"));var m=w===DetailCode.SCHEDULE;A.find("#workerInput").attr("placeholder",i18next.t("front.alert.enterWord",{val:m?"$t(back.LangConvert.participant)":"$t(dictionary.manager)"}))}function f(a,b){function c(a){KeyCheck.isKey(a,"ENTER")||KeyCheck.isAvailable(a)||(E&&clearTimeout(E),E=setTimeout(function(){ListHelper.initPageData(G,B),p()},500))}function d(c){var d=$(c.target),e=d.findUp(".js-select-cancel"),f=d.findUp(".js-select-worker");return 0<e.length?(m(),j(),void a.find(".js-registration").removeClass("active")):void(0<f.length&&(t=s,"function"==typeof b&&b(t),a.remove()))}a.off("click").on("click",d),a.off("keydown").on("keydown",g),a.find("#workerInput").off("keyup").on("keyup",c)}function g(a){var b=A.find(".js-worker-list").find(".select");return KeyCheck.isKey(a,"ENTER")&&0<b.length?(b.find(".js-registration").trigger("click",[!0]),void A.find(".js-select-worker:visible").trigger("click")):KeyCheck.isKey(a,"ESC")?(a.stopPropagation(),a.preventDefault(),void c()):void(A&&A.isArrowSelect(a))}function h(a,b){Ajax.executeApi(RenewalApi.GET.ACT_POST_WORKER_LIST,a,function(a){b(Often.null2Void(a.WORKER_RECORD,[]))})}function i(){z=!1,x=w===DetailCode.TODO,y=0<C.findUp(".js-subtask-area").length}function j(){function a(a){$.each(b,function(b,d){var e=$(d).attr("data-worker-id")===a;return x?void(e&&$(d).addClass("active")):!(s.length<=c)&&void(e&&($(d).addClass("active"),c++))})}var b=A.find(".js-registration"),c=0,d=ParticipantCode._ID[w-2];return l(A,k(b)),x?void(""===u?b.removeClass("active"):a(u)):void(0===s.length?b.removeClass("active"):s.forEach(function(b){a(Often.null2Void(b[d],b.USER_ID))}))}function k(){return x?u?1:0:s.length}function l(a,b){var c=a.find(".js-select-alert");return 0<c.length?(c.css("display",0===b?"none":"block"),void a.find(".js-select-count").text(i18next.t("front.common.selectCountMembers",{count:b}))):void(c=$($("#workerSelectCount").html()),c.find(".js-select-count").text(i18next.t("front.common.selectCountMembers",{count:b})),c.find(".js-select-cancel").text(i18next.t("dictionary.cancel")),c.css("display",0===b?"none":"block"),a.append(c))}function m(){t=[],s=[],u=""}function n(){m(),ListHelper.initPageData(G)}function o(a){var b=0<a.findUp("#projectFeedArea").length||"VIEW"===a.findUp("#postPopup").attr("data-code"),c=290,d=250,e=C.offset(),f=a.offset(),g=a.position(),h=g.top+(e.top-f.top),i=g.left+(e.left-f.left),j=b?h:e.top-f.top,k=window.innerHeight<e.top+c,l=window.innerWidth<e.left+d,m=k?-c:40,n=l?-d:0,o=$($("#workersPopup").html());if(o.attr({id:"workerPopup","data-code":"worker","data-subtask-yn":y?"Y":"N"}).css({top:j+m,left:i+n,transform:"none"}),Often.isFunc(Func.CLOUD.INVITATION_POPUP)){var p=a.find(".js-post-nav:visible").hasClass("task"),q=a.find(".js-post-nav:visible").hasClass("schedule"),r=p&&!y||q;r&&(o.addClass("input-popup"),o.css("display","none"))}return a.append(o),a.find("#workerPopup")}function p(){function a(){A.css("display","block")}function b(a,b){var d=$(a.target),e=d.parents(".js-popup-before"),f=d.findUp(".js-registration");if(0!==f.length){var g=[];g.push(q(f)),D.val(""),D.focus(),"function"==typeof F&&F(g),c(),C=e.find(".js-worker-input:visible"),b&&(ListHelper.initPageData(G),A=o(e),B=A.find("ul"),p())}}function d(a){function b(a){function b(){s=[],u=d,A.find(".js-registration").removeClass("active")}function c(a,b){return x?(u="",void A.find(".js-select-alert").css("display","none")):void a.forEach(function(c,d){var e=c[ParticipantCode._ID[w-2]]===b;e&&a.splice(d,1)})}var d=a.attr("data-worker-id");return a.toggleClass("active"),a.hasClass("active")?void(x&&(b(),j()),s.push(q(a))):c(s,d)}var c=$(a.target),d=c.findUp(".js-registration");0<d.length&&(b(d),l(A,k(x)))}Ajax.executeApi(RestApi.GET.COLABO2_SENDIENCE_R101,$.extend({packetOption:Ajax.OPTION.PREVENT_CALLBACK},G,{COLABO_SRNO:v,SRCH_WORD:$.trim(D.val()),SORT_DESC:"N"}),function(c){1===G.PG_NO&&setTimeout(function(){ListHelper.selectFirstItemByArrow(B)},0),B.drawListHelper({pageData:G,nextYn:c.NEXT_YN,records:c.SENDIENCE_REC,noDataHtml:ListHelper.getNoDataHtml("SEARCH"),targetObj:{scroll:B.parents(".js-worker-list"),focus:D},callback:{item:r,click:z?b:d,scroll:p,final:z?a:j}})})}function q(a){var b={},c=ParticipantCode._ID[w-2],d=ParticipantCode._NAME[w-2];return b[c]=a.attr("data-worker-id"),b[d]=a.find(".js-registration-name").text(),b.PRFL_PHTG=a.attr("profile-data"),b.RQST_USE_INTT_ID=a.attr("data-use-intt-id"),DetailCode.SCHEDULE===w&&(b.RCVR_CORP_NM=a.find(".js-registration-company").text(),b.RCVR_DVSN_NM=a.find(".js-registration-team").text(),b.JBCL_NM=a.find(".js-registration-position").text()),b}function r(a){var b=$("#workerListItem").html(),c=Often.isFunc(Func.CLOUD.INVITATION_POPUP),d="";return $.each(a,function(a,c){var e=Often.null2Void(c.CORP_NM,""),f=Often.null2Void(c.CORP_NM,""),g=ListHelper.replaceJson(b,{name:c.RCVR_USER_NM,team:Often.null2Void(c.RCVR_DVSN_NM,""),position:Often.null2Void(c.JBCL_NM,""),company:Often.null2Void(c.RCVR_CORP_NM,""),profile:ListHelper.setProfile(c.PRFL_PHTG),"profile-data":c.PRFL_PHTG,"personal-yn":""===e&&""===f?"d-none":"d-block","worker-id":Often.null2Void(c.RCVR_USER_ID,""),"use-intt-id":Often.null2Void(c.RCVR_USE_INTT_ID,"")});d+=g}),d}var s,t,u,v,w,x,y,z,A,B,C,D,E,F,G={PG_NO:1,PG_PER_CNT:20,NEXT_YN:"Y"};return{toggleWorkerPopup:b,addInputWorkerEvent:function(a,b){function d(a){C=$(a.target);var b=C.findUp(".js-popup-before");A=o(b),B=A.find("ul")}function f(){z=!0,y=!1,x=!1}var h=a.find(".js-worker-input");v=PostPopup.getData().PROJECT_SRNO,w=Often.null2Void(a.attr("data-post-code"),PostPopup.getData().POST_CODE),F=b,h.off("click").on("click",function(a){a.stopPropagation(),f(),D=$(a.target),d(a),ListHelper.initPageData(G,A.find(".js-worker-list>ul")),p()}),h.off("keyup").on("keyup",function(a){a.stopPropagation();var b=!Often.isBrowser("ie")&&!a.originalEvent.isComposing;KeyCheck.isKey(a,"ENTER")||KeyCheck.isAvailable(a)||b||(c(),f(),E&&clearTimeout(E),E=setTimeout(function(){D=$(a.target),d(a),ListHelper.initPageData(G,A.find(".js-worker-list>ul")),p()},500))}),h.off("keydown").on("keydown",function(a){a.stopPropagation(),f(),D=$(a.target),A.is(":visible")&&g(a)})},setSubmitRecord:d,getPostWorkerRecord:h,closeWorkerPopup:c}}();
"use strict";var PostPopupClickEvent=function(){function a(){return q}function b(a){return $(a.target).hasClass("back-area")&&q.hasClass("back-area")?c():$.isTarget(a,[".btn-close",".cancel-button"])?c():$.isTarget(a,"#movePost")?m(a):$.isTarget(a,".js-todo-remove-btn")?ItemTodo.removeOneTodo(a):$.isTarget(a,".js-del-btn")?d(a):$.isTarget(a,".js-file-button")?i(a):$.isTarget(a,".js-file-option")?j(a):$.isTarget(a,".js-map-button")?h(a):$.isTarget(a,".private-button")?k(a):$.isTarget(a,".js-private-option")?l(a):$.isTarget(a,".js-complete-btn")?f(a):$.isTarget(a,".js-remark-area")?ItemRemark.moveToRemarkBottom(a):void 0}function c(){return Often.isAct("subscreen")&&Electron.isElectronApp()?self.close():void PostPopup.checkWritingAndShowPopup(PostPopup.removePopup)}function d(a){var b=$(a.target),c=b.closest(".js-del-btn"),d=c.parents(".js-upload-area"),e=c.parents(".create-box"),f=0<d.find(".document-item-highlight").length;f||d.sortable("destroy");var g=e.prev(".js-hidden-component"),h=g.prev(".create-box"),i=e.next(".js-hidden-component"),j=i.next(".create-box");0<g.length&&0===h.length&&g.remove(),0<i.length&&0===j.length&&i.remove(),c.parents(".create-box").remove()}function f(a){var b=$(a.target),c=b.closest(".js-complete-btn");g()||UploadHandler.isUploadingAndCallback(function(){var a=$("#postPopup");a.find(".js-complete-btn").text(i18next.t("front.common.saving")).attr("data-wait-yn","Y"),c.hasClass("create-button")?o():p()})}function g(){var a,b=$("#postPopup"),c=b.find(".js-post-nav").hasClass("write"),d=b.find(".js-post-nav").hasClass("write2"),e=b.find(".js-post-nav").hasClass("todo");if(c||d)a=Validation.checkEditable(b.find(".js-upload-area"),!0);else if(a=Validation.checkInput(b.find("#postTitle"),!0),e&&ItemTodo.checkTodoValue(b.find(".js-content-area")))return!0;return 0<Object.keys(Often.null2Void(a)).length}function h(a){var b=$(a.target),c=b.closest(".js-map-button");c.toggleClass("active");var d=c.next().is(":visible");if(d)return void c.next().fadeOut(200);c.next().fadeIn(200);var e=c.next().find("input");e.val("").focus()}function i(a){var b=$(a.target),c=b.closest(".js-file-button");c.toggleClass("active");var d=c.next().is(":visible");d?c.next().fadeOut(200):c.next().fadeIn(200)}function j(a){function b(a){PostAppend.appendFileOrImg(d,a)}function c(a){a.forEach(b)}var d=$(a.target);Caret.captureIndex();var e=d.closest(".js-file-option");if(Often.isFunc(Func.CLOUD.UPLOAD_PREVENT))return void Often.toast("info",i18next.t("front.alert.adminRestriction"));e.parent().fadeOut(200),e.parent().prev().removeClass("active");var f=Often.null2Void(e.attr("data-upload"));return"pc"===f?Upload.uploadFile("any",b):"gdrive"===f?GoogleDrive.openGoogleDrive("",c):"dropbox"===f?DropboxDrive.openDropboxDrive(c):LimitGuest.isLimitGuest("flowdrive",!1)?void 0:"flowdrive"===f?FileUtil.openFlowDrive("POST"):void 0}function k(a){var b=$(a.target),c=b.closest(".private-button"),d="Y"===LocalUtil.getProjectSrchAuthYn(),e="Y"===LocalUtil.getProjectManagerYn();return d&&!e?void Often.toast("error","\uAD00\uB9AC\uC790 + \uAE00 \uC791\uC131 \uBCF8\uC778\uB9CC \uC870\uD68C \uAC00\uB2A5\uD55C \uD504\uB85C\uC81D\uD2B8\uC785\uB2C8\uB2E4. (\uBB38\uAD6C\uBCC0\uACBD \uC608\uC815)"):void c.next().fadeIn(200)}function l(a){var b=$(a.target),c=b.closest(".js-private-option");if(0!==c.length){var d=c.parents("ul"),e=d.prev(),f=c.attr("data-private"),g=c.text();e.removeClass("full").removeClass("admin").addClass(f).text(g),d.fadeOut(200)}}function m(a){var b=$(a.target),c=b.closest("#movePost"),d=c.parents(".js-popup-before"),e=d.attr("data-project-srno"),f=d.attr("data-post-srno");$("#alarmLayer").css("display","none"),ViewChanger.loadPageJson({code:"detail",first:e,second:f})}function n(){$("#postPopup").find(".js-complete-btn").text(i18next.t("dictionary.upload")).attr("data-wait-yn","N")}function o(){function a(){return!b(i)||c(i)?(Often.toast("error",b(i)?i18next.t("front.alert.inputLimit",{length:1e4,subject:"$t(dictionary.context)"}):i18next.t("front.alert.enterWord",{val:"$t(dictionary.context)"})),void n()):void(f&&(i.COLABO_SRNO=h[0].COLABO_SRNO),0<+Often.null2Void(LocalUtil.getLocal("VC_SRNO"),"0")&&i.SCHD_REC&&(i.SCHD_REC[0].VC_SRNO=LocalUtil.getLocal("VC_SRNO")),i.packetOption=Ajax.OPTION.PREVENT_EXECUTE,Ajax.executeApi(RestApi.POST.COLABO2_COMMT_C101,i,function(a){Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.register)"})),UpdateElements.autoUpdateElem({POST_MODE:"POST",PROJECT_SRNO:a.COLABO_SRNO,POST_SRNO:a.COLABO_COMMT_SRNO})},n))}function b(a){var b=d.find(".js-post-nav").hasClass("write2");if(!b||a.COMMT_TTL)return!0;var c=JSON.parse(a.CNTN).COMPS,e=!1;return c.forEach(function(a){var b=a.COMP_DETAIL;"TEXT"===a.COMP_TYPE&&(""!==b.CONTENTS.trim()||0!==b.HASHTAGS.length||0!==b.MENTIONS.length)&&(e=!0)}),e}function c(){var a=d.find(".js-post-nav").hasClass("write2");if(!a)return!1;var b=0,c=JSON.parse(i.CNTN).COMPS;return c.forEach(function(a){var c=a.COMP_DETAIL;return"TEXT"!==a.COMP_TYPE||""===c.CONTENTS.trim()||void(b+=c.CONTENTS.length)}),1e4<b}var d=$("#postPopup"),e=d.attr("data-code"),f=e===DetailCode.WRITE_ANYWHERE.CODE,g=$(".flow-project-make-1").find("#videoLi"),h=SpaceSelectable.getSelectedProjectArray(),i=JsonMaker.getPostJson(),j=i.SCHD_REC&&g.find("#videoButton").hasClass("d-none")&&!g.find("#videoSpan").hasClass("d-none");return f&&0===h.length?(n(),Often.toast("info",i18next.t("front.alert.select",{val:"$t(dictionary.project)"}))):void(LocalUtil.removeLocal("VC_SRNO"),j?function(){VideoConference.getZoomToken({TYPE:"SCHEDULE",VC_TTL:i.SCHD_REC[0].TTL},function(b){var c=Often.null2Void(b.VC_SRNO,"0");LocalUtil.setLocal("VC_SRNO",c),a(),LocalUtil.removeLocal("VC_SRNO")},n)}():a())}function p(){function a(a){Ajax.executeApi(RestApi.PUT.COLABO2_COMMT_U101,a,function(b){Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.edit)"})),UpdateElements.autoUpdateElem({POST_MODE:"EDIT",PROJECT_SRNO:b.COLABO_SRNO,POST_SRNO:b.COLABO_COMMT_SRNO}),i&&UpdateElements.autoUpdateElem({PROJECT_SRNO:a.COLABO_SRNO,POST_SRNO:a.COLABO_COMMT_SRNO,SUBTASK_DATA:a.TASK_REC[0]}),g&&ItemSchedule.checkSendEditPush()},n),LocalUtil.setLocal("VC_SRNO","0")}var b=$("#postPopup"),c=SpaceSelectable.isSharePost(b),d=SpaceSelectable.getSelectedProjectArray(),e=b.find("#videoSpan").attr("data-vc-srno"),f="none"!==b.find("#videoSpan").css("display")&&VideoConference.isVC(e),g=b.find(".create-post-nav").hasClass("schedule"),h=b.find(".create-post-nav").hasClass("task"),i=b.find(".create-post-nav").hasClass("subtask"),j=JsonMaker.getPostJson();return c?0===d.length?Often.toast("info",i18next.t("front.alert.checkMoreThanOne")):(j.COLABO_SRNO="",j.COLABO_COMMT_SRNO="",j.PRJ_REC=d,h&&0<j.TASK_REC[0].WORKER_REC.length&&(j.TASK_REC[0].WORKER_REC=[]),j.packetOption=Ajax.OPTION.PREVENT_EXECUTE,void Ajax.executeApi(RestApi.POST.COLABO2_COMMT_C101,j,function(){Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.share)"})),PostPopup.removePopup();var a=ViewChanger.getProjectSrno();d.forEach(function(b){b.COLABO_SRNO===a&&UpdateElements.autoUpdateElem()})})):VideoConference.isVC(LocalUtil.getLocal("VC_SRNO"))?f?void VideoConference.updateZoomToken({VC_TTL:j.SCHD_REC[0].TTL,VC_SRNO:e},a(j)):void VideoConference.deleteZoomToken({VC_SRNO:e},function(){j.SCHD_REC[0].VC_SRNO="0",a(j)}):0<b.find("#videoSpan:visible").length?void VideoConference.getZoomToken({TYPE:"SCHEDULE",VC_TTL:j.SCHD_REC[0].TTL},function(b){j.SCHD_REC[0].VC_SRNO=b.VC_SRNO,a(j)}):void a(j)}var q=$();return{mouseUpPopupArea:function(a){$(a.currentTarget).find("#postCntn").is(":visible")&&StyleTag.mouseUpCheck(a)},mouseDownPopupArea:function(a){q=$(a.target);$(a.currentTarget).find("#postCntn").is(":visible")&&($.isTarget(".subtask-input-area")&&a.stopPropagation(),StyleTag.mouseDownCheck(a))},clickPopupArea:b,getMouseDownStartObj:a}}();
"use strict";var PostPopupEvent=function(){function a(a,b){if(!Often.isBrowser("ie")){var c=b[0].childNodes;if(0!==c.length){var d="DIV"!==c[0].nodeName,e="BR"!==c[0].nodeName;if(d&&e&&!a.originalEvent.isComposing)return $(c[0]).wrap("<div></div>")}}}function b(a){var b=window.getSelection(),c=b.focusNode!==b.anchorNode;if(!c){var d=$(b.focusNode).hasClass("js-upload-area");if(d)return a.preventDefault();var e=b.focusNode&&"DIV"===b.focusNode.nodeName;e&&Caret.changeRemoveNode2FocusSibling(a,b,"create-box")}}function c(){var a=window.getSelection().focusNode;if(a){var b="#text"===a.nodeName;if(!(b&&""===Often.null2Void(a.innerText)&&"false"!==a.parentNode.getAttribute("contenteditable"))){var c=a.parentNode;if(b&&($(a).hasClass("mention-span")||$(a).hasClass("hashtag-span"))||"SPAN"===c.nodeName&&($(c).hasClass("mention-span")||$(c).hasClass("hashtag-span")))return $(a.parentNode).remove()}}}function d(a,b,c){var d=window.getSelection(),e=$(d.focusNode),f=e.context&&3===e.context.nodeType?e.parents("div"):e,g=b[0],h=-1,i=[];if($.each(g.childNodes,function(a,b){if(b===f[0]&&(h=a),$(b).hasClass(c)&&(i.push(a),-1<h))return!1}),0!==i.length){a.stopPropagation(),a.preventDefault();var j,k,l=i[i.length-1]<h;l?(j=i[i.length-1]+1,k=g.childNodes.length):1<i.length?(j=i[i.length-2]+1,k=i[i.length-1]):(j=0,k=i[0]);var m=document.createRange();m.setStart(g,j),m.setEnd(g,k),d.removeAllRanges(),d.addRange(m)}}function f(a){function b(a){var b=d.find(a);if(a=a.replace("-menu","-button"),b.is(":visible")){b.css("display","none");var c=d.find(a);0<c.length&&c.removeClass("active"),e=!0}}var c=a.type,d=$(a.currentTarget),e=!1;if("click"===c){if($.isTarget(a,"#innerCommonPopup")||b("#innerCommonPopup"),$.isTarget(a,".js-file-button")||b(".js-file-menu"),$.isTarget(a,".js-image-button")||b(".js-image-menu"),!$.isTarget(a,[".js-map-button",".js-map-menu"])){var f=PostPopupClickEvent.getMouseDownStartObj();if(0<f.closest(".js-map-button").length||0<f.closest(".js-map-menu").length)return;b(".js-map-menu")}$.isTarget(a,".js-setting-button")||b(".js-setting-ul"),$.isTarget(a,[".js-worker-layer",".js-worker-button"])||(d.find(".js-worker-layer[data-subtask-yn=Y]").remove(),d.find(".js-worker-layer[data-subtask-yn=N]").remove()),$.isTarget(a,".js-priority-event")||b(".js-priority-layer .js-priority-setting-layer"),$.isTarget(a,[".js-subtask-menu",".subtask-button"])||ItemSubtask.closeSubtaskPopup(),b(".create-post-option")}else if("keydown"===c){var g=d.find("#innerCommonPopup");g.is(":visible")&&"mention"!==g.attr("data-code")&&(g.css("display","none"),e=!0),[".js-file-menu",".js-image-menu",".js-map-menu",".js-setting-ul",".create-post-option"].forEach(b)}return e}return{mouseUpPopupArea:function(a){PostPopupClickEvent.mouseUpPopupArea(a)},mouseDownPopupArea:function(a){PostPopupClickEvent.mouseDownPopupArea(a)},clickPopupArea:function(a){return a.stopPropagation(),f(a),$.isTarget(a,".js-complete-btn[data-wait-yn=Y]")?Often.toast("error",i18next.t("front.common.wait")):void(Caret.setLastFocusNode(),PostPopupClickEvent.clickPopupArea(a))},keydownPopupArea:function(a){function b(){function b(){function a(a){var b=a.prev().hasClass("create-box"),c=a.next().hasClass("create-box");return b&&c}return"#text"===f&&a(j)||"DIV"===f&&a(i)}function c(){function a(a){var b=0===a.prev().length,c=0===a.next().length,d=a.prev().hasClass("create-box"),e=a.next().hasClass("create-box");return b&&e||c&&d}return a(j)||a(i)}function d(){function a(a){var b=0<a.prev().length,c=0<a.next().length,d=a.prev().hasClass("create-box"),e=a.next().hasClass("create-box");return c&&d||b&&e}return a(j)||a(i)}function e(){var b=KeyCheck.isKey(a,"BACK"),c=KeyCheck.isKey(a,"DELETE"),d=h.anchorOffset,e=h.focusOffset,f=h.isCollapsed;return f&&(b&&0===e||c&&d===g.text().length)}if(h.focusNode){var f=Often.null2Void(h.focusNode.nodeName,""),g="#text"===f?j:i,k=0===$.trim(g.text()).length,l=b(),m=c(),n=d(),o=e();if(l||m){if(k)g.attr({class:"js-hidden-component hidden-component",contenteditable:"false"}).html("&nbsp;");else if(o)return!0;}else if(n){if(k)return g.remove(),!0;if(o)return!0}}}var e=$(a.target),g=$(a.currentTarget),h=window.getSelection(),i=$(h.focusNode),j=i.parent(),k=KeyCheck.isKey(a,"ENTER");if(k&&e.is("#postTitle"))return void a.preventDefault();if(KeyCheck.isSelectAllCommand(a)&&0<e.closest(".js-upload-area").length)return void d(a,e.closest(".js-upload-area:visible"),"create-box");if(i.hasClass("create-box")&&j.hasClass("js-upload-area"))return!1;if(KeyCheck.isKey(a,"BACK")||KeyCheck.isKey(a,"DELETE")){if(b())return a.preventDefault();if(Often.isBrowser("ie"))return c()}if(!SubtaskKeyEvent.KeyDownSubtaskInput(a)){if(StyleTag.keyDownCheck(a),g.find("#innerCommonHashTagPopup").is(":visible"))return HashTag.keyDownArrow(a);if(k&&HashTag.clearHashTag(),g.find("#innerCommonPopup[data-code=mention]").is(":visible"))return Mention.keyDownArrow(a);if(k&&Mention.clearMention(),ItemTodo.keydownTodoInput(a),ItemSchedule.keyDownScheduleInput(a),KeyCheck.isKey(a,"TAB")){if(e.is("#postTitle"))return void g.find(".js-upload-area").focus();if(0<e.closest(".js-upload-area").length)return}if(KeyCheck.isKey(a,"ESC")){if(DocumentEvent.closeStepByStep())return;var l=f(a),m=ItemSchedule.keyDownCheckPlaceInput(a),n=ItemSubtask.isSubtaskInputFocus(a);l||m||n||PostPopup.checkWritingAndShowPopup(PostPopup.removePopup)}}},keyupPopupArea:function(a){var b=$(a.currentTarget),c=$(a.target),d=c.closest(".js-upload-area[contenteditable=true]");ItemSchedule.keyUpScheduleInput(a),ItemTodo.keyUpTodoInput(a),SubtaskKeyEvent.keyUpSubtaskInput(a);!d||0===d.length||SpaceSelectable.isSharePost(b)||(HashTag.keyUpCheckHashTag(a),Mention.keyUpCheckMention(a),StyleTag.keyUpCheck(a))},KeyDownContentsArea:function(c){var d=$(c.currentTarget).find(".js-upload-area");if(0!==d.length&&(a(c,d),KeyCheck.isKey(c,"DELETE")))return b(c)},hideAllInnerPopup:f,scrollHideAndRemovePopupLayer:function(){var a=$("#workerPopup:visible"),b=$(".flatpickr-calendar:visible"),c=$(".js-priority-setting-layer:visible");a&&a.remove(),b&&b.remove(),c&&c.css("display","none"),ItemSubtask.closeSubtaskPopup()},addScrollFixed:function(a){function b(a){var b=a.find(".js-remark-upload-file li"),c=a.find(".js-remark-upload-img li"),d=a.find(".js-remark-area");return 0===b.length&&0===c.length&&""===$.trim(d.text())}var c=$("#postPopup");if(c.is(":visible")){var d=a?$(a.target):c.find(".post-card-scroll"),e=d.scrollTop(),f=d.innerHeight(),g=d.prop("scrollHeight"),h=c.find(".js-edit-layer");if(e+f>=g)h.removeClass("sticky");else{if(!b(h))return;h.addClass("sticky")}}}}}();
"use strict";var PostPopupInit=function(){function a(a){e=a.find(".js-popup-before"),f=a.find(".js-content-area"),d=a.find(".js-upload-area")}function b(b,e,g){function h(){return k===DetailCode.SCHEDULE?f.append(ItemSchedule.getLookHtml()):k===DetailCode.TODO?(f.append(ItemTodo.getLookHtml()),void(m&&i())):void(f.append($("#uploadDiv").html()),k===DetailCode.TASK&&f.before(ItemTask.getLookHtml()),k===DetailCode.TASK&&!l&&f.after(ItemSubtask.getLookHtml()),f.after($("#postAttachedItem").html()),a(b),m&&i())}function i(){function a(){var a=Often.null2Void(e.CNTN),c=PostCondition.isNewStyleByCntn(e),f=JsonMaker.str2json(c?a:JsonMaker.convertJsonString(e));return 0===f.length?void d.append(TagConvert.db2HtmlStringByPost(a,o)):void f.forEach(function(a){return"TEXT"===a.COMP_TYPE?void d.append(TagConvert.db2HtmlStringByPost(a.COMP_DETAIL.CONTENTS,o)):"IMAGE"===a.COMP_TYPE||"FILE"===a.COMP_TYPE?void PostAppend.appendFileOrImg(b,a.COMP_DETAIL):"LINK"===a.COMP_TYPE?void PostAppend.appendLink(b,a.COMP_DETAIL):void("MAP"===a.COMP_TYPE&&PostAppend.appendMap(b,a.COMP_DETAIL))})}return function(){b.find("#postTitle").val(TagUtil.html2tag(e.COMMT_TTL))}(),a(),function(){var a=e.RANGE_TYPE,c="A"===a?"full":"admin",d="A"===a?i18next.t("front.common.public"):i18next.t("prefix.only",{val:"$t(front.common.projectManager)"}),f="A"===a?"admin":"full";b.find(".private-button").addClass(c).removeClass(f).text(d)}(),k===DetailCode.TODO?ItemTodo.getTodoDataListHtml(e):void(k===DetailCode.TASK&&(ItemTask.changeTaskViewByData(b,e.TASK_REC[0]),Often.isFunc(Func.CLOUD.COPY_SUBTASK_CONTENTS)&&b.find(".js-subtask-ul").append(ItemSubtask.getCompHtml(e.SUBTASK_REC,!n))))}var j=PostCondition.getPostCondition(PostCondition.getPopupMode(b),e),k=j.postCode,l="Y"===e.SUBTASK_YN,m=0<Object.keys(e).length,n="VIEW"===b.attr("data-code"),o=PostCondition.getPopupMode(b);a(b),h(),c(b,e,g),k===DetailCode.SCHEDULE&&ItemSchedule.initEdit(b,e),k===DetailCode.TASK&&ItemTask.initEdit(b,e),k===DetailCode.TODO&&ItemTodo.initEdit(b),k!==DetailCode.TASK||l||ItemSubtask.initEdit(b,e),b.off("click").on("click",DetailEvent.clickDetailUl).on("click",PostPopupEvent.clickPopupArea).off("mousedown").on("mousedown",PostPopupEvent.mouseDownPopupArea).off("mouseup").on("mouseup",PostPopupEvent.mouseUpPopupArea).off("keyup").on("keyup",PostPopupEvent.keyupPopupArea).off("keydown").on("keydown",PostPopupEvent.keydownPopupArea),f.off("keydown").on("keydown",PostPopupEvent.KeyDownContentsArea),b.find(".create-post-container").off("scroll").on("scroll",PostPopupEvent.scrollHideAndRemovePopupLayer),k!==DetailCode.TODO&&b.find(".create-title-input").focus()}function c(b,c,e){function f(){j||d.html(""),d.attr("placeholder",i18next.t("front.common.enterContext"))}a(b);var g=PostCondition.getPostCondition(PostCondition.getPopupMode(b),c),h=g.postCode,i=DetailCode.POST._TEXT[h],j=0<Object.keys(c).length;!j&&(j||e)?(b.find(".create-post-nav").on("click",function(a){var b=$(a.target),c=b.findUp(".js-post-type-item");0===c.length||PostPopup.checkWritingAndShowPopup(function(){PostPopup.openRegistrationView(ViewChanger.getProjectSrno(),c.attr("data-post-code"),!0)},"ADD_TAB")}),b.find(".create-post-title").text(i18next.t("front.common.writePost"))):(b.find(".create-post-nav").addClass("no-tab"),b.find(".create-post-title").text(i18next.t(i)+" "+i18next.t(j?"dictionary.edit":"dictionary.write")),b.find(".create-post-submit").addClass(j?"":"new-task")),f(),function(){var a=PostCondition.getFuncCondition(PostCondition.getPopupMode(b),c);b.find("[data-code=upload-file]").css("display",a.isUpload?"inline-block":"none"),b.find("[data-code=google-place]").css("display",a.isGooglePlace?"inline-block":"none"),b.find("[data-code=hash-tag]").css("display",a.isHashTag?"inline-block":"none"),b.find("[data-code=mention-tag]").css("display",a.isMentionTag?"inline-block":"none"),b.find("[data-code=style-tag]").css("display",a.isStyleTag?"inline-block":"none"),b.find(".js-editing-buttons").css("display",j?"inline-block":"none"),b.find(".js-complete-btn.create-button").css("display",j?"none":"inline-block")}();Often.isFunc(Func.ENTER.GOOGLE_MAP)&&function(){function a(a){PostAppend.appendMadeObj(d,PostComponent.getMapObj(a)),c.removeClass("active"),c.next().css("display","none")}var c=b.find(".js-map-button"),e=c.next().find("input");GoogleMap.addSearchEvent(e,a)}()}var d,e,f;return{initEditPopup:b,initViewPopup:function(a,b,c,d){var e=Often.null2Void(a.find(".js-up-task-button").attr("data-up-task-srno")),f=0<e.length,g=a.find(".card-item").hasClass("task");a.find(".list-item").css("display","none"),a.find(".detail-item").addClass("back-area"),a.find(".post-popup-header").css("display","block");var h=$("#projectTitleColor");ListHelper.removeAllColorClass(h),h.addClass("color-code-"+LocalUtil.getPopProjectBgColorCd()),function(b){"POP"===b?(a.addClass("flow-all-background-1"),a.find(".post-card-wrapper").removeClass("side")):(a.removeClass("flow-all-background-1"),a.find(".post-card-wrapper").addClass("side"))}(c?"POP":"SIDE"),f||a.find("#movePost").css("display","inline-block"),g&&ItemTask.initEdit(a,b),g&&ItemSubtask.initEdit(a),!Electron.isElectronApp()&&Often.isAct("subscreen")&&a.find(".btn-close").css("display","none"),"function"==typeof d&&d(b),a.off("mousedown").off("keyup").off("keydown").off("click").on("click",PostPopupEvent.clickPopupArea).on("click",DetailEvent.clickDetailUl).on({mousedown:PostPopupEvent.mouseDownPopupArea,keyup:PostPopupEvent.keyupPopupArea,keydown:PostPopupEvent.keydownPopupArea}),a.find(".post-card-scroll").off("scroll").on("scroll",function(a){PostPopupEvent.scrollHideAndRemovePopupLayer(a),PostPopupEvent.addScrollFixed(a)}),a.find(".js-remark-area").off("keydown").off("keyup").on({keydown:ItemRemark.keyDownRemarkInput,keyup:ItemRemark.keyUpRemarkInput}),$(window).on("resize",function(){PostPopupEvent.addScrollFixed()})}}}();
"use strict";var ItemBookmark=function(){return{toggleBookmark:function(a){var b=$(a.target),c=b.findUp(".js-post-bookmark"),d=c.hasClass("on");return function(a){var b=a?"COLABO2_BRING_D001":"COLABO2_BRING_C001";var d=c.findUp(".detail-item"),e=d.attr("data-project-srno"),f=d.attr("data-post-srno");Ajax.executeApi(b,{COLABO_SRNO:e,COLABO_COMMT_SRNO:f},function(){a?c.removeClass("on"):c.addClass("on"),Often.toast("success",i18next.t(i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.apply)"}))),ViewChanger.isPage("schd")||UpdateElements.autoUpdateElem({POST_SRNO:f,BOOKMARK_RELEASE:a})})}(d),!0},removeAnimate:function(a){var b=$("#allPostsLayer").find(".js-all-post-item").length,c=$("#myPostContentUl"),d=c.find(".js-all-post-item[colabo_commt_srno="+a+"]");0<d.length&&(d.animate({opacity:.1,height:0},150,"swing",function(){$(this).remove()}),1===b&&c.append(AllPosts.getBookmarkNoDataHtml()))}}}();
"use strict";var ItemReaction=function(){function a(a){var b=a.findUp(".js-post-reaction");b.hasClass("on")?g("0",a):d(b)}function b(a){var b=a.findUp(".js-emoji-select-layer");return 0===b.length?(f(),!1):(0!==a.findUp(".add-reaction").length&&(g(a.findUp(".add-reaction").attr("data"),a),e(a)),!0)}function c(a){var b=a.findUp(".js-emoji-group-layer");if(0===b.length)return!1;var c=a.findUp(".detail-item"),d=c.attr("data-project-srno"),e=c.attr("data-post-srno");return ReactionCheck.showReactionCheckPopup(a,d,e),!0}function d(a){a.nextAll(".js-emoji-select-layer").fadeIn(200)}function e(a){a.findUp(".js-emoji-select-layer").fadeOut(200)}function f(){$(".js-emoji-select-layer").fadeOut(200)}function g(a,b){var c=b.findUp(".detail-item"),d=c.attr("data-project-srno"),e=c.attr("data-post-srno");Ajax.executeApi(RestApi.PUT.COLABO2_POST_EMT_U001,{COLABO_SRNO:d,COLABO_COMMT_SRNO:e,EMT_CD:a},function(a){UpdateElements.autoUpdateElem({POST_SRNO:e,REACTION_POST_DATA:a})})}return{clickReactionArea:function(d){var e=$(d.target);return Often.isItem(e,".js-post-reaction")?a(e):Often.isItem(e,".js-emoji-select-layer")?b(e):Often.isItem(e,".js-emoji-group-layer")?c(e):void 0},closeAllReactionPopup:f,updateReactionElements:function(a,b,c,d){function e(a,b){var c=JsonMaker.getEmojiInfo(b),d=2>Object.keys(c).length,e=a.find(".js-post-reaction"),f=a.find(".emoji-count"),g=a.find(".emoji-group"),h=a.find(".emoji-area"),i=a.find(".js-post-reaction span");f.text(d?"":c["emoji-text"]),g.html(d?"":c["emoji-icons"]),e.attr("class",d?"":c["reaction-display"]),e.addClass("js-post-reaction").addClass("post-bottom-button"),h.css("display",d?"none":"block"),i.text(c["reaction-text"])}function f(a,b){var c="Y"===b.EMT_SELF_YN;c?(a.find(".js-remark-like").addClass("on"),a.find(".js-remark-like-button .txt-like").text(i18next.t("front.common.unDoLike")),"1"===b.EMT_CNT&&a.find(".js-remark-like-count").addClass("on")):(a.find(".js-remark-like").removeClass("on"),a.find(".js-remark-like-button .txt-like").text(i18next.t("dictionary.like")),"0"===b.EMT_CNT&&a.find(".js-remark-like-count").removeClass("on")),a.find(".js-remark-like-count").text(b.EMT_CNT)}var g=$("#postPopup:visible").find("#post-"+b),h=$("#detailUl:visible").find("#post-"+b);"POST"===a?(e(g,d),e(h,d)):"REMARK"==a&&(f(g.find(".remark-item[remark-srno='"+c+"']"),d),f(h.find(".remark-item[remark-srno='"+c+"']"),d))}}}();
"use strict";var ItemRemark=function(){function a(a){Upload.uploadFile("any",function(c){b(c,a)})}function b(a,b){a.FILE_NAME=a.FILE_NM;var c=ImageUtil.isImageType(a),d=c?PostComponent.getImgHtml("<li>"+$("#imageComponent").html()+"</li>",a):PostComponent.getFileHtml("<li>"+$("#fileComponent").html()+"</li>",a),e=c?"img":"file",f=20<=b.find(".js-post-file").length,g=20<=b.find(".js-post-img").length;if(f&&"file"===e||g&&"img"===e)return void Often.toast("error",i18next.t("front.alert.uploadWarning",{val:c?"$t(dictionary.image)":"$t(dictionary.file)",count:20}));var h=b.find(".js-remark-upload-"+e);""===h.html()&&c&&h.append("<div>&nbsp;</div>\n");var i=$(d);if(h.append(i).focus(),i.offset().top>window.innerHeight){var j=0<b.parents("#postPopup").length,k=j?b.parents(".post-card-scroll"):b.parents(".layer-scroll"),l=k.scrollTop();k.scrollTop(l+200+(i.offset().top-window.innerHeight))}h.find(".js-down-btn").css("display","none"),h.find(".js-del-btn").css("display","block")}function c(a){if(void 0===a)return"";var b=$("#remarkItem").html(),c=Authority.isAuthorityCheck("REMARK"),g="";return $.each(a,function(a,h){var i="0"!==Often.null2Void(h.EMT_CNT,"0"),j=h.ATCH_REC?h.ATCH_REC:h.REMARK_ATCH_REC,k=h.IMG_ATCH_REC?h.IMG_ATCH_REC:h.REMARK_IMG_ATCH_REC;"\n"===h.REMARK_CNTN[h.REMARK_CNTN.length-1]&&(h.REMARK_CNTN=h.REMARK_CNTN.slice(0,-1));var l="Y"===Often.null2Void(h.EMT_SELF_YN,"N");g+=ListHelper.replaceJson(b,$.extend({},{"data-remark-srno":h.COLABO_REMARK_SRNO,position:"",name:h.RGSR_NM,date:Tz.momentTimeZone(h.RGSN_DTTM,"type1"),contents:TagConvert.db2HtmlStringByRemark(h.REMARK_CNTN),"like-count":h.EMT_CNT,profile:ListHelper.setProfile(h.PRFL_PHTG),"like-yn":i?"on":"","file-area":e(j),"image-area":f(k),"modify-yn":"Y"===Often.null2Void(h.MODIFY_YN,"N")?"on":"","delete-yn":"Y"===Often.null2Void(h.DELETE_YN,"N")?"on":"","emt-self-yn":"Y"===Often.null2Void(h.EMT_SELF_YN,"N")?"on":"","emt-button-text":i18next.t(l?"front.common.unDoLike":"dictionary.like"),"admin-write-yn":c?"":"admin","comment-user-id":h.RGSR_ID},d(c)))}),g}function d(a){var b;return b=a?i18next.t("front.common.textLine"):i18next.t("front.common.adminWriteOnly",{type:"$t(dictionary.comment)"}),{"remark-placeholder":b,"remark-contenteditable":a}}function e(a){if(void 0===a||0===a.length)return"";var b=$("#fileComponent").html(),c="";return $.each(a,function(a,d){c+=PostComponent.getFileHtml("<li>"+b+"</li>",d)}),c}function f(a){if(void 0===a)return"";var b=$("#imageComponent").html(),c="";return $.each(a,function(a,d){c+=PostComponent.getImgHtml("<li>"+b+"</li>",d)}),c}function g(a){var b=a.findUp(".js-remark-edit-button"),c=b.hasClass("js-remark-update"),d=b.hasClass("js-remark-delete");if(!c&&!d)return!1;var e=a.findUp(".detail-item"),f=a.findUp(".remark-item"),g=e.attr("data-project-srno"),i=e.attr("data-post-srno"),j=f.attr("remark-srno"),k=Authority.isAuthorityCheck("ADMIN",g),l=Authority.isAuthorityCheck("REMARK",g);return c?k||l?(n(f),!0):void Often.toast("error",i18next.t("front.common.adminWriteOnly",{type:"$t(dictionary.comment)"})):d?(h(f,g,i,j),!0):void 0}function h(a,b,c,d){PopupDraw.drawConfirm({await:!0,contents:{main:i18next.t("front.common.ask",{val:"$t(dictionary.comment)",status:"$t(dictionary.delete)"})},callback:{submit:function(){PopupDraw.closePopup(),Ajax.executeApi(RestApi.DELETE.COLABO2_REMARK_D101,{COLABO_SRNO:b,COLABO_COMMT_SRNO:c,COLABO_REMARK_SRNO:d},function(d){a.findUp(".detail-item").find(".comment-count").text(d.TOT_CNT),a.fadeOut(200,function(){a.remove()});var e=a.findUp(".detail-item");if(e.find(".js-remark-prev-button").hasClass("on")&&3>e.find(".remark-item").length){var f=e.find(".js-comment-area");f.find(".remark-item").remove(),l(f,{MODE:OftenCode.DELETE,ORDER_TYPE:OftenCode.DELETE,COLABO_SRNO:b,COLABO_COMMT_SRNO:c})}0!==e.findUp("#postPopup").length&&UpdateElements.autoUpdateElem(),Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.delete)"}))})}}}),$("#tempPopup").focus()}function i(a){if(Mention.keyUpCheckMention(a),KeyCheck.isKey(a,"BACK")||KeyCheck.isKey(a,"DELETE")){var b=$(a.target).findUp(".js-remark-area"),c=b.text();return void(""===c&&b.empty())}if(a.shiftKey&&KeyCheck.isKey(a,"ENTER")||!KeyCheck.isKey(a,"ENTER")){if(0===$(a.target).findUp(".js-edit-layer").length)return;var d=$(a.target).findUp("#postPopup"),e=d.find(".post-card-scroll");return void e.moveToBottom(!1)}}function j(a){KeyCheck.isStyleCommand(a)&&a.preventDefault(),z=$(a.target);var b=z.parents(".js-remark-form"),c=b.hasClass("admin");if(!Authority.isAdminAuthorityCheckAndAction(c,a)){var d=z.findUp("#postPopup"),e=z.findUp("#detailUl");a.stopPropagation();var f=a.ctrlKey,g=a.shiftKey,h=KeyCheck.isKey(a,"ENTER"),i=KeyCheck.isKey(a,"ESC"),j=0<z.findUp(".js-remark-edit").length;if(j&&i)return void(y(z)?(PopupDraw.drawConfirm({contents:{main:i18next.t("front.alert.leaveWriting")},callback:{submit:function submit(){o(z.findUp(".remark-item")),PopupDraw.closePopup()},cancel:function cancel(){PopupDraw.closePopup(),z.focus()}}}),$("#tempPopup").focus()):o(z.findUp(".remark-item")));var l=z.findUp(".js-remark-layer"),m=l.find(".js-remark-upload-file li"),n=l.find(".js-remark-upload-img li");if(d.find("#innerCommonPopup[data-code=mention]").is(":visible")||e.find("#innerCommonPopup[data-code=mention]").is(":visible"))return h&&229===B&&(Often.getClientOSInfo().isMac||Often.isBrowser("ie"))&&(A=!0),void Mention.keyDownArrow(a);if(B=a.keyCode,!f&&!g&&h){if(a.preventDefault(),B=0,A)return void(A=!1);var p=0<m.length,q=0<n.length;return""!==$.trim(z.text())||p||q?void UploadHandler.isUploadingAndCallback(function(){k(z,j)}):void Often.toast("error",i18next.t("front.common.enterContext",{val:"$t(dictionary.comment)"}))}if(l.hasClass("sticky")){if(0===$(a.target).findUp(".js-edit-layer").length)return;var r=d.find(".post-card-scroll");return r.moveToBottom(!0),void l.removeClass("sticky")}}}function k(a,b){var c="",d=$(a[0].childNodes).length;if(b){var e="";$.each($(a[0].childNodes),function(a,b){var f=$(b),g=0===a||"#text"!==e.nodeName&&-1<e.innerHTML.indexOf("\n"),h=a!==d-1&&"<br>"===b.innerHTML;f.hasClass("js-hidden-component")||("DIV"===b.nodeName&&""!==c&&!g&&(c+="\n"),!h&&(c+=TagConvert.html2DbStringByPost(b.outerHTML||b.innerHTML||b.textContent)),e=b)})}var f=TagConvert.html2DbStringByRemark(b?c:a.html());f+="\n"===f[f.length-1]?"":"\n";var g=a.findUp(".detail-item"),h=a.findUp(".js-remark-layer"),i=h.find(".js-post-img"),j=h.find(".js-post-file"),k=g.attr("data-project-srno"),m=g.attr("data-post-srno"),n="",o="",p="";b?(o=RestApi.PUT.COLABO2_REMARK_U101,n=a.findUp(".remark-item").attr("remark-srno"),p=OftenCode.EDIT):(o=RestApi.POST.COLABO2_REMARK_C101,n="",p=OftenCode.CREATE);var q={COLABO_SRNO:k,COLABO_COMMT_SRNO:m,COLABO_REMARK_SRNO:n,CNTN:f,COMMT_ATCH_REC:Often.getAttrs(j),COMMT_EDITOR_REC:Often.getAttrs(i),packetOption:Ajax.OPTION.PREVENT_EXECUTE};Mention.clearMention(),Ajax.executeApi(o,q,function(b){a.text(""),l(a,$.extend({},q,{MODE:p,ORDER_TYPE:OftenCode.EQUAL,SRCH_COLABO_REMARK_SRNO:b.COLABO_REMARK_SRNO}));p!==OftenCode.CREATE||UpdateElements.autoUpdateElem({PROJECT_SRNO:q.COLABO_SRNO,POST_SRNO:q.COLABO_COMMT_SRNO,REMARK_SRNO:b.COLABO_REMARK_SRNO,REMARK_UPDATE:!0})})}function l(a,b,d){Ajax.executeApi(RestApi.GET.COLABO2_REMARK_R101,b,function(e){var f=e.COLABO_REMARK_REC,g=f&&0<f.length,h=b.MODE===OftenCode.MORE,i="N"===Often.null2Void(e.NEXT_YN,"N"),j=2<+e.TOT_CNT,k=h?i?"":"on":j?"on":"",l={"remark-count":g?e.TOT_CNT:"0","remark-over-yn":k,"remark-area":g?c(f):""};m(b.MODE,a,l),"function"==typeof d&&d()})}function m(a,b,c){var d=b.findUp(".detail-item"),e=a===OftenCode.MORE,f=a===OftenCode.EDIT,g=a===OftenCode.DELETE;if(e||g)return d.find(".js-remark-prev-button").removeClass("on").addClass(c["remark-over-yn"]),void d.find(".post-comment-group").prepend(c["remark-area"]);if(f)return b.findUp(".remark-item").replaceWith(c["remark-area"]),void Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.edit)"}));var h=b.findUp(".js-remark-form");"UPDATE"!==a&&(h.find(".js-remark-upload-file").empty(),h.find(".js-remark-upload-img").empty()),d.find(".comment-count").text(c["remark-count"]),d.find(".post-comment-group").append(c["remark-area"])}function n(a){var b=a.find(".js-remark-view"),c=a.find(".js-remark-edit"),d=b.find(".js-remark-text"),e=c.find(".js-remark-area");e.html(TagConvert.html2HtmlStringByRemark(d.html())),c.find(".js-remark-upload-file").html(b.find(".js-remark-upload-file").html()),c.find(".js-remark-upload-img").html(b.find(".js-remark-upload-img").html()),b.removeClass("on"),c.addClass("on"),c.find(".js-del-btn").css("display","block"),c.find(".js-down-btn").css("display","none"),e.off("keydown").on("keydown",ItemRemark.keyDownRemarkInput).off("keyup").on("keyup",ItemRemark.keyUpRemarkInput),e.focus();var f=window.getSelection().focusNode;f=f.hasChildNodes()?f.lastChild:f.parentNode.lastChild,"#text"!==f.nodeName&&(f=f.parentNode.lastChild),Caret.focusNextCaret(f,f.length)}function o(a){a.find(".js-remark-view").addClass("on"),a.find(".js-remark-edit").removeClass("on")}function p(a){if(0<a.findUp(".js-comment-thumbnail").length||0<a.findUp(".js-comment-user-name").length){var b=a.findUp(".remark-item").attr("data-user-id");return Profile.drawProfilePopup(b),!0}return!1}function q(a){var b=a.findUp(".js-remark-prev-button");if(0===b.length)return!1;var c=a.findUp(".detail-item"),d=c.attr("data-project-srno"),e=c.attr("data-post-srno"),f=c.find("li.remark-item:first").attr("remark-srno");return l(a,{MODE:OftenCode.MORE,ORDER_TYPE:OftenCode.PREV,COLABO_SRNO:d,COLABO_COMMT_SRNO:e,SRCH_COLABO_REMARK_SRNO:f},function(){PostPopup.addScrollSticky()}),!0}function r(a){var b=a.findUp(".js-remark-more-button");if(0===b.length)return!1;var c=a.findUp(".detail-item"),d=c.attr("data-project-srno"),e=c.attr("data-post-srno"),f=c.find("li.remark-item:last").attr("remark-srno");return l(a,{MODE:OftenCode.NEXT,ORDER_TYPE:OftenCode.NEXT,COLABO_SRNO:d,COLABO_COMMT_SRNO:e,SRCH_COLABO_REMARK_SRNO:f,RENEWAL_YN:"Y"}),!0}function s(a){var b=a.findUp(".js-remark-like-button");if(0===b.length)return!1;var c=a.findUp(".detail-item"),d=c.attr("data-project-srno"),e=c.attr("data-post-srno"),f=b.findUp(".remark-item"),g=f.attr("remark-srno"),h=a.findUp(".js-remark-like"),i=h.hasClass("on")?0:1;return Ajax.executeApi(RestApi.PUT.COLABO2_REMARK_EMT_U001,{COLABO_SRNO:d,COLABO_COMMT_SRNO:e,COLABO_REMARK_SRNO:g,EMT_CD:i},function(a){UpdateElements.autoUpdateElem({POST_SRNO:e,REMARK_SRNO:g,REACTION_REMARK_DATA:a})}),!0}function t(a){var b=a.findUp(".js-remark-like-count");if(0===b.length)return!1;var c=a.findUp(".detail-item"),d=c.attr("data-project-srno"),e=c.attr("data-post-srno");return ReactionCheck.showReactionCheckPopup(a,d,e),!0}function u(a){var b=a.findUp(".js-del-btn"),c=0<a.findUp(".js-remark-layer").length;if(0===b.length||!c)return!1;var d=0<b.findUp(".js-post-img").length,e=0<b.findUp(".js-post-file").length,f=d?"img":e?"file":"";if(""===f)return!0;var g=b.findUp(".js-post-"+f).parent("li");return g.remove(),!0}function v(a){var b=a.findUp(".image-item"),c=b.findUp(".js-remark-view");if(!c||0===c.length)return!1;var d=b.findUp(".js-remark-upload-img"),e=0<d.length;if(0===b.length||!e)return!1;var f=b.findUp(".js-popup-before"),g=Often.getAttrs(d.find(".image-item")),h=d.find("li").index(a.findUp("li"));return $.each(g,function(a,b){b.COLABO_SRNO=f.attr("data-project-srno"),b.COLABO_COMMT_SRNO=f.attr("data-post-srno")}),ImageViewer.openImage("POST",g,h),!0}function w(a){var b=a.findUp(".js-post-file");if(!b||0===b.length)return!1;var c=b.findUp(".js-remark-view");if(!c||0===c.length)return!1;var d=b.findUp(".js-popup-before"),e=0<a.findUp(".js-down-btn").length,f=Often.getAttrs(b);f[0].FILE_NAME=$.trim(b.find(".js-file-title").text()),f[0].COLABO_SRNO=d.attr("data-project-srno"),f[0].COLABO_COMMT_SRNO=d.attr("data-post-srno");var g=e?"SAVE":"DOC-VIEWER";FileUtil.openFile(g,f)}function x(a){var b=$(a.target),c=b.findUp("#postPopup"),d=b.findUp(".js-remark-layer");if($.isTarget(a,"#postPopup")&&d.hasClass("sticky")){var e=c.find(".post-card-scroll");e.moveToBottom(!0)}}function y(a){var b=a.findUp(".remark-item"),c=b.find(".js-remark-view"),d=b.find(".js-remark-edit"),e=Often.getAttrs(c.find(".js-post-file")),f=Often.getAttrs(d.find(".js-post-file")),g=JSON.stringify(e)!==JSON.stringify(f),h=Often.getAttrs(c.find(".js-post-img")),i=Often.getAttrs(d.find(".js-post-img")),j=JSON.stringify(h)!==JSON.stringify(i),k=c.find(".js-remark-text").html(),l=a.html();return g||j||k!==l}var z,A=!1,B=0;return{clickRemarkComponent:function(b){var c=$(b.target),d=c.closest(".js-remark-layer");return $.isTarget(b,".js-remark-upload-button")?a(d):void(g(c)||u(c)||q(c)||p(c)||s(c)||v(c)||w(c)||t(c)||r(c))},addEventOnRemarkInput:function(){$(".js-remark-area").off("keydown").off("keyup").on("keydown",j).on("keyup",i)},keyDownRemarkInput:j,keyUpRemarkInput:i,getRemarkItemHtml:c,getRemarkDataHtml:l,getRemarkWriteConditionJson:d,drawUploadFile:b,updateRemarkData:function(a,b,d){function e(a){a.parents(".comment").css("display","inline-block"),a.text(+a.text()+1)}var f=$("#postPopup:visible"),g=$("#detailUl:visible"),h=f.find("#post-"+b).find(".js-remark-area:visible"),i=g.find("#post-"+b).find(".js-remark-area:visible"),j=0<h.length,k=!1;if(0<g.length)if(g.hasClass("list")){var l=g.find("#post-"+b);0<l.length&&e(l.find(".js-remark-count"))}else k=0<i.length;(j||k)&&function(){Ajax.executeApi(RestApi.GET.COLABO2_REMARK_R101,{COLABO_SRNO:a,COLABO_COMMT_SRNO:b,SRCH_COLABO_REMARK_SRNO:d,ORDER_TYPE:"N",packetOption:Ajax.OPTION.PREVENT_CALLBACK},function(a){var d=a.COLABO_REMARK_REC,e=d&&0<d.length,f=2<+a.TOT_CNT,g={"remark-count":e?a.TOT_CNT:"0","remark-over-yn":f?"":"on","remark-area":e?c(d):""};if(ItemSubtask.setSubtaskRemarkCount(b,a.TOT_CNT));j&&m("UPDATE",h,g),k&&m("UPDATE",i,g)})}()},moveToRemarkBottom:x}}();
"use strict";var ItemSchedule=function(){function a(a){var b={isAttend:!1,status:0};return $.each(a,function(a,c){c.ATTENDENCE_ID===_USER_ID&&(b.isAttend=!0,b.status=c.STATUS)}),b}function b(a){if(!a)return"";var b="",c="VIEW"!==Often.null2Void($("#postPopup").attr("data-code"),"VIEW"),d=function(){return $(c?"#attendanceEditItem":"#attendanceViewItem").html()}();return a.forEach(function(e,f){5>f||c?b+=ListHelper.replaceJson(d,{id:e.ATTENDENCE_ID,name:e.ATTENDENCE_NM,profile:ListHelper.setProfile(e.PRFL_PHTG),"attendance-status":e.STATUS?ScheduleCode.STATUS._GB[e.STATUS-1]:"default"}):a.length===f+1&&(b+=$("#attendanceMoreItem").html())}),b}function c(a){var c=$("#postPopup"),d=c.find(".js-manager-group"),e=!1;if($.each(d.find(".js-registration"),function(b,c){if($(c).attr("data-worker-id")===a[0].ATTENDENCE_ID)return e=!0,!1}),e)return Often.toast("error","\uC774\uBBF8 \uB4F1\uB85D\uB41C \uCC38\uC5EC\uC790\uC785\uB2C8\uB2E4.");var f=JSON.parse(Often.null2Void(c.find(".js-attendance-input").attr("data-attendance").replace(/'/ig,"\""),"{}"));f.push(a[0]),d.append(b(a)),c.find(".js-attendance-input").attr("data-attendance",JSON.stringify(f)),WorkerPopup.closeWorkerPopup()}function d(a){if("ADD"===a.attr("data-code")){var b=[{ATTENDENCE_ID:_USER_ID,ATTENDENCE_NM:_USER_NM,JBCL_NM:"",PRFL_PHTG:_PRFL_PHTG,RCVR_CORP_NM:"",RCVR_DVSN_NM:"",RQST_USE_INTT_ID:_USE_INTT_ID,STATUS:"1"}];WorkerPopup.setSubmitRecord(b),a.find(".js-attendance-input").attr("data-attendance",JSON.stringify(b)),e(b)}}function e(a){$("#postPopup").find(".js-attendance-layer .manager-group").append(b(a))}function f(a,b){var c=a.find("#ondDay").is(":checked"),d=b&&0!=Often.null2Void(a.find("#videoSpan").attr("data-vc-srno"),"0"),e=[],f="";c?(e=[0,1440,2880,10080],a.find("#videoButton").addClass("prevent-events").addClass("line-through")):(e=[0,10,30,60,120,180,1440,2880,10080],a.find("#videoButton").removeClass("prevent-events").removeClass("line-through")),e.forEach(function(a){(!c||c&&(0>=a||1440<=a))&&(f+="<option value=\""+a+"\">"+u(a)+"</option>")}),d?a.find(".oneday").addClass("prevent-events").addClass("line-through"):a.find(".oneday").removeClass("prevent-events").removeClass("line-through"),a.find("#alarmButton").empty(),a.find("#alarmButton").append(f)}function g(a){function b(){var a=n.find(".js-attendance-input");return JSON.parse(Often.null2Void(a.attr("data-attendance").replace(/'/ig,"\""),"{}"))}function c(){var a=n.find(".js-attendance-input");return JSON.parse(Often.null2Void(Often.null2Void(a.attr("data-attendance-delete"),"[]").replace(/'/ig,"\""),"{}"))}function d(a){function c(){var c=b();if($.each(c,function(b,c){var d=!0;$.each(a,function(a,b){if(b.ATTENDENCE_ID===Often.null2Void(c.ATTENDENCE_ID,c.USER_ID))return d=!1,!1}),d&&g.push(c)}),$.each(a,function(a,b){var d=!0;$.each(c,function(a,c){if(b.ATTENDENCE_ID===Often.null2Void(c.ATTENDENCE_ID,c.USER_ID))return d=!1,!1}),d&&f.push(b)}),!w)return d()}function d(b){if(!w)return m.find(".js-registration").remove(),n.find(".js-attendance-input").attr({"data-attendance":JSON.stringify(a),"data-attendance-insert":JSON.stringify(f),"data-attendance-delete":JSON.stringify(g)}),void e(a);UpdateElements.autoUpdateElem({PROJECT_SRNO:o,POST_SRNO:p,REMARK_SRNO:s,REMARK_UPDATE:!0});var c={OBJECT:"ATTENDENCE",ATTENDENCE_REC:b.ATTENDENCE_REC};UpdateElements.autoUpdateElem({PROJECT_SRNO:n.attr("data-project-srno"),POST_SRNO:n.attr("data-post-srno"),SCHEDULE_DATA:c})}var f=[],g=[];return"ADD"===PostCondition.getPopupMode(m)?d():void(c(),w&&PopupDraw.drawConfirm({contents:{main:i18next.t("front.common.ask",{val:"$t(dictionary.participant)",status:"$t(dictionary.edit)"})},callback:{submit:function(){h(d,{COLABO_SRNO:n.attr("data-project-srno"),COLABO_COMMT_SRNO:n.attr("data-post-srno"),INSERT_ATD_REC:f,DELETE_ATD_REC:g})}}}))}function f(a){var b="",c=r();return $.each(a,function(a,d){b+=ListHelper.replaceJson(c,{id:d.ATTENDENCE_ID,name:d.ATTENDENCE_NM,profile:ListHelper.setProfile(d.PRFL_PHTG),gubun:""===d.STATUS?"default":ScheduleCode.STATUS._GB[d.STATUS-1],badge:""===d.STATUS?"":i18next.t(ScheduleCode.STATUS._TEXT[d.STATUS-1]),"badge-display":ListHelper.setDisplay(""!==d.STATUS,"inline-block"),position:d.JBCL_NM,company:d.CMNM,affiliation:d.DVSN_NM})}),b}function g(a){var b=$(a.target);v&&clearTimeout(v),v=setTimeout(function(){ListHelper.initPageData(x),$("#confirmationPopup").find("#participantUl").empty(),i(b,!1)},200)}function i(a,b){"N"===x.NEXT_YN||Ajax.executeApi(RestApi.GET.FLOW_SCHD_ATD_R02,$.extend({},x,{COLABO_SRNO:o,COLABO_COMMT_SRNO:p,SEARCH_TEXT:Often.null2Void(a.val())}),function(c){b&&$("body").prepend(q());var d=$("#confirmationPopup"),e=d.find("#participantUl");e.drawListHelper({pageData:x,nextYn:c.NEXT_YN,records:c.ATTENDENCE_REC,noDataHtml:ListHelper.getNoDataHtml("search"),callback:{click:j,item:f,scroll:function scroll(){i(a,!1)}}});b&&k(d)})}function j(a){var b=$(a.target),c=b.findUp(".js-participant-item");if(0<c.length)return void Profile.drawProfilePopup(c.find(".js-user-id").attr("id"))}function k(a){a.find("#confirmationPopupSearchText").off("keyup").on("keyup",g),a.off("click").on("click",function(a){var b=$(a.target);if(0===b.findUp("#confirmationInnerPopup").length||0<b.findUp("#confirmationPopupCloseBtn").length)return void t()})}var l=a.findUp(".js-attendance-layer");if(0<!l.length)return!1;var m=a.findUp("#postPopup"),n=a.findUp(".js-popup-before"),o=n.attr("data-project-srno"),p=n.attr("data-post-srno"),s=n.find(".remark-item:last").attr("remark-srno"),u=a.findUp(".js-more-registration-button");if(0<u.length)return ListHelper.initPageData(x),i(a,!0),!0;var y=a.findUp(".js-worker-button");if(0<y.length)return Authority.isAuthorityCheck("WRITE",o)?(Often.isFunc("INVITATION_POPUP")?InvitationPopup.openParticipantPopup(n.attr("data-post-srno")):WorkerPopup.toggleWorkerPopup(n,d,y,b),!0):void Often.toast("error","\uAD00\uB9AC\uC790\uB9CC \uAE00/\uB313\uAE00 \uC791\uC131 \uAC00\uB2A5\uD55C \uAC8C\uC2DC\uBB3C\uC785\uB2C8\uB2E4.");var z=a.findUp(".js-remove-worker");if(0<z.length){var A=b(),B=c(),C=0;return A.forEach(function(a,b){if(a.ATTENDENCE_ID===z.parents(".js-registration").attr("data-worker-id"))return B.push(a),void(C=b)}),A.splice(C,1),n.find(".js-attendance-input").attr("data-attendance",JSON.stringify(A)),n.find(".js-attendance-input").attr("data-attendance-delete",JSON.stringify(B)),z.parents(".js-registration").remove(),!0}var D=a.findUp(".js-manager-group");if(0<D.length){if(w)ListHelper.initPageData(x),i(a,!0);else{var E=a.findUp(".js-registration").attr("data-worker-id");Profile.drawProfilePopup(E)}return!0}}function h(a,b){Ajax.executeApi(RestApi.PUT.FLOW_SCHD_ATD_U001,b,a)}function i(a){var b=a.findUp(".js-popup-before"),c=a.is("#videoButton")?a:a.parent("#videoButton");return 0!==c.length&&(LimitGuest.isLimitGuest("video",!1)?void 0:(VideoConference.isZoomSynchronized(function(){a.addClass("d-none"),a.next("#videoSpan").removeClass("d-none"),a.next("#videoSpan").find(".remove-button").removeClass("d-none"),a.next("#videoSpan").find("#zoomUrlCopy").addClass("d-none"),b.find(".oneday").addClass("line-through").addClass("prevent-events")},VideoConference.alertRequiredZoomSync),!0))}function j(a){var b=a.findUp("#videoSpan"),c=a.findUp(".remove-button"),d=a.findUp(".js-popup-before");if(0===b.length||0===c.length)return!1;var e=b.prev("#videoButton");e.removeClass("d-none"),b.addClass("d-none"),d.find(".oneday").removeClass("line-through").removeClass("prevent-events")}function k(a){var b=a.findUp(".js-schedule-date-layer");if(!b||0===b.length)return!1;var c=0<b.find("#ondDay:checked").length,d=a.findUp(".oneday"),e=$("#videoButton");0<d.length&&(c?(d.find("#ondDay").removeProp("checked"),c=!1,e.removeClass("prevent-events").removeClass("line-through")):(d.find("#ondDay").prop("checked","checked"),c=!0,e.addClass("prevent-events").addClass("line-through")),f(a.parents("#postPopup"))),p(b,c);var g=a.findUp(".js-pickr-layer");return!(0<g.length)||(o(b,c),!0)}function l(a){var b=a.findUp("#placeSpan, .js-place-span");if(0===b.length)return!1;var c=b.attr("data-map-link");return""!==c&&window.open(c,"google_blank"),!0}function m(a){function b(){var a={COLABO_SRNO:d,COLABO_COMMT_SRNO:e,STATUS:g,packetOption:Ajax.OPTION.PREVENT_EXECUTE};Ajax.executeApi(RestApi.PUT.FLOW_SCHD_ATD_U002,a,function(){n(c,g),UpdateElements.autoUpdateElem({PROJECT_SRNO:d,POST_SRNO:e,REMARK_SRNO:f,REMARK_UPDATE:!0})})}var c=a.findUp("#attendanceSelect");if(0===c.length||!a.is("button"))return!1;if(a.hasClass("on"))return!0;var d=a.parents(".detail-item").attr("data-project-srno"),e=a.parents(".detail-item").attr("data-post-srno"),f=a.parents(".detail-item").find(".remark-item:last").attr("remark-srno"),g=0;return a.hasClass("participate")&&(g=1),a.hasClass("absence")&&(g=2),a.hasClass("undetermined")&&(g=3),b(),!0}function n(a,b){function c(){return 1===b?"participate":2===b?"absence":3===b?"undetermined":""}var d=a.find(".on").attr("data-status"),e=a.prev().find("#attendanceCount ."+d+" em"),f=a.prev().find("#attendanceCount ."+c()+" em"),g=a.prev().find(".js-registration[data-worker-id=\""+_USER_ID+"\"]");e.text(parseInt(e.text())-1),f.text(parseInt(f.text())+1),a.find("button").removeClass("on"),a.find("."+c()).addClass("on"),g.removeClass(d).addClass(c())}function o(a){function b(){if(!h){var a=c.parents(".js-schedule-date-layer"),b=a.find(".js-start-flatpickr .js-pickr-date"),e=a.find(".js-start-flatpickr .js-pickr-text"),f=a.find(".js-end-flatpickr .js-pickr-date"),i=a.find(".js-end-flatpickr .js-pickr-text");b.val(d.startDate),e.val(Tz.momentConversion("convertOnly",g?"type5":"type6",d.startDate)),f.val(d.endDate),i.val(Tz.momentConversion("convertOnly",g?"type5":"type6",d.endDate)),DatePicker.checkOverDate(e,d)}}var c,d,e=a.find(".js-start-flatpickr"),f=a.find(".js-end-flatpickr"),g=a.find("#ondDay").is(":checked"),h=!1;DatePicker.makeFlatPickr({dateFormat:"YmdHi00",enableTime:!0,time_24hr:!0,plugins:[new confirmDatePlugin({confirmText:i18next.t("dictionary.select"),showAlways:!0},b)],minuteIncrement:Often.isFunc(Func.CLOUD.EDIT_TIME_TEXT)?1:10,startDate:e.find(".js-pickr-date").val(),endDate:f.find(".js-pickr-date").val(),inputObj:{start:e,end:f},allDay:g,rescheduling:!0,callback:{close:function(a,b,e){c=a,d=b,h=e}}})}function p(a,b){var c=a.find(".js-start-flatpickr"),d=a.find(".js-end-flatpickr"),e=c.find(".js-pickr-date").val(),f=d.find(".js-pickr-date").val();c.find(".js-pickr-text").val(Tz.momentConversion("convertOnly",b?"type5":"type6",e)),d.find(".js-pickr-text").val(Tz.momentConversion("convertOnly",b?"type5":"type6",f))}function q(){return $("#confirmationPopupDiv").html()}function r(){return $("#participantItemLi").html()}function s(){var a=JsonMaker.getPostJson();Ajax.executeApi(RestApi.POST.COLABO2_PUSH_C001,{COLABO_SRNO:a.COLABO_SRNO,COLABO_COMMT_SRNO:a.COLABO_COMMT_SRNO,packetOption:Ajax.OPTION.PREVENT_EXECUTE},function(){Often.toast("success",i18next.t("front.alert.sendMessageToMemers"))})}function t(){$("#confirmationPopup").remove()}function u(a){if(!a||0===+a)return i18next.t("dictionary.none");var b;return b=60>a?i18next.t("front.common.js-minute",{count:a}):1440>a?i18next.t("front.common.js-hour",{count:a/60}):i18next.t("front.common.day",{count:a/1440}),i18next.t("front.common.scheduleReminder",{time:b})}var v,w,x={PG_NO:0,PG_PER_CNT:10,NEXT_YN:"Y",ZERO_FIRST:!0};return{getLookHtml:function(c,d){function e(a){return a&&0!==a.length?JSON.stringify(c.ATTENDENCE_REC).replace(/"/ig,"'"):""}function f(){return d?"":{"place-display":ListHelper.setDisplay(""!==c.PLACE,"table"),"video-display":ListHelper.setDisplay(g),"video-active":g?"d-none":"","alam-display":ListHelper.setDisplay("0"!==c.PRE_ALAM),"memo-display":ListHelper.setDisplay(""!==c.MEMO),"map-display":ListHelper.setDisplay(""!==c.LOCATION,"inline-block"),"attendance-count-display":ListHelper.setDisplay(0!==c.ATTENDENCE_REC.length),"attendance-select-display":ListHelper.setDisplay(a(c.ATTENDENCE_REC).isAttend),"participate-status":"1"===a(c.ATTENDENCE_REC).status?"on":"","absence-status":"2"===a(c.ATTENDENCE_REC).status?"on":"","undetermined-status":"3"===a(c.ATTENDENCE_REC).status?"on":"","map-link":GoogleMap.getGoogleMapLink(c.LOCATION,c.PLACE)}}c||(d=!0),c=c||{};var g=VideoConference.isVC(c.VC_SRNO),h=c.ATTENDENCE_REC&&0<c.ATTENDENCE_REC.length;return ListHelper.replaceJson($("#scheduleComponent").html(),c&&$.extend({},f(),{"attendance-list":e(c.ATTENDENCE_REC),addAttendenceText:i18next.t(h?"front.common.change":"front.common.add",{val:"$t(back.LangConvert.participant)"}),attendance:b(c.ATTENDENCE_REC),VC_SRNO:c.VC_SRNO,"attendance-count":c.ATD_ATTEND_CNT,"nonattendance-count":c.ATD_NONATTEND_CNT,"undefined-count":c.ATD_UNDEFINED_CNT,place:c.PLACE,memo:TagUtil.LinkData2Tag(Often.null2Void(c.MEMO)),"map-image-src":"src=\""+GoogleMap.convertGoogleMapImage(c.LOCATION)+"\"",alarm_time:u(c.PRE_ALAM)}))},initEdit:function(a,b){function g(b){var c=new Date,d=b&&0<b.SCHD_REC.length,e=d&&"Y"===b.SCHD_REC[0].ALL_DAY_YN,f=d?b.SCHD_REC[0].STTG_DTTM:Often.getDateFormat(c,"MINUTES");c.setHours(c.getHours()+1);var g=d?b.SCHD_REC[0].FNSH_DTTM:Often.getDateFormat(c,"MINUTES"),h=Tz.momentConversion("convertOnly","type19",f),i=Tz.momentConversion("convertOnly","type19",g);a.find(".js-start-flatpickr .js-pickr-date").val(h),a.find(".js-start-flatpickr .js-pickr-text").val(Tz.momentConversion("convertOnly",e?"type5":"type6",h)),a.find(".js-end-flatpickr .js-pickr-date").val(i),a.find(".js-end-flatpickr .js-pickr-text").val(Tz.momentConversion("convertOnly",e?"type5":"type6",i))}function h(){var b="VIEW"===a.attr("data-code");a.find(".js-worker-input").css("display",b?"none":"inline-block"),a.find(".js-worker-button").css("display",b?"inline-block":"none"),b||WorkerPopup.addInputWorkerEvent(a,c)}f(a,!0),a.find("#attendanceCount, #videoSpan, #placeSpan, #urlPreview, #alarmSpan").addClass("d-none"),a.find(".add-manager-button, #videoButton, #placeButton,#placeInput, #editDateTimeArea, #alarmButton").removeClass("d-none"),a.find("#placeSpan").css("cursor","default"),a.find("#attendanceSelect").remove(),b&&b.SCHD_REC&&a.find("#videoSpan").attr("data-vc-srno",b.SCHD_REC[0].VC_SRNO),g(),d(a),Often.isFunc(Func.CLOUD.INVITATION_POPUP)&&h(),Often.isFunc(Func.ENTER.GOOGLE_MAP)&&function(){var b=a.find("#placeInput");GoogleMap.addSearchEvent(b,function(c){b.val(c.PLACE),a.find("#LOCATION").val(c.LOCATION),a.find("#mapImage").attr("src",GoogleMap.convertGoogleMapImage(c.LOCATION)),a.find("#placeSpan").fadeIn(200)})}();["memo"].forEach(function(b){PostPopup.initButtonByCode(a,b)});0===Object.keys(b).length||function(){var c=b.SCHD_REC[0],d="Y"===c.ALL_DAY_YN,h=""!==c.LOCATION,i={"#postTitle":c.TTL,"#alarmButton":c.PRE_ALAM,"#LOCATION":c.LOCATION,"#placeInput":c.PLACE};for(var j in a.find("#ondDay").prop("checked",d?"checked":""),f(a,!0),i)a.find(j).val(i[j]);if(g(b),a.find("#memoButton").html(c.MEMO.replace(/\n/ig,"</br>")),a.find("#ondDay").prop("checked",d?"checked":""),c.ATTENDENCE_REC&&0<c.ATTENDENCE_REC.length&&(a.find(".js-attendance-input").attr("data-attendance",JSON.stringify(c.ATTENDENCE_REC)),e(c.ATTENDENCE_REC)),VideoConference.isVC(c.VC_SRNO)){var k=$("#postPopup").find("#videoButton");k.addClass("d-none"),k.next("#videoSpan").removeClass("d-none"),k.next("#videoSpan").find(".remove-button").removeClass("d-none"),k.next("#videoSpan").find("#zoomUrlCopy").addClass("d-none")}h&&(a.find("#mapImage").attr({src:GoogleMap.convertGoogleMapImage(c.LOCATION),onerror:"this.src='"+ImageUtil.removeDomain("GOOGLE-MAP")+"'"}),a.find("#placeInput, #placeSpan").removeClass("d-none"),a.find("#placeButton").addClass("d-none"))}()},keyUpScheduleInput:function(a){var b=$(a.target);(function(a){if(!a.is("#placeInput"))return!1;if(!Often.isFunc(Func.ENTER.GOOGLE_MAP))return Often.toast("error",i18next.t("front.alert.errorTryAgain")),!0;var b=a.nextAll("#placeSpan"),c=b.find("#mapImage");return GoogleMap.checkPlaceInput(a,b,c),!0})(b)||function(a){if(!a.is("#memoButton"))return!1;var b=a.text().length;return!!(1e3>=b)||(Often.toast("error","\uBA54\uBAA8\uB294 1000\uC790 \uAE4C\uC9C0\uB9CC \uC785\uB825\uAC00\uB2A5\uD569\uB2C8\uB2E4."),a.text(a.text().slice(0,1e3)),!0)}(b)},clickScheduleComponent:function(a){var b=$(a.target),c=b.findUp(".js-popup-before"),d=c.find(".js-post-nav").hasClass("schedule");if(d)return w="VIEW"===c.attr("data-code"),i(b)||j(b)||k(b)||g(b)||m(b)||l(b)?void 0:$.isTarget(a,["#zoomUrlCopy","#zoomButton"])?VideoConference.clickZoomComponent(a):void 0},isOnedayButtonAndAction:k,isAttendanceSelectAndAction:m,keyDownCheckPlaceInput:function(a){var b=$(a.target);return!!b.is("#placeInput")&&($("#postPopup").focus(),!0)},keyDownScheduleInput:function(a){var b=$(a.target);(function(b){return!!b.is("#memoButton")&&(KeyCheck.isStyleCommand(a)?(a.preventDefault(),!0):void 0)})(b)},checkSendEditPush:function(){PopupDraw.drawConfirm({contents:{main:i18next.t("front.alert.remindMembers"),submit:i18next.t("dictionary.yes"),cancel:i18next.t("dictionary.no")},callback:{submit:s}})},getAttendanceItemComponentHtml:b,getAttendInfo:a,closeAttendancePopup:t}}();
"use strict";var ItemSubtask=function(){function a(a){z(a.find(".js-subtask-ul"))}function b(a,b){function c(a,b){if(!a)return"";var c=[];return $.each(a,function(a,d){c.push(d[b])}),c.toString()}var d="",e=!Often.null2Void(b);return $.each(a,function(a,b){var f=DetailCode.STATUS._GB[Often.null2Void(b.STTS,"0")],g=i18next.t(DetailCode.STATUS._TEXT[Often.null2Void(b.STTS,"0")]),h=Often.null2Void(DetailCode.PRIORITY._CLASS[b.PRIORITY],""),i=Often.null2Void(b.END_DT,""),j=Often.null2Void(b.REMARK_CNT,"0"),k=Often.null2Void(b.WORKER_REC,[]),l=k.length-1,m="Y"===b.DELETE_YN||b.RGSR_ID===_USER_ID,n=!k||0===k.length,o=!i||""===i,q=!h||""===h,r=!k||0===k.length,s=8<i.length,t=Often.isSameDay(b.END_DT),u=Tz.momentTimeZone(b.END_DT,s?"type6":"type5"),v=t?p(s,b.END_DT):u,w="2"===b.STTS?"finished":"3"===b.STTS?"hold":"";d+=ListHelper.replaceJson($("#subTaskItem").html(),$.extend({},b,{index:b.INDEX?b.INDEX:a,status_code:f,status_text:g,end_dt_text:t?v:Tz.momentTimeZone(i,s?"type6":"type5"),priority_code:h,worker_id_list:c(k,"WORKER_ID"),worker_name_list:c(k,"WORKER_NM"),data_worker_profile_list:c(k,"WORKER_PRFL_PHTG"),thumbnail_image:ListHelper.setProfile(n?"thumbnail":k[l].WORKER_PRFL_PHTG),worker_count:0<k.length?"+"+l:"",worker_count_display:ListHelper.setDisplay(!n&&1<k.length,"inline-block"),date_off:o?"off":"",date_text_display:ListHelper.setDisplay(!o,"inline-block"),priority_off:q?"off":"",priority_icon_display:ListHelper.setDisplay(!q,"inline-block"),worker_off:r?"off":"",worker_icon_display:ListHelper.setDisplay(!r,"inline-block"),remark_display:ListHelper.setDisplay(e&&!(!j||"0"===j),"inline-block"),"mouseover-class":o||t?"js-mouseover":"","mouseover-date":o?i18next.t("front.common.add",{val:"$t(front.common.dueDate)"}):Tz.momentTimeZone(i,s?"type6":"type5"),"mouseover-priority":q?i18next.t("front.common.add",{val:"$t(front.common.priority)"}):i18next.t(DetailCode.PRIORITY._TEXT[b.PRIORITY]),"mouseover-worker":r?i18next.t("front.common.add",{val:"$t(dictionary.manager)"}):k.length+"\uBA85 - "+c(k,"WORKER_NM"),"status-class":w,readonly_yn:e?"readonly":"","dead-line-class":Often.isDeadlineExceeded(i)?"deadline-exceeded":"","del-yn":m?"Y":"N",remove_display:"style=\"display:"+(m?"":"none")+"\" data"}))}),d}function c(a){var b=$(a.target);F=b.closest(".js-popup-before"),I=0<b.closest(".js-subtask-edit-area").length,G="VIEW"===F.attr("data-code"),H="EDIT"===F.attr("data-code"),J=b.closest(".js-subtask-li").attr("task-srno")}function d(a){if(D(E($(a.target)))&&!LimitGuest.isLimitGuest("subtask")){var b=$(a.target).closest(".js-subtask-area");return b.addClass("on"),void b.find(".js-subtask-edit-layer .js-subtask-input").focus()}}function f(a){var b=$(a.target),c=b.closest(".js-subtask-li"),d=0<b.closest(".js-subtask-edit-area").length;if(G&&!d&&c&&0!==c.length){var e=c.attr("data-project-srno"),f=c.attr("data-post-srno");PostPopup.togglePostView(e,f,"",Detail.applySummarySlickImage)}}function g(a){function b(){var a=d.parents(".js-subtask-li"),b=0<a.parents(".js-subtask-edit-layer").length;b||"2"!==j?b||"3"!==j?b?a.attr("class","subtask-input-area js-subtask-li"):a.attr("class","js-subtask-li"):a.attr("class","js-subtask-li hold"):a.attr("class","js-subtask-li finished"),d.find(".js-subtask-status-button").attr({class:"js-subtask-status-button js-task-state subtask-button subtask-status "+k,data_status:j}).text(l)}if(D(E($(a.target)))){var c=$(a.target),d=c.closest(".js-subtask-status-layer"),e=c.closest(".js-subtask-li"),f=c.closest(".js-subtask-status-button"),g=c.closest(".js-status-setting-button"),h=d.find(".js-status-setting-layer"),i=h.is(":visible"),j=g.attr("data_status_code"),k=DetailCode.STATUS._GB[j],l=i18next.t(DetailCode.STATUS._TEXT[j]);if(0<g.length)return void ItemTask.drawUpdateTask({OBJECT:"STTS",TASK_SRNO:J,VALUE:j},b,G&&!I,e);if(B(i?"ALL":"STATUS"),!i){$(".js-status-setting-layer").css("display","none");var m=C(f,h);h.css(m)}}}function h(a){function b(){i(f)}if(D(E($(a.target)))){var c=$(a.target),d=c.closest(".js-subtask-li"),e=c.closest(".js-priority-button:visible"),f=c.closest(".js-priority-setting-button"),g=d.find(".js-priority-setting-layer"),h=f.attr("data_priority_code"),j=g.is(":visible");if(0<f.length)return ItemTask.drawUpdateTask({OBJECT:"PRIORITY",TASK_SRNO:J,VALUE:h},b,G&&!I,d),void B();if(B(j?"ALL":"PRIORITY"),!j){var k=C(e,g);g.css(k),g.find(".js-priority-setting-button:first").focus()}}}function i(a){var b=a.parents(".js-subtask-li"),c=b.find(".js-subtask-priority-layer"),d=a.attr("data_priority_code"),e=DetailCode.PRIORITY._CLASS[d],f=Often.null2Void(e,"lv0"),g="lv0"===f,h=g?i18next.t("front.common.add",{val:"$t(front.common.priority)"}):i18next.t(DetailCode.PRIORITY._TEXT[d]);c.attr({data_priority:d,"mouseover-text":h}),c.find(".js-priority-button").css("display",g?"":"none"),c.find(".js-priority-level").attr({class:"js-priority-level icon-subtask-level js-priority-button "+f}).css("display",g?"none":"inline-block")}function j(a){function b(){if(0===e.attr("data_worker_id_list").length)return[];var a=[],b=e.attr("data_worker_id_list").split(","),c=e.attr("data_worker_name_list").split(","),d=e.attr("data_worker_profile_list").split(",");return $.each(b,function(b,e){a.push({WORKER_ID:e,WORKER_NM:c[b],WORKER_PRFL_PHTG:d[b]})}),a}function c(a){ItemTask.drawUpdateTaskWorker("EDIT",{TASK_SRNO:J,WORKER_REC:a},function(){k(e,a)},G&&!I,g)}if(D(E($(a.target)))){var d=$(a.target),e=d.closest(".js-subtask-worker-layer"),f=$("#workerPopup").is(":visible"),g=d.closest(".js-subtask-li"),h=d.closest(".js-worker-button");B(f?"ALL":"WORKER"),0<h.length&&(!f&&d.closest(".js-subtask-li").addClass("active"),WorkerPopup.toggleWorkerPopup(F,c,h,b))}}function k(a,b){var c=[],d=[],e=[],f=b?b.length-1:0,g="",h=0<b.length;$.each(b,function(a,b){c.push(b.WORKER_ID),d.push(b.WORKER_NM),e.push(b.PRFL_PHTG)}),a.attr({data_worker_id_list:c.toString(),data_worker_name_list:d.toString(),data_worker_profile_list:e.toString(),"mouseover-text":h?i18next.t("front.common.people",{count:b.length})+" - "+d.toString():i18next.t("front.common.add",{val:"$t(dictionary.manager)"})}),h?(g=Often.null2Void(b[f].PRFL_PHTG,b[f].WORKER_PRFL_PHTG),a.find(".js-worker-box").css("display","none"),a.find(".js-worker-thumb").css("display","inline-block"),a.find(".js-thumb-image").css("background-image","url("+Often.null2Void(g,"/flow-renewal/assets/images/profile-default.png")+")"),a.find(".subtask-manager-number").text("+"+f).css("display",1<b.length?"inline-block":"none")):(a.find(".js-worker-box").css("display",""),a.find(".js-worker-thumb").css("display","none"))}function l(a){if(D(E($(a.target)))){var b=$(a.target);B("ALL");var c=b.closest(".js-pickr-layer");c.closest(".js-subtask-li").addClass("active"),o(c)}}function m(a){function b(){var a=c.closest(".js-subtask-ul");d.closest(".js-subtask-li").remove(),r(a)}if(D(E($(a.target)))){var c=$(a.target),d=c.closest(".js-subtask-remove"),e=c.closest(".js-subtask-li"),f="Y"===e.attr("data-del-yn");f||Often.toast("error","\uB2F4\uB2F9\uC790 \uBC0F \uAD00\uB9AC\uC790\uB9CC \uC0AD\uC81C\uD560 \uC218 \uC788\uC2B5\uB2C8\uB2E4."),w(b,{COLABO_SRNO:F.attr("data-project-srno"),COLABO_COMMT_SRNO:F.attr("data-post-srno"),TASK_SRNO:e.attr("task-srno")})}}function n(a){function b(a){s(e,a),r(c),G&&ViewChanger.isPage("task")&&UpdateElements.autoUpdateElem()}var c=$(a.target),d=c.closest(".js-subtask-enter-button"),e=c.closest(".js-subtask-edit-layer"),f=d.closest(".js-subtask-li"),g=Validation.checkInput(f.find(".js-subtask-input"));if(0<Object.keys(g).length)return Often.toast("error",g.errorMessage),void g.errorObj.focus();var h=t(e,!0);v(b,h,c),q(e)}function o(a){function b(){function a(){var a=c.closest(".js-subtask-date-layer"),b=a.find(".js-subtask-date-button"),e=a.find(".js-subtask-date-text"),f=8<d.length,g=Tz.momentTimeZone(d,f?"type6":"type5"),h=Often.isSameDay(d);h?a.addClass("js-mouseover"):a.removeClass("js-mouseover"),a.attr("data_end_dt",d),a.attr("mouseover-text",g),e.css("display","inline-block").text(h?p(f,d):g),b.css("display","none"),DatePicker.checkOverDate(e,d)}g||ItemTask.drawUpdateTask({OBJECT:"END_DT",TASK_SRNO:J,VALUE:d},a,G&&!I,e)}var c,d,e=a.closest(".js-subtask-li"),f=a.closest(".js-subtask-date-layer"),g=!1,h=Tz.roundMomentByMinutes(10),i=h.split(" ")[0],j=h.split(" ")[1];DatePicker.makeFlatPickr({defaultHour:i,defaultMinute:j,dateFormat:"YmdHi00",enableTime:!0,time_24hr:!0,dateVer:!0,minuteIncrement:Often.isFunc(Func.CLOUD.EDIT_TIME_TEXT)?1:10,startDate:f.attr("data_start_dt"),endDate:f.attr("data_end_dt"),inputObj:{end:a},callback:{close:function(e,f,h){c=e,d=f,g=h,a.closest(".js-subtask-li").removeClass("active"),b()},remove:function(b,c){function d(){c.find(".js-subtask-date-text").css("display","none"),c.find(".js-subtask-date-button").css("display","").addClass("off"),c.find(".js-subtask-date-input").val(""),g.attr("data_end_dt","").attr("mouseover-text",""),b.remove(),a.closest(".js-subtask-li").removeClass("active")}var f=b.find(".js-flatpickr-remove-button"),g=c.closest(".js-subtask-date-layer");return""===Often.null2Void(g.attr("data_end_dt"))?void f.css("display","none"):void f.off("click").on("click",function(){ItemTask.drawUpdateTask({OBJECT:"END_DT",TASK_SRNO:J,VALUE:""},d,G&&!I,e)})}}})}function p(a,b){return i18next.t("dictionary.today")+(a?" "+Tz.momentTimeZone(b,"type20"):"")}function q(a){a.empty(),a.append($("#subtaskInputItem").html()),a.find(".js-subtask-input").focus()}function r(a){var b=a.closest(".js-subtask-area"),c=b.find(".js-subtask-ul>li");b.find(".js-subtask-count").text(c.length)}function s(a,c){var d=a.prev(".js-subtask-ul"),e=d.find(".js-subtask-li").length;0<e&&(c[0].INDEX=e);var f=$(b(c,!G));d.append(f)}function t(a,b){var c=[],d=Often.null2Void(b)?".js-subtask-edit-area":".js-subtask-area",e=a.find(d),f=e.find(".js-subtask-li"),g=PostCondition.getPopupMode(a);return $.each(f,function(a,b){var d=$(b);if(!("VIEW"===g&&d.hasClass("subtask-input-area"))){var e=u(d);"SHARE_POST"===g&&Often.isFunc(Func.CLOUD.COPY_SUBTASK_CONTENTS)&&$.extend(e,{COLABO_SRNO:d.attr("data-project-srno"),COLABO_COMMT_SRNO:d.attr("data-post-srno")}),0<Object.keys(Often.null2Void(e)).length&&c.push(e)}}),c}function u(a){var b=0<a.closest(".js-subtask-edit-area").length,c=$.trim(a.find(".js-subtask-input").val()||a.find(".js-subtask-input").text()),d=a.find(".js-subtask-date-layer"),e=d.attr("data_start_dt"),f=d.attr("data_end_dt"),g=a.find(".js-subtask-status-button").attr("data_status"),h=Often.null2Void(a.attr("data-progress"),"0"),i=a.find(".js-subtask-priority-layer").attr("data_priority"),j=a.find(".js-subtask-worker-layer:visible"),k=function(a){var b=[];if(0===a.length)return b;if(""===a.attr("data_worker_id_list"))return b;var c=a.attr("data_worker_id_list").split(","),d=a.attr("data_worker_name_list").split(","),e=a.attr("data_worker_profile_list").split(",");return $.each(c,function(a,c){b.push({WORKER_ID:c,WORKER_NM:d[a],WORKER_PRFL_PHTG:e[a]})}),b}(j),l=Often.null2Void(a.attr("task-srno")),m=""!==l;return b&&""===c?{}:{TASK_NM:c,START_DT:e,END_DT:f,STTS:g,PRIORITY:i,PROGRESS:h,WORKER_REC:k,GUBUN:"",TASK_SRNO:l,MODIFY_YN:m?"Y":"N",RGSR_NM:m?"":_USER_NM,RGSR_ID:m?"":_USER_ID}}function v(a,b){return G?void x(a,{COLABO_SRNO:F.attr("data-project-srno"),COLABO_COMMT_SRNO:F.attr("data-post-srno"),SUBTASK_REC:b}):a(b)}function w(a,b){return G||I?void PopupDraw.drawConfirm({contents:{main:i18next.t("front.common.ask",{val:"$t(dictionary.subTask)",status:"$t(dictionary.delete)"})},callback:{submit:function(){y(a,b)}}}):a()}function x(a,b){Ajax.executeApi(RestApi.POST.FLOW_SUBTASK_C001,$.extend({packetOption:Ajax.OPTION.PREVENT_EXECUTE},b),function(c){var d=[$.extend(b.SUBTASK_REC[0],{COLABO_SRNO:b.COLABO_SRNO,COLABO_COMMT_SRNO:c.COLABO_COMMT_SRNO,TASK_SRNO:c.TASK_SRNO})];a(d)})}function y(a,b){Ajax.executeApi(RestApi.DELETE.FLOW_SUBTASK_D001,$.extend({},b),function(){a()})}function z(a){$.each(a,function(a,b){var c,d=$(b).hasClass("ui-sortable");d&&$(b).sortable({handle:".drag-button",cursorAt:{top:5,left:5},scroll:!1,tolerance:"pointer",placeholder:"document-item-highlight",opacity:.6,start:function start(){$(b).sortable("refreshPositions")},helper:function helper(a,b){B("ALL");var d=b.clone();$(d).css("opacity","0.3"),c=d.insertAfter(b);var e=$(b);return e.hasClass("file-item")||e.css("transform","scale(0.5) translate(-50%, -50%)"),e.css("display","inline-block"),b.clone()},stop:function stop(a,d){var e=$(d.item),f=e.closest(".js-popup-before");e.hasClass("file-item")||e.css("transform",""),e.css("display","block"),c&&c.remove();var g=[],h="VIEW"===f.attr("data-code");(function(){var a=$(b).find(".js-subtask-li");$.each(a,function(a,b){$(b).attr("index")!==a&&(g.push({TASK_SRNO:$(b).attr("task-srno"),OTPT_SQNC:a+1}),$(b).attr("index",a))})})(),h&&function(){Ajax.executeApi(RestApi.PUT.FLOW_SUBTASK_U001,{COLABO_SRNO:f.attr("data-project-srno"),COLABO_COMMT_SRNO:f.attr("data-post-srno"),TASK_REC:g,packetOption:Ajax.OPTION.PREVENT_EXECUTE},function(){Often.toast("info","\uD558\uC704 \uC5C5\uBB34 \uC21C\uC11C\uB97C \uBCC0\uACBD\uD588\uC2B5\uB2C8\uB2E4.")})}()}})})}function A(a){var b=a.find(".js-subtask-area"),c=0===b.length;if(c)return!0;var d=b.find(".js-subtask-edit-layer"),e=0===b.find(".js-subtask-ul .js-subtask-li").length,f=0===$.trim(d.find(".js-subtask-input").val()).length,g="0"===d.find(".js-subtask-status-button").attr("data_status"),h=""===d.find(".js-subtask-date-layer").attr("data_end_dt"),i=""===d.find(".js-subtask-priority-layer").attr("data_priority"),j=""===d.find(".js-subtask-worker-layer").attr("data_worker_id_list");return c||e&&f&&g&&h&&i&&j}function B(a){var b=Often.null2Void(a,"ALL");$(".js-subtask-li.active").removeClass("active"),("ALL"===b||"STATUS"!==b)&&$(".js-subtask-li .js-status-setting-layer").css("display","none"),("ALL"===b||"PRIORITY"!==b)&&$(".js-subtask-li .js-priority-setting-layer").css("display","none"),("ALL"===b||"WORKER"!==b)&&$(".js-subtask-li .js-worker-layer").remove()}function C(a,b){if(!a||0===a.length)return!1;var c=a.closest("#postPopup"),d=0<c.length,e=a.parents(".js-popup-before"),f=a.closest(".js-subtask-layer"),g=e.offset(),h=f.offset(),i=f.position(),j=window.innerHeight,k=g.top+e.height(),l=0<d?80:100,m=a.outerHeight(),n=b.outerHeight(),o=(d?k:j)-l<h.top+m+150;return a.closest(".js-subtask-li").addClass("active"),{display:b.is(":visible")?"none":"block",top:o?+("-"+(m+n))+25:m+20,left:i.left+(SpaceSelectable.isSharePost(c)?-20:0)}}function D(a){return!!(a===_USER_ID||Authority.isAuthorityCheck("WRITE")||H)||(Often.toast("error","\uAD00\uB9AC\uC790\uB9CC \uAE00/\uB313\uAE00 \uC791\uC131 \uAC00\uB2A5\uD55C \uAC8C\uC2DC\uBB3C\uC785\uB2C8\uB2E4."),!1)}function E(a){return Often.null2Void(a.closest(".detail-item").attr("data-rgsr-id"))}var F,G,H,I,J;return{clickSubtaskComponent:function(a){return c(a),$.isTarget(a,".js-subtask-enter-button")?n(a):$.isTarget(a,".js-subtask-status-layer")?g(a):$.isTarget(a,".js-add-subtask-button")?d(a):$.isTarget(a,".js-subtask-date-layer")?l(a):$.isTarget(a,[".js-priority-button:visible",".js-priority-setting-button"])?h(a):$.isTarget(a,".js-subtask-worker-layer")?j(a):$.isTarget(a,".js-subtask-remove")?m(a):$.isTarget(a,".js-subtask-li")?f(a):void 0},initEdit:a,initEditSubtask:q,getLookHtml:function(a){var c;return a&&0<a.length&&(c=a.length),Often.isFunc("SUB_TASK")?ListHelper.replaceJson($("#subTaskAreaItem").html(),{subtask_count:c,SUBTASK_LIST:b(a),EDIT_LAYER:$("#subtaskInputItem").html()}):""},getCompHtml:b,drawSubtaskLi:s,makeSubtaskRecord:t,makePriorityHtml:i,getSubtaskJson:u,addAndDrawSubtask:v,getSubtaskCount:r,isSubtask:function(a){return a&&a.UP_LINK_TASK_REC&&0<a.UP_LINK_TASK_REC.length},isEmptySubtaskArea:A,isSubtaskInputFocus:function(a){var b=$(a.target),c=b.closest(".js-subtask-input");if(c&&0<c.length)return!0},closeSubtaskPopup:B,getTodayTime:p,setSubtaskWorker:k,setSubtaskRemarkCount:function(a,b){var c=$("#subtask-"+a);0===c.length||"0"===Often.null2Void(b,"0")||(c.find(".subtask-comment").css("display","inline-block"),c.find(".js-subtask-remark-count").text(b))}}}();
"use strict";var ItemTask=function(){function a(a){x=$(a.target).closest(".js-popup-before");var b=x.find(".js-post-nav").hasClass("task");if(b)return u="VIEW"===x.attr("data-code"),v="EDIT"===x.attr("data-code"),w=x.find(".task-number").attr("data-task"),$.isTarget(a,".js-stts")?i(a):$.isTarget(a,".js-task-worker-layer")?k(a):$.isTarget(a,".js-more-button")?m(a):$.isTarget(a,".js-date-layer")?l(a):$.isTarget(a,".js-priority-layer")?n(a):$.isTarget(a,".js-progress-button")?j(a):void 0}function b(){for(var a="",b=0;10>=b;b++)a+="<span class=\"js-progress-button\" data-progress-value=\""+10*b+"\"><em>"+10*b+"%</em></span>";return a}function c(a){for(var b="",c=0;c<a.length;c++){var d=a[c],e=$("#taskSelectedWorkerItem").html(),f=d.WORKER_PRFL_PHTG?d.WORKER_PRFL_PHTG:d.PRFL_PHTG;b+=ListHelper.replaceJson(e,$.extend({WORKER_PRFL_PHTG:f,profile:ListHelper.setProfile(f)},d))}return b}function d(a,b){var d="VIEW"===a.attr("data-code");b.find(".js-worker-input").css("display",d?"none":"inline-block"),b.find(".js-worker-button").css("display",d?"inline-block":"none"),d||WorkerPopup.addInputWorkerEvent(a,function(a){var d=b.find(".js-workers"),e=!1;return $.each(d.find(".js-registration"),function(b,c){if($(c).attr("data-worker-id")===a[0].WORKER_ID)return e=!0,!1}),e?Often.toast("error","\uC774\uBBF8 \uB4F1\uB85D\uB41C \uCC38\uC5EC\uC790\uC785\uB2C8\uB2E4."):void d.append(c(a))})}function f(){function a(){function a(){var a=b.closest(".js-pickr-layer"),d=a.find(".js-date-label"),f=a.find(".js-pickr-date"),g=a.find(".js-pickr-text"),h=a.find(".js-date-back-layer"),i=a.find(".js-remove-date"),j=8<c.length;f.val(c),d.css("display","none"),h.css("display","block"),i.css("display","inline-block");var k=Tz.momentConversion("convertOnly",j?"type6":"type5",c);g.text(i18next.t("front.common."+(e?"from":"to"),{val:k})).css("display","inline-block"),DatePicker.checkOverDate(g,c)}if(!d){var e=b.hasClass("js-start-flatpickr");h({OBJECT:e?"START_DT":"END_DT",TASK_SRNO:w,VALUE:c},a,u,x)}}var b,c,d=!1,e=Tz.roundMomentByMinutes(10),f=e.split(" ")[0],g=e.split(" ")[1],i=x.find(".js-task-option:visible");DatePicker.makeFlatPickr({defaultHour:f,defaultMinute:g,dateFormat:"YmdHi00",startDate:i.find(".js-start-flatpickr .js-pickr-date").val(),endDate:i.find(".js-end-flatpickr .js-pickr-date").val(),inputObj:{start:i.find(".js-start-flatpickr"),end:i.find(".js-end-flatpickr")},callback:{close:function(e,f,g){b=e,c=f,d=g,a()}},enableTime:!0,time_24hr:!0,dateVer:!0,minuteIncrement:Often.isFunc(Func.CLOUD.EDIT_TIME_TEXT)?1:10})}function g(a,b,c,d,e){var f={EDIT:i18next.t("front.common.ask",{val:"$t(dictionary.manager)",status:"$t(dictionary.edit)"}),DELETE:i18next.t("front.common.ask",{val:"$t(dictionary.manager)",status:"$t(dictionary.delete)"})};return d?void PopupDraw.drawConfirm({contents:{main:f[a]},callback:{submit:function(){p(c,b,e)}}}):c()}function h(a,b,c,d,e){function f(){var c=d?d:x,e=c.attr("data-project-srno"),f=c.attr("data-post-srno"),g=c.find(".remark-item:last").attr("remark-srno");Ajax.executeApi(RenewalApi.GET.ACT_ONE_TASK_STATE,{COLABO_SRNO:e,COLABO_COMMT_SRNO:f,OBJECT:a.OBJECT,VALUE:a.VALUE},function(c){if("Y"===Often.null2Void(c.RETURN_MSG,"N"))q(b,a,d);else{b(),r(e,f,g);""===Often.null2Void(a.VALUE)?Often.toast("info","\uC774\uBBF8 \uC0AD\uC81C\uB418\uC5C8\uC2B5\uB2C8\uB2E4."):Often.toast("info","\uC774\uBBF8 \uB3D9\uC77C\uD55C "+{STTS:"\uC0C1\uD0DC",START_DT:"\uC2DC\uC791\uC77C",END_DT:"\uB9C8\uAC10\uC77C",PRIORITY:"\uC6B0\uC120\uC21C\uC704",PROGRESS:"\uC9C4\uCC99\uB3C4"}[a.OBJECT]+" \uB85C \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")}})}var g={STTS:i18next.t("front.common.ask",{val:"$t(dictionary.status)",status:"$t(dictionary.change)"}),PRIORITY:i18next.t("front.common.ask",{val:"$t(front.common.priority)",status:"$t(dictionary.change)"}),START_DT:i18next.t("front.common.ask",{val:"$t(front.common.startDate)",status:e?"$t(dictionary.delete)":"$t(dictionary.change)"}),END_DT:i18next.t("front.common.ask",{val:"$t(front.common.dueDate)",status:e?"$t(dictionary.delete)":"$t(dictionary.change)"})};return-1<a.OBJECT.indexOf("_REMOVE")&&(a.OBJECT=a.OBJECT.replace("_REMOVE","")),c?"PROGRESS"===a.OBJECT?f():void PopupDraw.drawConfirm({contents:{main:g[a.OBJECT]},callback:{submit:f}}):b()}function i(a){function b(){var a=c.parents(".js-task-state");if(a.attr("class","").addClass("js-task-state state-button-group clearfix "+d.attr("stts")),a.attr("data-status",d.attr("stts")),f===taskStatusCode.COMPLETION&&"VIEW"===PostCondition.getPopupMode(x)){var b=c.closest(".js-task-option"),e=b.find(".js-progress-layer"),g=e.find(".js-progress-bar"),h=e.find(".js-progress-text");e.css("display","table").addClass("on"),g.css("width","100%").attr("data-progress","100"),h.text("100%")}}var c=$(a.target),d=c.closest(".js-stts");if(s(t(c))){var e=d.parents(".js-task-state").attr("data-status")===d.attr("stts");if(!e){var f=DetailCode.STATUS._GB.indexOf(d.attr("stts"));h({OBJECT:"STTS",TASK_SRNO:w,VALUE:f},b,u)}}}function j(a){var b=$(a.target),c=b.closest(".js-progress-button");if(!s(t(b)))return!0;var d=c.parents(".js-progress").find(".js-progress-bar").attr("data-progress")===c.attr("data-progress-value");if(d)return!1;var e=c.attr("data-progress-value");return h({OBJECT:"PROGRESS",TASK_SRNO:w,VALUE:e},function(){var a=b.closest(".js-progress-layer"),c=$.trim(b.text());a.find(".js-progress-bar").css("width",c),a.find(".js-progress-bar").attr("data-progress",c.replace("%","")),a.find(".js-progress-text").text(c),"100%"===c?a.addClass("on"):a.removeClass("on"),"VIEW"===b.closest(".js-popup-before").attr("data-code")&&Often.toast("success","\uC9C4\uCC99\uB3C4\uAC00 \uBCC0\uACBD\uB418\uC5C8\uC2B5\uB2C8\uB2E4.")},u),!0}function k(a){function b(){m.parents(".js-registration").remove()}function d(a){var b=!1,d=o(h);a.length===d.length?$.each(a,function(a,c){if(c.WORKER_ID!==d[a].WORKER_ID)return b=!0,!1}):b=!0;b&&g("EDIT",{TASK_SRNO:w,WORKER_REC:a},function(){h.find(".js-registration").remove(),h.find(".js-workers").append(c(a))},u,x)}function e(){return o(x)}var f=$(a.target),h=f.closest(".js-task-worker-layer");if(s(t(f))){var i=f.closest(".js-worker-button"),j=x.attr("data-post-srno"),k=0<i.length&&!!j,l=x.find(".remark-item:last").attr("remark-srno");if(k&&Often.isFunc("INVITATION_POPUP"))return void InvitationPopup.openManagerPopup(x.attr("data-post-srno"),w,l);if(0<i.length||k&&!Often.isFunc("INVITATION_POPUP"))return void WorkerPopup.toggleWorkerPopup(x,d,i,e);var m=f.closest(".js-remove-worker");if(0<m.length){var n=m.parents(".js-registration").attr("data-worker-id");return void g("DELETE",{TASK_SRNO:w,WORKER_REC:o(x,n)},b,u,f.closest(".detail-item"))}var p=f.closest(".js-registration");if(0<p.length){var q=p.attr("data-worker-id");return void Profile.drawProfilePopup(q)}}}function l(a){var b=$(a.target),c=b.closest(".js-date-layer");if(!s(t(b)))return!0;var d=b.closest(".js-pickr-layer"),e=d.hasClass("js-start-flatpickr"),g=b.closest(".js-remove-date");return 0<g.length?(a.stopPropagation(),a.preventDefault(),void h({OBJECT:e?"START_DT":"END_DT",TASK_SRNO:w,VALUE:""},function(){var a=g.parents(".js-date-option");a.find(".js-date-text").text(""),a.find(".js-date-label input").val(""),a.find(".js-pickr-text").css("display","none"),a.find(".js-date-label ").css("display","block"),a.find(".js-date-back-layer").css("display","none"),g.css("display","none"),a.find(".js-date-label").css("z-index","0").css("position","")},u,"",!0)):(0<d.length&&f(),!0)}function m(a){var b=$(a.target),c=b.closest(".js-more-button");if(!s(t(b)))return!0;var d=c.parents(".js-task-option"),e=d.parents("#summaryPost:visible");return"400px"===e.css("max-height")&&e.css("max-height","548px"),c.css("display","none"),d.find(".js-more-task-li").css("display","table"),d.find(".js-date-layer").css("display","table"),!0}function n(a){function b(){var a=i.text(),b=i.attr("data-priority-code"),c=i.find("i:first").attr("class");d.find(".js-priority").attr("data-priority",DetailCode.PRIORITY._GB.indexOf(b)),d.find(".js-priority-text").text(a),d.find("#prioritySpan i:first").attr("class",c),d.find("#prioritySpan").css("display","inline-block"),d.find("#priorityButton").css("display","none"),g.css("display","none")}var c=$(a.target),d=c.closest(".js-priority-layer");if(!s(t(c)))return!0;var e=d.parents(".js-task-option"),f=d.find(".js-priority"),g=e.find(".js-priority-setting-layer"),i=c.closest(".js-priority-setting-button"),j=c.closest(".js-remove-priority"),k=c.closest(".js-priority-button"),l=c.closest("#prioritySpan"),m=i.attr("data-priority-code");if(0<i.length){var n=DetailCode.PRIORITY._GB.indexOf(m)===+Often.null2Void(f.attr("data-priority"),"-1");return n?g.css("display","none"):h({OBJECT:"PRIORITY",TASK_SRNO:w,VALUE:DetailCode.PRIORITY._GB.indexOf(m)},b,u),!0}if(0<j.length)return h({OBJECT:"PRIORITY",TASK_SRNO:w,VALUE:""},function(){f.attr("data-priority",""),d.find("#prioritySpan").css("display","none"),d.find("#priorityButton").css("display","block"),g.css("display","none")},u),!0;if(0<k.length||0<l.length){var o=g.is(":visible");return g.css("display",o?"none":"block"),!0}}function o(a,b){var c=[];return a.find(".js-registration:visible").each(function(a,d){var e=$(d).attr("data-worker-id"),f=$(d).attr("data-worker-name"),g=$(d).attr("data-worker-profile");e&&e===b||c.push({WORKER_ID:e,WORKER_NM:f,WORKER_PRFL_PHTG:g})}),c}function p(a,b,c){Ajax.executeApi(RestApi.PUT.FLOW_TASK_WORKER_U002,$.extend({},b),function(){"function"==typeof a&&a();var d=c?c:x,e=d.attr("data-project-srno"),f=d.attr("data-post-srno"),g=d.find(".remark-item:last").attr("remark-srno");console.log(g),r(e,f,g);var h={OBJECT:"WORKER",WORKER_REC:b.WORKER_REC};UpdateElements.autoUpdateElem({PROJECT_SRNO:e,POST_SRNO:f,TASK_DATA:h})})}function q(a,b,c){Ajax.executeApi(RestApi.PUT.COLABO2_TASK_U001,$.extend({},b),function(){"function"==typeof a&&a();var d=c?c:x,e=d.attr("data-project-srno"),f=d.attr("data-post-srno"),g=d.find(".remark-item:last").attr("remark-srno"),h="PROGRESS"===b.OBJECT;h||r(e,f,g),UpdateElements.autoUpdateElem({PROJECT_SRNO:e,POST_SRNO:f,TASK_DATA:b}),"STTS"===b.OBJECT&&2===b.VALUE&&q("",{OBJECT:"PROGRESS",TASK_SRNO:b.TASK_SRNO,VALUE:"100"})})}function r(a,b,c){UpdateElements.autoUpdateElem({PROJECT_SRNO:a,POST_SRNO:b,REMARK_SRNO:c,REMARK_UPDATE:!0})}function s(a){return!!(a===_USER_ID||Authority.isAuthorityCheck("WRITE")||v)||(Often.toast("error","\uAD00\uB9AC\uC790\uB9CC \uAE00/\uB313\uAE00 \uC791\uC131 \uAC00\uB2A5\uD55C \uAC8C\uC2DC\uBB3C\uC785\uB2C8\uB2E4."),!1)}function t(a){return Often.null2Void(a.closest(".detail-item").attr("data-rgsr-id"))}var u,v,w,x;return{clickTaskComponent:a,getLookHtml:function(a,d){a||(d=!0),a=a||{};var e=Often.null2Void(a.STTS,"0"),f=Often.null2Void(a.PRIORITY,""),g=Often.null2Void(a.PROGRESS,"0"),h=d?"":Often.null2Void(a.START_DT,""),i=d?"":Often.null2Void(a.END_DT,""),j=0<h.length,k=0<i.length,l=a&&a.WORKER_REC&&0<a.WORKER_REC.length?a.WORKER_REC:[],m=8<h.length,n=8<i.length,o="0"===e&&0<f.length&&0<+g&&j&&k&&0<l.length,p=Tz.momentConversion("convertOnly",m?"type6":"type5",h),q=Tz.momentConversion("convertOnly",n?"type6":"type5",i);return ListHelper.replaceJson($("#taskComponent").html(),{"status-code":DetailCode.STATUS._GB[e],"start-date":j?i18next.t("front.common.from",{val:p}):"","end-date":k?i18next.t("front.common.to",{val:q}):"","platpickr-start-date":h,"platpickr-end-date":i,"priority-code":Often.null2Void(f,""),"priority-gb":DetailCode.PRIORITY._GB[f],"priority-text":i18next.t(DetailCode.PRIORITY._TEXT[f]),progress:b(g),"progress-code":g,"progress-width":"style=\"width:"+g+"%\"","progress-class":"100"===g?"on":"",workers:c(l),"data-worker-layer-display":ListHelper.setDisplay(d||0<l.length,"table"),"date-layer-display":ListHelper.setDisplay(j||k,"table"),"start-date-button-display":ListHelper.setDisplay(!j,"inline-block"),"start-date-text-display":ListHelper.setDisplay(j,"inline-block"),"end-date-button-display":ListHelper.setDisplay(!k,"inline-block"),"end-date-text-display":ListHelper.setDisplay(k,"inline-block"),"priority-display":ListHelper.setDisplay(""!==f,"table"),"priority-button-display":ListHelper.setDisplay(""===f,"inline-block"),"priority-text-display":ListHelper.setDisplay(""!==f,"inline-block"),"more-button-display":ListHelper.setDisplay(!o,"block"),"progress-display":ListHelper.setDisplay("0"!==g,"table"),"dead-line-class":Often.isDeadlineExceeded(i)?"deadline-exceeded":"","manager-text":i18next.t(0<l.length?"front.common.change":"front.common.add",{val:"$t(dictionary.manager)"})})},getWorkersComponentHtml:c,makeTaskJson:function(a){var b={},c=a.find(".js-post-title:visible").is("textarea")||a.find(".js-post-title:visible").is("input"),d=c?a.find(".js-post-title:visible").val():a.find(".js-post-title:visible").text(),e=a.find(".js-task-option:visible");return b.TASK_NM=Often.null2Void($.trim(d)),b.STTS=TaskCode.OPTION._GB.indexOf(Often.null2Void(e.find(".js-task-state:visible").attr("data-status"),"request")),b.WORKER_REC=Often.null2Void(o(a),[]),b.START_DT=Often.null2Void($.trim(e.find(".js-start-flatpickr .js-pickr-date").val()),""),b.END_DT=Often.null2Void($.trim(e.find(".js-end-flatpickr .js-pickr-date").val()),""),b.PROGRESS=Often.null2Void($.trim(e.find(".js-progress-bar:visible").attr("data-progress"))),b.PRIORITY=Often.null2Void($.trim(e.find(".js-priority:visible").attr("data-priority")),""),[b]},getWorkerCountJson:function(a){var b=Often.null2Void(a,[]),c=0<b.length?b[0].WORKER_NM:"-",d=1<b.length?"\uC678 "+(b.length-1)+"\uBA85":"";return{WORKER:c,WORKER_COUNT:d}},initEdit:function(a){["startDate","endDate","priority"].forEach(function(b){PostPopup.initButtonByCode(a,b)});var b=a.find(".js-task-option:visible"),c=a.find(".js-more-button"),e=0===$.trim(b.find(".js-start-flatpickr .js-pickr-text").text()).length,f=b.find(".js-start-date-layer");f.css("display",e?"none":"table");var g=0===$.trim(b.find(".js-end-flatpickr .js-pickr-text").text()).length,h=b.find(".js-end-date-layer");h.css("display",g?"none":"table");var i=""===b.find(".js-priority").attr("data-priority");b.find(".js-priority-layer").css("display",i?"none":"table");var j="0"===b.find(".js-progress-bar").attr("data-progress");b.find(".js-progress-layer").css("display",j?"none":"table");var k=b.find(".js-task-worker-layer"),l="ADD"===PostCondition.getPopupMode(a),m=l||0<k.find(".js-registration").length;k.css("display",m?"table":"none"),e||g||i||j||!m||c.css("display","none"),Often.isFunc(Func.CLOUD.INVITATION_POPUP)&&d(a,b)},getWorkerListText:function(a){if(!a)return"";var b="",c=a.length-1;return $.each(a,function(a,d){b+=d.WORKER_NM,c>a&&(b+=", ")}),b},drawUpdateTask:h,drawUpdateTaskWorker:g,changeTaskViewByData:function(a,b){var c=a.find(".js-task-option:visible");if(0<b.STTS.length&&c.find(".js-task-state").attr({"data-status":DetailCode.STATUS._GB[b.STTS],class:"js-task-state state-button-group clearfix "+DetailCode.STATUS._GB[b.STTS]}),!SpaceSelectable.isSharePost(a)&&0<b.WORKER_REC.length&&c.find(".js-workers").append(ItemTask.getWorkersComponentHtml(b.WORKER_REC)),0<b.START_DT.length){var d=8<b.START_DT.length,e=Tz.momentTimeZone(b.START_DT,d?"type6":"type5");c.find(".js-start-flatpickr .js-pickr-date").val(b.START_DT),c.find(".js-start-flatpickr .js-date-label").css("display","none"),c.find(".js-start-flatpickr .js-date-text").text(i18next.t("front.common.from",{val:e})),c.find(".js-start-flatpickr .js-date-back-layer").css("display","inline-block"),c.find(".js-start-flatpickr .js-remove-date").css("display","inline-block")}if(0<b.END_DT.length){var f=8<b.END_DT.length,g=Tz.momentTimeZone(b.END_DT,f?"type6":"type5");c.find(".js-end-flatpickr .js-pickr-date").val(b.END_DT),c.find(".js-end-flatpickr .js-date-label").css("display","none"),c.find(".js-end-flatpickr .js-date-text").text(i18next.t("front.common.to",{val:g})),c.find(".js-end-flatpickr .js-date-back-layer").css("display","inline-block"),c.find(".js-end-flatpickr .js-remove-date").css("display","inline-block")}0<b.PRIORITY.length&&(c.find(".js-priority").attr("data-priority",b.PRIORITY),c.find("#prioritySpan i:first").attr("class","icons-"+DetailCode.PRIORITY._GB[b.PRIORITY]+" small"),c.find(".js-priority-text").text(i18next.t(DetailCode.PRIORITY._TEXT[b.PRIORITY]))),0<b.PROGRESS.length&&(c.find(".js-progress-layer").addClass("100"===b.PROGRESS?"on":""),c.find(".js-progress-bar").attr("data-progress",b.PROGRESS),c.find(".js-progress-bar").css("width",b.PROGRESS+"%"),c.find(".js-progress-text").text(b.PROGRESS+"%"))}}}();
"use strict";var ItemTodo=function(){function a(){var a,b=$("#postPopup").find("#todoEditUl");b.sortable({handle:".drag-button",item:"li",containment:b,axis:"y",cursorAt:{top:5,left:5},scroll:!1,plugins:[new confirmDatePlugin({confirmText:i18next.t("dictionary.select"),showAlways:!0})],tolerance:"pointer",placeholder:"document-item-highlight",opacity:.6,start:function start(){b.sortable("refreshPositions")},stop:function stop(b,c){var d=$(c.item);d.css("transform","scale(1)"),d.css("display",""),a&&a.remove()},helper:function helper(b,c){var d=c.clone();$(d).css("opacity","0.3"),a=d.insertAfter(c);var e=$(c);return e.find(),e.css("transform","scale(0.8) translate(-10%, -10%)"),e.css("display",""),c.clone()}})}function b(a){if(t=KeyCheck.isKey(a,"TAB"),!!t){var b=$(a.target),c=b.closest("#postTitle");if(0!==c.length){t=!1;var d=c.closest("#postPopup"),e=d.find("#todoEditUl .todo-item");0<e.length?$(e[0]).find(".todoContents").focus():d.find("#todoContent").focus()}else;a.preventDefault()}}function c(a){var b=$(a.target),c=b.closest(".js-worker-button"),d=b.closest(".todo-menu"),e="SHARE_POST"===$("#postPopup").attr("data-code");if(e)return Often.toast("error","\uB2E4\uB978 \uD504\uB85C\uC81D\uD2B8 \uC62C\uB9AC\uAE30 \uC911\uC5D0\uB294 \uB2F4\uB2F9\uC790 \uC120\uD0DD\uC774 \uBD88\uAC00\uB2A5\uD569\uB2C8\uB2E4.");var f=b.closest(".js-popup-before");WorkerPopup.toggleWorkerPopup(f,function(a){0===a.length||c.hasClass("js-registration")||c.css("display","none"),0<d.find("#participantData").length&&d.find("#participantData").remove(),d.append(n($("#participantData"),0===a.length?"":a[0],"ADD")),0===a.length&&d.find("#todoWorkerButton").css("display","inline-block")},c)}function d(a){Profile.drawProfilePopup($(a.target).attr("data-worker-id"))}function f(a){var b=$(a.target),c=b.closest(".js-popup-before"),d=b.closest(".js-todo-checkbox"),e=d.closest("#originalPost"),f=e.find("#todoRgsrInfo").attr("rgsr-id"),g=c.attr("mngr-wryn"),h=c.attr("mngr-dsnc"),i=_USER_ID===f||"N"===g||"Y"===h,j=b.closest(".todo-area"),k=j.parent().attr("todo-list-srno"),l=j.parent().attr("todo-srno"),m=j.hasClass("checked");return i?void(m?(j.removeClass("checked"),Often.isDeadlineExceeded(j.find("#todoDateSpan").attr("select-date"))?j.find("#todoDateSpan").addClass("deadline-exceeded"):""):(j.addClass("checked"),Often.isDeadlineExceeded(j.find("#todoDateSpan").attr("select-date"))?j.find("#todoDateSpan").removeClass("deadline-exceeded"):""),o(k,l,m,e.closest(".detail-item"))):Often.toast("error",i18next.t("front.detail.adminWriteOnly"))}function g(a){var b=$(a.target),c=b.closest(".js-pickr-layer");q(c)}function h(a){var b=$(a.target),c=$("#postPopup"),d=$.trim(b.val()),e=Validation.checkInput(b);return 0<Object.keys(e).length&&t?(Often.toast("error",e.errorMessage),void e.errorObj.focus()):void((KeyCheck.isKey(a,"ENTER")||t)&&(clearTimeout(s),s=setTimeout(function(){if(t=!1,""===d)return Often.toast("error",i18next.t("front.alert.enterWord",{val:"$t(dictionary.todo)"}));var a="newTodo"===b.attr("data-gubun"),e=a?c.find(".js-todo-edit-layer"):b.closest(".js-todo-edit-layer"),f=m(e.find(".todo-menu"),a?e.find(".js-todo-content-input").val():d),g=b.parents(".js-content-area").find("#todoEditUl");g.append(f),r(c),i(),a||(b.val(""),clearTimeout(s))},100)))}function i(){var a=$("#postPopup").find(".js-content-area #todoEditUl"),b=a.find("li").eq(-1);b.find(".form-control").remove()}function j(a){if(!a)return{};var b=a.length,c=0;return a.forEach(function(a){"Y"===a.STTS&&c++}),{PERCENT:parseInt(100*(c/b)),CHECKED_LENGTH:c,TOTAL_LENGTH:b}}function k(a){var b=$("#todoRgsrComponent").html(),c="";return c+=ListHelper.replaceJson(b,{"rgsr-id":a.RGSR_ID,"self-yn":a.SELF_YN,"mngr-wr-yn":a.MNGR_WR_YN,"mngr-dsnc":a.MNGR_DSNC}),c}function l(a){var b=$("#todoItemComponent").html(),c="";return a.forEach(function(a){var d=""!==Often.null2Void(a.PRFL_PHTG,""),e=8===Often.null2Void(a.RQST_DTTM,"").length,f="Y"===a.STTS;c+=ListHelper.replaceJson(b,{"contents-value":a.TODO_CNTN,contents:TagUtil.LinkData2Tag(Often.null2Void(a.TODO_CNTN)),"todo-list-srno":a.COLABO_TODO_LIST_SRNO,"todo-srno":a.COLABO_TODO_SRNO,checked:f?"checked":"",profile:d?ListHelper.setProfile(a.PRFL_PHTG):"d-none","req-time":e?p(a.RQST_DTTM):"","todo-menu":n($("#todoEditComponent .js-todo-edit-layer .todo-menu"),a,"VIEW"),"contents-display":ListHelper.setDisplay(!1,"none"),"drag-button-display":ListHelper.setDisplay(!1,"none"),"remove-button-display":ListHelper.setDisplay(!1,"none"),"mouseover-title":a.TODO_CNTN})}),c}function m(a,b,c){var d=$("#todoItemComponent").html(),e="";return e+=ListHelper.replaceJson(d,{"contents-value":b.replace(/"/ig,"&quot;"),"todo-text-display":ListHelper.setDisplay(!1),"icon-checkbox-display":ListHelper.setDisplay(!1),"todo-menu":c?n(a,c,"EDIT"):n(a,"","ADD"),"todo-list-srno":c?c.COLABO_TODO_LIST_SRNO:"","todo-srno":c?c.COLABO_TODO_SRNO:"","rgst-dttm":c?c.RQST_DTTM:""}),e}function n(a,b,c){var d,e=a.clone(),f="SHARE_POST"===$("#postPopup").attr("data-code"),g="ADD"===c?$("#todoParticipantComponent").html():$("#todoMenuComponent").html(),h=0!==Often.null2Void(e.find(".js-registration").attr("data-worker-id"),"").length;if(h||f)return e.html();var i=b?""!==Often.null2Void(b.RQST_DTTM,""):"",j=b?""!==Often.null2Void(b.RQST_USER_ID,""):"",k=Often.null2Void(p(b.RQST_DTTM),""),l=!!i&&Often.isSameDay(b.RQST_DTTM);return d=ListHelper.replaceJson(g,{id:b?b.RQST_USER_ID:_USER_ID,"use-intt-id":b?b.RQST_USE_INTT_ID:_USE_INTT_ID,profile:b?ListHelper.setProfile(b.PRFL_PHTG):_PRFL_PHTG,"req-time":i?l?i18next.t("dictionary.today"):k:"","select-date":i?Often.null2Void(Tz.momentTimeZone(b.RQST_DTTM,"type14"),""):"","todoDate-data-display":ListHelper.setDisplay(i,"inline-block"),"participant-data-display":ListHelper.setDisplay(j,"inline-block"),"mouseover-title":"","mouseover-date":i?p(b.RQST_DTTM):i18next.t("front.common.add",{val:"$t(front.common.dueDate)"}),"mouseover-worker":j?b.RQST_USER_NM:i18next.t("front.common.add",{val:"$t(dictionary.request)"}),"dead-line-class":"Y"===b.STTS?"":Often.isDeadlineExceeded(b.RQST_DTTM)?"deadline-exceeded":""}),"VIEW"===c&&(e.find(".js-datepick-button").css("display","none"),e.find(".js-worker-button").css("display","none")),"EDIT"===c&&i&&(e.find(".js-pickr-icon").css("display","none"),e.find(".todo-date").css("display","none")),j&&e.find(".js-worker-button").css("display","none"),e.append(d),e.html()}function o(a,b,c,d){var e={COLABO_SRNO:d.attr("data-project-srno"),COLABO_COMMT_SRNO:d.attr("data-post-srno"),COLABO_TODO_SRNO:b,COLABO_TODO_LIST_SRNO:a,STTS:c?"N":"Y"};Ajax.executeApi(RestApi.PUT.COLABO2_TODO_U101,e,function(){Often.toast("success",i18next.t("front.alert.successfullyChange",{status:"$t(dictionary.edit)"}));UpdateElements.autoUpdateElem({PROJECT_SRNO:e.COLABO_SRNO,POST_SRNO:e.COLABO_COMMT_SRNO,TODO_DATA:{OBJECT:"TODO_STATUS",STATUS:e}}),UpdateElements.autoUpdateElem({PROJECT_SRNO:e.COLABO_SRNO,POST_SRNO:e.COLABO_COMMT_SRNO,REMARK_SRNO:d.find(".remark-item:last").attr("remark-srno"),REMARK_UPDATE:!0})})}function p(a){return Tz.momentTimeZone(a,"type13")}function q(a){var b=Often.null2Void(a.find(".js-pickr-date").val(),a.attr("select-date"));DatePicker.makeFlatPickr({dateFormat:"Ymd",inputObj:{end:a},endDate:b,callback:{close:function(a,b,c){if(!c){var d=Tz.momentTimeZone(b,"type12","input");a.find(".js-pickr-icon").css("display","none"),a.find(".js-pickr-date").val(d);var e=a.parents(".todo-menu");e.find(".todo-date").remove();var f=$("#todoDateComponent #todoDateSpan").clone();f.attr({"select-date":d,"mouseover-text":Tz.momentTimeZone(b,"type4")});var g=Often.isSameDay(b);f.text(g?i18next.t("dictionary.today"):Tz.momentTimeZone(b,"type4")),e.find("#todoWorkerButton").before(f),DatePicker.checkOverDate(f,b.substr(0,8))}},remove:function(a,b){var c=b.find(".js-pickr-date"),d=a.find(".js-flatpickr-remove-button");return 0===b.nextAll("#todoDateSpan:visible").length||""===b.nextAll("#todoDateSpan:visible").attr("select-date")?void d.css("display","none"):void d.off("click").on("click",function(){b.nextAll("#todoDateSpan").remove(),b.find(".js-pickr-icon").css("display","inline-block"),c.val(""),a.remove()})}}})}function r(a){var b=a.find(".js-todo-edit-layer");b.empty(),b.append($("#todoEditComponent .js-todo-edit-layer").html()),b.find("#todoContent").focus()}var s,t=!1;return{initEdit:function(){var b=$("#postPopup");b.find("#postTitle").focus(),b.find(".js-registration[data-worker-id='']").remove(),a()},keydownTodoInput:b,keyUpTodoInput:function(a){$.isTarget(a,".js-todo-content-input")&&h(a)},clickTodoComponentInDetail:function(a){var b=$(a.target).closest(".js-popup-before").find(".js-post-nav").hasClass("todo");if(b){var e=$("#postPopup"),h="VIEW"===e.attr("data-code")||$("#detailUl").hasClass("card")&&0===e.length;if(!h){if($.isTarget(a,".js-worker-button"))return c(a);if($.isTarget(a,".js-pickr-layer"))return g(a);if($.isTarget(a,".js-worker-button"))return d(a)}return $.isTarget(a,".js-todo-checkbox")?f(a):void 0}},removeOneTodo:function(a){var b=$(a.target),c=b.closest(".js-todo-remove-btn");if(0===c.length)return!1;var d=b.closest(".todo-item");return d.remove(),!0},getLookHtml:function(a){if(!a||0===Object.keys(a.CONTENTS).length)return ListHelper.replaceJson($("#todoEditComponent").html());var b=a.CONTENTS.length,c=0;a.CONTENTS.forEach(function(a){"Y"===a.STTS&&c++});var d=j(a.CONTENTS);return ListHelper.replaceJson($("#todoComponent").html(),{"total-count":b,"checked-count":c,percent:d.PERCENT,"percent-style":"style=\"width:"+d.PERCENT+"%\"","todo-ul":l(a.CONTENTS),"todo-rgsr-info":k(a.CONTENTS[0])})},getTodoDataListHtml:function(a){var b=$("#postPopup"),c=b.find(".js-todo-edit-layer .todo-menu"),d=b.find(".js-content-area #todoEditUl"),e="";a.TODO_REC.forEach(function(a){e+=m(c,a.TODO_CNTN,a)}),d.append(e)},getTodoPercentJson:j,makeTodoLiHtml:m,makeTodoJson:function(){function a(a,b){var c=a?$(b).find(".todoContents").val():e,f=a?$(b).find("#todoDateSpan").attr("select-date"):d.parent().find("#todoDateSpan").attr("select-date"),g=a?$(b).attr("todo-list-srno"):"",h=a?Often.null2Void($(b).find("#participantData").attr("data-worker-id"),_USER_ID):Often.null2Void(d.parent().find("#participantData").attr("data-worker-id"),_USER_ID),i=a?Often.null2Void($(b).find("#participantData").attr("data-use-intt-id"),_USE_INTT_ID):Often.null2Void(d.parent().find("#participantData").attr("data-use-intt-id"),_USE_INTT_ID);return{TODO_CNTN:c,RQST_DTTM:Often.null2Void(f,""),COLABO_TODO_LIST_SRNO:g,RQST_USER_ID:h,RQST_USE_INTT_ID:i}}var b=[],c=$("#postPopup"),d=c.find("#todoContent"),e=d.val();return c.find(".todo-item").each(function(c,d){b.push(a(!0,d))}),e&&0!==e.length&&b.push(a(!1)),b},checkTodoValue:function(a){var b=a.find(".todoContents"),c=a.find(".js-todo-edit-layer .js-todo-content-input"),d=0===a.find("#todoEditUl li").length,e=c&&0===c.val().length;return d&&e?(Often.toast("error",i18next.t("front.alert.enterWord",{val:"$t(dictionary.todo)"})),!0):(b.each(function(){var a=Validation.checkInput($(this));0<Object.keys(a).length&&$(this).closest("li[class=\"todo-item\"]").remove()}),!1)}}}();
"use strict";var SubtaskKeyEvent=function(){function a(a){function d(a){ItemSubtask.drawSubtaskLi(j,$.extend(c,a)),ItemSubtask.getSubtaskCount(e);var b="VIEW"===j.parents(".js-popup-before").attr("data-code");b&&ViewChanger.isPage("task")&&UpdateElements.autoUpdateElem()}var e=$(a.target),f=e.findUp(".js-subtask-area");if(!f||0===f.length)return!1;a.stopPropagation();var g=e.findUp(".js-subtask-li"),h=e.findUp(".js-subtask-input"),i=e.findUp(".js-priority-setting-button"),j=e.findUp(".js-subtask-edit-layer"),k=+e.parents(".subtask-space").find(".subtask-count").text();if(KeyCheck.isKey(a,"ENTER")&&0<h.length&&(clearTimeout(b),b=setTimeout(function(){var a=Validation.checkInput(h);return 0<Object.keys(a).length?(Often.toast("error",a.errorMessage),void a.errorObj.focus()):50<=k?void Often.toast("error",i18next.t("front.alert.limitSubTask")):void(e.parents(".subtask-space").find(".subtask-count").text(k+1),c=ItemSubtask.makeSubtaskRecord(j,!0),ItemSubtask.addAndDrawSubtask(d,c,e),ItemSubtask.initEditSubtask(j))},100)),KeyCheck.isKey(a,"TAB")){var l=g.find({input:".js-subtask-date-button:visible",date:".js-priority-button:visible",priority:".js-worker-button:visible",worker:".js-subtask-input"}[e.attr("tab-code")]);return void l.focus()}if((KeyCheck.isKey(a,"UP")||KeyCheck.isKey(a,"DOWN"))&&0<i.length){var m,n=g.find(".js-priority-setting-button"),o=+i.attr("data-key-index");m=KeyCheck.isKey(a,"DOWN")?0===o?4:o-1:4===o?0:o+1,n[m].focus()}}var b,c;return{keyUpSubtaskInput:function(b){if($.isTarget(b,".js-subtask-area"))return a(b)},KeyDownSubtaskInput:function(a){function b(){f.removeClass("on"),ItemSubtask.initEditSubtask(e)}var c=$(a.target),d=c.findUp(".js-subtask-input"),e=c.findUp(".js-subtask-edit-layer"),f=c.findUp(".js-subtask-area");return!!(f&&0!==f.length)&&!!(KeyCheck.isKey(a,"ESC")&&d&&0<d.length&&e)&&(a.stopPropagation(),function(){var a=Often.null2Void(ItemSubtask.makeSubtaskRecord(e,!0)[0]);return""===a||"0"===a.STTS&&""===a.END_DT&&""===a.PRIORITY&&0===a.WORKER_REC.length&&""===a.TASK_NM}()?b():PopupDraw.drawConfirm({contents:{main:"\uD558\uC704 \uC5C5\uBB34\uB97C \uC791\uC131\uC911 \uC785\uB2C8\uB2E4. \uC911\uB2E8\uD558\uC2DC\uACA0\uC2B5\uB2C8\uAE4C?"},callback:{submit:b,cancel:PopupDraw.closePopup}}),!0)}}}();
//# sourceMappingURL=detail.min.js.map
