(function(){function r(e,n,t){function o(i,f){if(!n[i]){if(!e[i]){var c="function"==typeof require&&require;if(!f&&c)return c(i,!0);if(u)return u(i,!0);var a=new Error("Cannot find module '"+i+"'");throw a.code="MODULE_NOT_FOUND",a}var p=n[i]={exports:{}};e[i][0].call(p.exports,function(r){var n=e[i][1][r];return o(n||r)},p,p.exports,r,e,n,t)}return n[i].exports}for(var u="function"==typeof require&&require,i=0;i<t.length;i++)o(t[i]);return o}return r})()({1:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var _AlarmHistoryItem = require("../../items/AlarmHistoryItem");

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

//Ajax, ListHelper, Tz, AlarmUpdate
var AlarmHistory = function () {
  var n2v = function n2v(v, d) {
    return Often.null2Void(v, d);
  };

  var alarmHistoryData = {
    PG_NO: 1,
    PG_PER_CNT: 50,
    NEXT_YN: "Y",
    MODE: "HISTORY"
  };
  var $element = {};
  var searchingTimer;
  return {
    openView: function openView(projectSrno) {
      alarmHistoryData.COLABO_SRNO = projectSrno;
      drawInitList();
    }
  };

  function drawInitList() {
    initView();
    drawList();
  }

  function drawSearchList() {
    ListHelper.initPageData(alarmHistoryData);
    drawList();
  }

  function initView() {
    set$element();
    ListHelper.initPageData(alarmHistoryData, $element.ul);
    $element.searchInput.off('keyup').val("");
    addEvent();
  }

  function addEvent() {
    $element.searchInput.off('keyup').on('keyup', clickSearchInput);
  }

  function set$element() {
    $element.wrap = $(".allHistoryLayer");
    $element.ul = $element.wrap.find("ul");
    $element.searchInput = $element.wrap.find("#historySearchInput");
  }

  function getListData() {
    var SRCH_WORD = n2v($element.searchInput.val()).trim();
    var inputData = Object.assign({}, alarmHistoryData, {
      SRCH_WORD: SRCH_WORD,
      GUBUN: "0,1,2,"
    });
    return Ajax.executeApi("ACT_ALARM_LIST", inputData);
  }

  function drawList() {
    return _drawList.apply(this, arguments);
  }

  function _drawList() {
    _drawList = _asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
      var result;
      return regeneratorRuntime.wrap(function _callee$(_context) {
        while (1) {
          switch (_context.prev = _context.next) {
            case 0:
              _context.next = 2;
              return getListData();

            case 2:
              result = _context.sent;
              $element.ul.drawListHelper({
                pageData: alarmHistoryData,
                nextYn: result["NEXT_YN"],
                records: result["ALARM_REC"],
                noDataHtml: ListHelper.getNoDataHtml("ALARM"),
                targetObj: {
                  focus: $element.searchInput
                },
                callback: {
                  click: clickOneItem,
                  item: makeOneItem,
                  scroll: drawList
                }
              });

            case 4:
            case "end":
              return _context.stop();
          }
        }
      }, _callee);
    }));
    return _drawList.apply(this, arguments);
  }

  function clickSearchInput() {
    searchingTimer && clearTimeout(searchingTimer);
    searchingTimer = setTimeout(function () {
      drawSearchList();
    }, 500);
  }

  function clickOneItem(e) {
    var $eTarget = $(e.target);
    var $alarmItem = $eTarget.closest('.js-alarm-item');
    if ($alarmItem.length === 0) return;
    var dataObj = Object.assign(Often.getAttrs($alarmItem)[0], {
      OPEN_POP: true
    });
    AlarmUpdate.readAlarmAndAction(dataObj);
  }

  function makeOneItem(arr) {
    return arr.map(function (v) {
      return ListHelper.replaceJson(_AlarmHistoryItem.item, convertOneItem(v));
    });
  }

  function convertOneItem(v) {
    var isReaction = "" !== n2v(v.EMT_CD);
    var isContainImg = "Y" === n2v(v.IMG_ATCH_YN, "N");
    var isContainFile = "Y" === n2v(v.ATCH_YN, "N");
    var isTask = "" !== n2v(v.TASK_NM);
    return Object.assign({}, v, {
      'emoti-class': isReaction ? "icon-" + DetailCode.EMOJI._GB[v.EMT_CD - 1] : "",
      'task-name-tag': ListHelper.setEmTag(v.TASK_NM, i18next.t('front.common.taskTitle')) + (isTask ? '<br>' : ''),
      'data-text': Tz.momentTimeZone(v.RGSN_DTTM, "type1", 'fromNow'),
      'profile-style': ListHelper.setProfile(v.PRFL_PHTG),
      'img-display': ListHelper.setDisplay(isContainImg, "inline-block"),
      'file-display': ListHelper.setDisplay(isContainFile, "inline-block")
    });
  }
}();

var _default = AlarmHistory;
exports.default = _default;

},{"../../items/AlarmHistoryItem":4}],2:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.default = void 0;

var InvitationPopup = function () {//todo
}();

var _default = InvitationPopup;
exports.default = _default;

},{}],3:[function(require,module,exports){
"use strict";

function _typeof(obj) { "@babel/helpers - typeof"; if (typeof Symbol === "function" && typeof Symbol.iterator === "symbol") { _typeof = function _typeof(obj) { return typeof obj; }; } else { _typeof = function _typeof(obj) { return obj && typeof Symbol === "function" && obj.constructor === Symbol && obj !== Symbol.prototype ? "symbol" : typeof obj; }; } return _typeof(obj); }

function _getRequireWildcardCache(nodeInterop) { if (typeof WeakMap !== "function") return null; var cacheBabelInterop = new WeakMap(); var cacheNodeInterop = new WeakMap(); return (_getRequireWildcardCache = function _getRequireWildcardCache(nodeInterop) { return nodeInterop ? cacheNodeInterop : cacheBabelInterop; })(nodeInterop); }

function _interopRequireWildcard(obj, nodeInterop) { if (!nodeInterop && obj && obj.__esModule) { return obj; } if (obj === null || _typeof(obj) !== "object" && typeof obj !== "function") { return { default: obj }; } var cache = _getRequireWildcardCache(nodeInterop); if (cache && cache.has(obj)) { return cache.get(obj); } var newObj = {}; var hasPropertyDescriptor = Object.defineProperty && Object.getOwnPropertyDescriptor; for (var key in obj) { if (key !== "default" && Object.prototype.hasOwnProperty.call(obj, key)) { var desc = hasPropertyDescriptor ? Object.getOwnPropertyDescriptor(obj, key) : null; if (desc && (desc.get || desc.set)) { Object.defineProperty(newObj, key, desc); } else { newObj[key] = obj[key]; } } } newObj.default = obj; if (cache) { cache.set(obj, newObj); } return newObj; }

function asyncGeneratorStep(gen, resolve, reject, _next, _throw, key, arg) { try { var info = gen[key](arg); var value = info.value; } catch (error) { reject(error); return; } if (info.done) { resolve(value); } else { Promise.resolve(value).then(_next, _throw); } }

function _asyncToGenerator(fn) { return function () { var self = this, args = arguments; return new Promise(function (resolve, reject) { var gen = fn.apply(self, args); function _next(value) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "next", value); } function _throw(err) { asyncGeneratorStep(gen, resolve, reject, _next, _throw, "throw", err); } _next(undefined); }); }; }

_asyncToGenerator( /*#__PURE__*/regeneratorRuntime.mark(function _callee() {
  return regeneratorRuntime.wrap(function _callee$(_context) {
    while (1) {
      switch (_context.prev = _context.next) {
        case 0:
          _context.next = 2;
          return Promise.resolve().then(function () {
            return _interopRequireWildcard(require("./components/alarm-history/"));
          });

        case 2:
          window.AlarmHistory = _context.sent.default;
          _context.next = 5;
          return Promise.resolve().then(function () {
            return _interopRequireWildcard(require("./components/invitation-popup/"));
          });

        case 5:
          window.InvitationPopup = _context.sent.default;

        case 6:
        case "end":
          return _context.stop();
      }
    }
  }, _callee);
}))();

},{"./components/alarm-history/":1,"./components/invitation-popup/":2}],4:[function(require,module,exports){
"use strict";

Object.defineProperty(exports, "__esModule", {
  value: true
});
exports.wrap = exports.item = void 0;
var wrap = "<ul class=\"history-group\"></ul>";
exports.wrap = wrap;
var item = "\n<li class=\"alarm-{COLABO_COMMT_SRNO} js-alarm-item cursor-pointer\" \n    COLABO_SRNO=\"{COLABO_SRNO}\" \n    COLABO_COMMT_SRNO=\"{COLABO_COMMT_SRNO}\" \n    COLABO_REMARK_SRNO=\"{COLABO_REMARK_SRNO}\"\n    ALARM_ACTION=\"{ALARM_ACTION}\"\n    ALARM_STATUS=\"{ALARM_STATUS}\"\n    TOAST_MSG=\"{msg}\"\n    TOAST_CNTN=\"{contents}\">\n    <div class=\"all-setup-picture-type-1\" {profile-style}></div> \n    <div class=\"all-text-wrap-type-1\">\n      <div class=\"all-text-wrap-type-2\"><i class=\"{emoti-class}\"></i>{ALAM_MSG}</div>\n      <div class=\"all-text-wrap-type-3\">{task-name-tag}{ALAM_CNTN}</div>\n      <div class=\"all-text-wrap-type-3\">\n        <span {img-display}><em class=\"all-setup-icon-type-1\"></em>\uC774\uBBF8\uC9C0</span>\n        <span {file-display}><em class=\"all-setup-icon-type-2\"></em>\uD30C\uC77C</span>\n      </div>\n    </div>\n    <div class=\"all-setup-section-type-1\"><em>{data-text}</em></div>\n  </li>\n";
exports.item = item;

},{}]},{},[3])


//# sourceMappingURL=module.min.js.map
