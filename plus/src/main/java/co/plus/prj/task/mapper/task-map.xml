<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.plus.prj.task.mapper.TaskMapper">

	<select id="taskSelectList"
		resultType="co.plus.prj.task.vo.TaskVO">		<!-- 업무 목록 조회 -->
		select a.*, b.noti_dttm, c.name
		from task a, notice_writing b, member c
		where a.noti_id = b.noti_id
        and b.mem_id = c.mem_id
		<if test="notiTtl != null and notiTtl != ''">													<!-- 게시글 제목 검색 후 목록 출력 -->
			and noti_ttl like '%' || #{notiTtl} || '%'
		</if>
	</select>

	<select id="taskSelect" resultType="co.plus.prj.task.vo.TaskVO">			<!-- 업무 상세 조회 -->
		select * from task 														<!-- subtsk 있고 없는 유뮤 -->
		where noti_id = #{noti_id}
		<if test="subtsk_ttl != null and subtsk_ttl != ''">
			AND subtsk_ttl like #{val}
		</if>
	</select>

	<insert id="taskInsert"
		parameterType="co.plus.prj.task.vo.TaskVO">
		insert into task(notiId, tskTtl, tskPrgs,tskBgnDt,tskEndDt,tskCntn )
		values (notiId.nextval, #{tsk_ttl}, #{tsk_prgs}, #{tsk_bgn_dt},
		#{tsk_end_dt}, #{tsk_cntn})
	</insert>

	<update id="taskUpdate"
		parameterType="co.plus.prj.task.vo.TaskVO">
		update task set tskPrgs = #{tsk_prgs}
		where noti_id = #{noti_id}
	</update>

	<delete id="taskDelete"
		parameterType="co.plus.prj.task.vo.TaskVO">
		delete from task
		where noti_id = #{noti_id}
	</delete>
</mapper>