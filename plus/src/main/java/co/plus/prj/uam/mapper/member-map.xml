<?xml version="1.0" encoding="UTF-8"?>
<!DOCTYPE mapper PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN" "http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="co.plus.prj.uam.mapper.MemberMapper">
    <select id="getMemberList" resultType="co.plus.prj.uam.vo.MemberVO">
    
	</select>
	
	<select id="getMember" resultType="co.plus.prj.uam.vo.MemberVO">
	
	</select>
	
	<!-- 회원로그인 -->
	<select id="loginCheck" resultType="co.plus.prj.uam.vo.MemberVO">			<!-- 로그인정보일치여부확인 -->
		 select mem_id, pwd, email
		 from member
		 where email = #{email} and pwd = ${pwd}
	</select>
	<select id="viewMember" resultType="co.plus.prj.uam.vo.MemberVO">			<!-- 세션에 저장할 회원정보 -->
		 select a.mem_id, a.name, a.pwd, a.email, a.mem_perm, b.mem_st
		 from member a, mem_status b
		 where a.mem_id = b.mem_id and a.email = #{email} and a.pwd = ${pwd}
	</select>
	<update id="loginStUpdate" parameterType="co.plus.prj.uam.vo.MemberVO">		<!-- 회원 상태 온라인으로 -->
		<![CDATA[update mem_status set mem_st = 'online'
  		where a.email = #{email}
  		 and mem_st <> 'online' ]]>
	</update>
	
	<!-- 회사 URL -->
	<select id="getCompany" resultType="co.plus.prj.uam.vo.MemberVO">
		select co_url, co_name 
		from company
		where co_url = #{coUrl}
	</select>

	<!-- 어드민회원입력 -->
	<insert id="newCompanyInsert1" parameterType="co.plus.prj.uam.vo.MemberVO">
		INSERT INTO MEMBER(MEM_ID, EMAIL, PWD, NAME, CO_url,MEM_PERM)
		VALUES (MEMID.nextval, #{email}, #{pwd}, #{name}, #{coUrl}, 'ADMIN')
	</insert>
	<insert id="newCompanyInsert2" parameterType="co.plus.prj.uam.vo.MemberVO">
		INSERT INTO company(co_name, co_url)
		VALUES (#{coName}, #{coUrl})
	</insert>
	
	<!-- 기존회사 회원입력 -->
	<insert id="exCompanyInsert" parameterType="co.plus.prj.uam.vo.MemberVO">
		INSERT INTO MEMBER(MEM_ID, EMAIL, PWD, NAME, CO_url)
		VALUES (MEMID.nextval, #{email}, #{pwd}, #{name}, #{coUrl})
	</insert>
	
	<!-- 회원정보수정(회원마이페이지) -->
	<update id="nameUpdate" parameterType="co.plus.prj.uam.vo.MemberVO">
		update member set 
		name = #{name}
	</update>

	<!-- 탈퇴 -->
	<delete id="memberDelete" parameterType="co.plus.prj.uam.vo.MemberVO">
		update member set mem_perm = 
	</delete>
	
</mapper>